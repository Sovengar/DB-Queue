2025-06-05 10:37:56 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 2276 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 10:37:56 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 10:37:56 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 10:37:56 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 10:37:58 [OutputReader-stderr] INFO  o.s.b.docker.compose.core.DockerCli -  Container dbqueue-postgres-1  Created
2025-06-05 10:37:58 [OutputReader-stderr] INFO  o.s.b.docker.compose.core.DockerCli -  Container dbqueue-postgres-1  Starting
2025-06-05 10:37:59 [OutputReader-stderr] INFO  o.s.b.docker.compose.core.DockerCli -  Container dbqueue-postgres-1  Started
2025-06-05 10:37:59 [OutputReader-stderr] INFO  o.s.b.docker.compose.core.DockerCli -  Container dbqueue-postgres-1  Waiting
2025-06-05 10:38:00 [OutputReader-stderr] INFO  o.s.b.docker.compose.core.DockerCli -  Container dbqueue-postgres-1  Healthy
2025-06-05 10:38:01 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 10:38:01 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 10:38:02 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 10:38:02 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 96 ms. Found 2 JPA repository interfaces.
2025-06-05 10:38:03 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 10:38:03 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 10:38:03 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 10:38:03 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 10:38:03 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 10:38:03 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2873 ms
2025-06-05 10:38:04 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 10:38:04 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 10:38:04 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 10:38:05 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 10:38:05 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 10:38:05 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@1d14b868
2025-06-05 10:38:05 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 10:38:05 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 10:38:07 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 10:38:07 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 10:38:07 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-06-05 10:38:08 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 10:38:08 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 10:38:08 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 10:38:09 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 10:38:09 [restartedMain] INFO  jon.db.queue.Application - Started Application in 13.872 seconds (process running for 15.95)
2025-06-05 10:38:09 [scheduling-1] DEBUG jon.db.queue.generic_queue.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 10:38:09 [scheduling-1] DEBUG jon.db.queue.generic_queue.GenericQueueWorker - Moving 1 messages [1298] to DLQ
2025-06-05 10:38:09 [scheduling-1] DEBUG jon.db.queue.generic_queue.GenericQueueScheduler - Polling message queue...
2025-06-05 10:38:09 [pool-3-thread-1] DEBUG jon.db.queue.generic_queue.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 10:38:09 [pool-3-thread-2] DEBUG jon.db.queue.generic_queue.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 10:38:09 [pool-3-thread-3] DEBUG jon.db.queue.generic_queue.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 10:38:09 [pool-3-thread-1] DEBUG jon.db.queue.generic_queue.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 10:38:09 [pool-3-thread-3] DEBUG jon.db.queue.generic_queue.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 10:38:09 [pool-3-thread-2] DEBUG jon.db.queue.generic_queue.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 10:38:09 [scheduling-1] DEBUG jon.db.queue.generic_queue.GenericQueueCreator - Created message [1299] with data {"GOT":"Aurane Waters","LOTR":"Éowyn"}
2025-06-05 10:38:13 [scheduling-1] DEBUG jon.db.queue.generic_queue.GenericQueueCreator - Created message [1300] with data {"GOT":"Mathos Mallarawan","LOTR":"Arwen Evenstar"}
2025-06-05 10:38:13 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 10:38:13 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-05 10:38:13 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 10:38:13 [SpringApplicationShutdownHook] WARN  o.s.b.f.s.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.springframework.boot.autoconfigure.jdbc.DataSourceProperties$DataSourceBeanCreationException: Failed to determine a suitable driver class
2025-06-05 10:38:13 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-06-05 10:38:13 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-06-05 13:08:33 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 15944 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:08:33 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:08:33 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:08:34 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:08:35 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:08:35 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:08:35 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:08:37 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:08:37 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 88 ms. Found 2 JPA repository interfaces.
2025-06-05 13:08:38 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:08:38 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:08:38 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:08:38 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:08:38 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:08:38 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2967 ms
2025-06-05 13:08:38 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:08:39 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:08:39 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:08:39 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:08:39 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:08:40 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@16e602f4
2025-06-05 13:08:40 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:08:40 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:08:41 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:08:41 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:08:42 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-06-05 13:08:42 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:08:43 [restartedMain] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'requestMappingHandlerMapping' defined in class path resource [org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration$EnableWebMvcConfiguration.class]: Ambiguous mapping. Cannot map 'streamLast20Msgs' method 
jon.db.queue.generic_queue.application.StreamLast20Msgs#getActiveConnections()
to {GET [/generic-queue/active-connections]}: There is already 'getActiveConnections' bean method
jon.db.queue.generic_queue.application.GetActiveConnections#getActiveConnections() mapped.
2025-06-05 13:08:43 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:08:43 [restartedMain] WARN  o.s.b.f.s.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.springframework.boot.autoconfigure.jdbc.DataSourceProperties$DataSourceBeanCreationException: Failed to determine a suitable driver class
2025-06-05 13:08:43 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-06-05 13:08:43 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-06-05 13:08:43 [restartedMain] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-06-05 13:08:43 [restartedMain] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-06-05 13:08:43 [restartedMain] ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'requestMappingHandlerMapping' defined in class path resource [org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration$EnableWebMvcConfiguration.class]: Ambiguous mapping. Cannot map 'streamLast20Msgs' method 
jon.db.queue.generic_queue.application.StreamLast20Msgs#getActiveConnections()
to {GET [/generic-queue/active-connections]}: There is already 'getActiveConnections' bean method
jon.db.queue.generic_queue.application.GetActiveConnections#getActiveConnections() mapped.
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1826)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1222)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1188)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1123)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:987)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1362)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1351)
	at jon.db.queue.Application.main(Application.java:12)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:50)
Caused by: java.lang.IllegalStateException: Ambiguous mapping. Cannot map 'streamLast20Msgs' method 
jon.db.queue.generic_queue.application.StreamLast20Msgs#getActiveConnections()
to {GET [/generic-queue/active-connections]}: There is already 'getActiveConnections' bean method
jon.db.queue.generic_queue.application.GetActiveConnections#getActiveConnections() mapped.
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping$MappingRegistry.validateMethodMapping(AbstractHandlerMethodMapping.java:676)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping$MappingRegistry.register(AbstractHandlerMethodMapping.java:637)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.registerHandlerMethod(AbstractHandlerMethodMapping.java:331)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping.registerHandlerMethod(RequestMappingHandlerMapping.java:507)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping.registerHandlerMethod(RequestMappingHandlerMapping.java:84)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.lambda$detectHandlerMethods$2(AbstractHandlerMethodMapping.java:298)
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.detectHandlerMethods(AbstractHandlerMethodMapping.java:296)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.processCandidateBean(AbstractHandlerMethodMapping.java:265)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.initHandlerMethods(AbstractHandlerMethodMapping.java:224)
	at org.springframework.web.servlet.handler.AbstractHandlerMethodMapping.afterPropertiesSet(AbstractHandlerMethodMapping.java:212)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping.afterPropertiesSet(RequestMappingHandlerMapping.java:237)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	... 21 common frames omitted
2025-06-05 13:10:23 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 13052 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:10:23 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:10:23 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:10:23 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:10:25 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:10:25 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:10:25 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:10:26 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:10:26 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 97 ms. Found 2 JPA repository interfaces.
2025-06-05 13:10:27 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:10:27 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:10:27 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:10:27 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:10:27 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:10:27 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2717 ms
2025-06-05 13:10:28 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:10:28 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:10:28 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:10:29 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:10:29 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:10:29 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@a92ae4c
2025-06-05 13:10:29 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:10:29 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:10:31 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:10:31 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:10:32 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-06-05 13:10:32 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:10:33 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:10:33 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:10:33 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:10:33 [restartedMain] INFO  jon.db.queue.Application - Started Application in 10.937 seconds (process running for 12.015)
2025-06-05 13:10:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1301] with data {"GOT":"Boy","LOTR":"Meriadoc Brandybuck"}
2025-06-05 13:10:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:10:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:10:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:10:33 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:10:33 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:10:33 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 1 messages [1300]
2025-06-05 13:10:33 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 2 messages [1299, 1301]
2025-06-05 13:10:33 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1300 with data: {"GOT": "Mathos Mallarawan", "LOTR": "Arwen Evenstar"}
2025-06-05 13:10:33 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1299 with data: {"GOT": "Aurane Waters", "LOTR": "Éowyn"}
2025-06-05 13:10:33 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1301 with data: {"GOT": "Boy", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:10:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1302] with data {"GOT":"Owen Inchfield","LOTR":"Tom Bombadil"}
2025-06-05 13:10:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1303] with data {"GOT":"Lyonel Selmy","LOTR":"Peregrin Took"}
2025-06-05 13:10:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:10:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:10:43 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:10:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1304] with data {"GOT":"Martyn Cassel","LOTR":"Gimli"}
2025-06-05 13:10:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:10:43 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:10:43 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:10:43 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [1302, 1303, 1304]
2025-06-05 13:10:43 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1304 with data: {"GOT": "Martyn Cassel", "LOTR": "Gimli"}
2025-06-05 13:10:43 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1304: Simulating Random error
2025-06-05 13:10:43 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1303 with data: {"GOT": "Lyonel Selmy", "LOTR": "Peregrin Took"}
2025-06-05 13:10:43 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1302 with data: {"GOT": "Owen Inchfield", "LOTR": "Tom Bombadil"}
2025-06-05 13:10:43 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1303: Simulating Random error
2025-06-05 13:10:43 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [1302, 1303, 1304]
2025-06-05 13:10:43 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1302 with data: {"GOT": "Owen Inchfield", "LOTR": "Tom Bombadil"}
2025-06-05 13:10:43 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 1302: Simulating Random error
2025-06-05 13:10:43 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1303 with data: {"GOT": "Lyonel Selmy", "LOTR": "Peregrin Took"}
2025-06-05 13:10:43 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 1303: Simulating Random error
2025-06-05 13:10:43 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1304 with data: {"GOT": "Martyn Cassel", "LOTR": "Gimli"}
2025-06-05 13:10:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1305] with data {"GOT":"Baelon Targaryen","LOTR":"Théoden"}
2025-06-05 13:10:46 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:10:47 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:10:47 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:10:47 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-06-05 13:10:47 [http-nio-8080-exec-2] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:10:49 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:10:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1306] with data {"GOT":"Vylarr","LOTR":"Beregond"}
2025-06-05 13:10:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:10:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:10:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1307] with data {"GOT":"Creighton Redfort","LOTR":"Beregond"}
2025-06-05 13:10:52 [http-nio-8080-exec-6] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:10:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:10:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [1302, 1303, 1305]
2025-06-05 13:10:53 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1302 with data: {"GOT": "Owen Inchfield", "LOTR": "Tom Bombadil"}
2025-06-05 13:10:53 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1303 with data: {"GOT": "Lyonel Selmy", "LOTR": "Peregrin Took"}
2025-06-05 13:10:53 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1305 with data: {"GOT": "Baelon Targaryen", "LOTR": "Théoden"}
2025-06-05 13:10:53 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1302: Simulating Random error
2025-06-05 13:10:53 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1303: Simulating Random error
2025-06-05 13:10:53 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1305: Simulating Random error
2025-06-05 13:10:53 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 2 messages [1306, 1307]
2025-06-05 13:10:53 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1306 with data: {"GOT": "Vylarr", "LOTR": "Beregond"}
2025-06-05 13:10:53 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 1306: Simulating Random error
2025-06-05 13:10:53 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1307 with data: {"GOT": "Creighton Redfort", "LOTR": "Beregond"}
2025-06-05 13:10:53 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 1307: Simulating Random error
2025-06-05 13:10:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:10:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [1302, 1303, 1305]
2025-06-05 13:10:53 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1302 with data: {"GOT": "Owen Inchfield", "LOTR": "Tom Bombadil"}
2025-06-05 13:10:53 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1305 with data: {"GOT": "Baelon Targaryen", "LOTR": "Théoden"}
2025-06-05 13:10:53 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1303 with data: {"GOT": "Lyonel Selmy", "LOTR": "Peregrin Took"}
2025-06-05 13:10:53 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:10:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1308] with data {"GOT":"Mylenda Caron","LOTR":"Samwise Gamgee"}
2025-06-05 13:10:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:10:57 [http-nio-8080-exec-7] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:10:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:10:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:10:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1309] with data {"GOT":"Stannis Seaworth","LOTR":"Théoden"}
2025-06-05 13:11:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1310] with data {"GOT":"Delp","LOTR":"Tom Bombadil"}
2025-06-05 13:11:02 [http-nio-8080-exec-8] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:11:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:11:03 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [1306, 1307, 1308]
2025-06-05 13:11:03 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1306 with data: {"GOT": "Vylarr", "LOTR": "Beregond"}
2025-06-05 13:11:03 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1308 with data: {"GOT": "Mylenda Caron", "LOTR": "Samwise Gamgee"}
2025-06-05 13:11:03 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1307 with data: {"GOT": "Creighton Redfort", "LOTR": "Beregond"}
2025-06-05 13:11:03 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1306: Simulating Random error
2025-06-05 13:11:03 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1308: Simulating Random error
2025-06-05 13:11:03 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1307: Simulating Random error
2025-06-05 13:11:03 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 2 messages [1309, 1310]
2025-06-05 13:11:03 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1309 with data: {"GOT": "Stannis Seaworth", "LOTR": "Théoden"}
2025-06-05 13:11:03 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 1309: Simulating Random error
2025-06-05 13:11:03 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1310 with data: {"GOT": "Delp", "LOTR": "Tom Bombadil"}
2025-06-05 13:11:03 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:11:03 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [1306, 1307, 1308]
2025-06-05 13:11:03 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1307 with data: {"GOT": "Creighton Redfort", "LOTR": "Beregond"}
2025-06-05 13:11:03 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1306 with data: {"GOT": "Vylarr", "LOTR": "Beregond"}
2025-06-05 13:11:03 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1308 with data: {"GOT": "Mylenda Caron", "LOTR": "Samwise Gamgee"}
2025-06-05 13:11:03 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 1306: Simulating Random error
2025-06-05 13:11:03 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 1308: Simulating Random error
2025-06-05 13:11:03 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 1306 with id 6b93373d-ce45-494e-8413-7951a37ff46c has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:11:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1311] with data {"GOT":"Yohn Farwynd","LOTR":"Glorfindel"}
2025-06-05 13:11:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:11:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:11:06 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:11:07 [http-nio-8080-exec-9] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:11:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1312] with data {"GOT":"Quaro","LOTR":"Quickbeam"}
2025-06-05 13:11:09 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#1306]
2025-06-05 13:11:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1313] with data {"GOT":"Wulfe","LOTR":"Sauron"}
2025-06-05 13:11:11 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:11:12 [http-nio-8080-exec-10] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:11:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1314] with data {"GOT":"Buu","LOTR":"Legolas"}
2025-06-05 13:11:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:11:13 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:11:13 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:11:13 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [1308, 1309, 1311]
2025-06-05 13:11:13 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [1312, 1313, 1314]
2025-06-05 13:11:13 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1308 with data: {"GOT": "Mylenda Caron", "LOTR": "Samwise Gamgee"}
2025-06-05 13:11:13 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1309 with data: {"GOT": "Stannis Seaworth", "LOTR": "Théoden"}
2025-06-05 13:11:13 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1312 with data: {"GOT": "Quaro", "LOTR": "Quickbeam"}
2025-06-05 13:11:13 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1311 with data: {"GOT": "Yohn Farwynd", "LOTR": "Glorfindel"}
2025-06-05 13:11:13 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1313 with data: {"GOT": "Wulfe", "LOTR": "Sauron"}
2025-06-05 13:11:13 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 1308: Simulating Random error
2025-06-05 13:11:13 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 1309: Simulating Random error
2025-06-05 13:11:13 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 1313: Simulating Random error
2025-06-05 13:11:13 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 1311: Simulating Random error
2025-06-05 13:11:13 [pool-2-thread-5] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 1308 with id cf93cd86-2436-42b9-8105-38d938747cd2 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:11:13 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1314 with data: {"GOT": "Buu", "LOTR": "Legolas"}
2025-06-05 13:11:13 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#1308]
2025-06-05 13:11:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:11:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:11:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1315] with data {"GOT":"Tuffleberry","LOTR":"Meriadoc Brandybuck"}
2025-06-05 13:11:17 [http-nio-8080-exec-1] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:11:17 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:11:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1316] with data {"GOT":"Eddara Tallhart","LOTR":"Beregond"}
2025-06-05 13:11:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:11:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:11:22 [http-nio-8080-exec-2] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:11:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1317] with data {"GOT":"Clydas","LOTR":"Sauron"}
2025-06-05 13:11:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:11:23 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:11:23 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:11:23 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [1309, 1311, 1313]
2025-06-05 13:11:23 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1309 with data: {"GOT": "Stannis Seaworth", "LOTR": "Théoden"}
2025-06-05 13:11:23 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1311 with data: {"GOT": "Yohn Farwynd", "LOTR": "Glorfindel"}
2025-06-05 13:11:23 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1313 with data: {"GOT": "Wulfe", "LOTR": "Sauron"}
2025-06-05 13:11:23 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1313: Simulating Random error
2025-06-05 13:11:23 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [1315, 1316, 1317]
2025-06-05 13:11:23 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1315 with data: {"GOT": "Tuffleberry", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:11:23 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1316 with data: {"GOT": "Eddara Tallhart", "LOTR": "Beregond"}
2025-06-05 13:11:23 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 1315: Simulating Random error
2025-06-05 13:11:23 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 1316: Simulating Random error
2025-06-05 13:11:23 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1317 with data: {"GOT": "Clydas", "LOTR": "Sauron"}
2025-06-05 13:11:23 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 1317: Simulating Random error
2025-06-05 13:11:23 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:11:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1318] with data {"GOT":"Wyman Manderly","LOTR":"Meriadoc Brandybuck"}
2025-06-05 13:11:27 [http-nio-8080-exec-3] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:11:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1319] with data {"GOT":"Wat","LOTR":"Éowyn"}
2025-06-05 13:11:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:11:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:11:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1320] with data {"GOT":"Ketter","LOTR":"Beregond"}
2025-06-05 13:11:32 [http-nio-8080-exec-5] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:11:32 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 13:11:32 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-05 13:11:32 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:11:32 [SpringApplicationShutdownHook] WARN  o.s.b.f.s.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.springframework.boot.autoconfigure.jdbc.DataSourceProperties$DataSourceBeanCreationException: Failed to determine a suitable driver class
2025-06-05 13:11:32 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-06-05 13:11:32 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-06-05 13:11:36 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 20564 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:11:36 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:11:36 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:11:36 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:11:38 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:11:38 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:11:38 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:11:39 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:11:39 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 109 ms. Found 2 JPA repository interfaces.
2025-06-05 13:11:40 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:11:40 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:11:40 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:11:40 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:11:40 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:11:40 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2536 ms
2025-06-05 13:11:41 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:11:41 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:11:41 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:11:42 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:11:42 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:11:42 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@61a8729e
2025-06-05 13:11:42 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:11:42 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:11:43 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:11:44 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:11:44 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-06-05 13:11:44 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:11:45 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:11:45 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:11:45 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:11:45 [restartedMain] INFO  jon.db.queue.Application - Started Application in 10.406 seconds (process running for 11.484)
2025-06-05 13:11:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:11:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:11:45 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:11:45 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:11:45 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-06-05 13:11:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:11:46 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [1313, 1315, 1316]
2025-06-05 13:11:46 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [1317, 1318, 1319]
2025-06-05 13:11:46 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 1 messages [1320]
2025-06-05 13:11:46 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1320 with data: {"GOT": "Ketter", "LOTR": "Beregond"}
2025-06-05 13:11:46 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1317 with data: {"GOT": "Clydas", "LOTR": "Sauron"}
2025-06-05 13:11:46 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1313 with data: {"GOT": "Wulfe", "LOTR": "Sauron"}
2025-06-05 13:11:46 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1318 with data: {"GOT": "Wyman Manderly", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:11:46 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1315 with data: {"GOT": "Tuffleberry", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:11:46 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1315: Simulating Random error
2025-06-05 13:11:46 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 1318: Simulating Random error
2025-06-05 13:11:46 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 1320: Simulating Random error
2025-06-05 13:11:46 [http-nio-8080-exec-1] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:11:46 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:11:46 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1316 with data: {"GOT": "Eddara Tallhart", "LOTR": "Beregond"}
2025-06-05 13:11:46 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1319 with data: {"GOT": "Wat", "LOTR": "Éowyn"}
2025-06-05 13:11:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1321] with data {"LOTR":"Shadowfax","GOT":"Ambrose Butterwell"}
2025-06-05 13:11:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1322] with data {"LOTR":"Legolas","GOT":"Qarro Volentin"}
2025-06-05 13:11:51 [http-nio-8080-exec-2] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:11:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1323] with data {"LOTR":"Gandalf the Grey","GOT":"Melaquin"}
2025-06-05 13:11:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:11:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:11:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1324] with data {"LOTR":"Tom Bombadil","GOT":"Joseran"}
2025-06-05 13:11:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:11:55 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [1315, 1318, 1320]
2025-06-05 13:11:55 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1315 with data: {"GOT": "Tuffleberry", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:11:55 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1318 with data: {"GOT": "Wyman Manderly", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:11:55 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 1318: Simulating Random error
2025-06-05 13:11:55 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1320 with data: {"GOT": "Ketter", "LOTR": "Beregond"}
2025-06-05 13:11:56 [http-nio-8080-exec-3] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:11:56 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:11:56 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [1318, 1321, 1322]
2025-06-05 13:11:56 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1318 with data: {"GOT": "Wyman Manderly", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:11:56 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1321 with data: {"GOT": "Ambrose Butterwell", "LOTR": "Shadowfax"}
2025-06-05 13:11:56 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1318: Simulating Random error
2025-06-05 13:11:56 [pool-2-thread-2] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 1318 with id 2177a323-20d8-431b-a333-461ecdb34852 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:11:56 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1322 with data: {"GOT": "Qarro Volentin", "LOTR": "Legolas"}
2025-06-05 13:11:56 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1322: Simulating Random error
2025-06-05 13:11:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1325] with data {"LOTR":"Éomer","GOT":"Gage"}
2025-06-05 13:11:59 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:11:59 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [1322, 1323, 1324]
2025-06-05 13:11:59 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1322 with data: {"GOT": "Qarro Volentin", "LOTR": "Legolas"}
2025-06-05 13:11:59 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1323 with data: {"GOT": "Melaquin", "LOTR": "Gandalf the Grey"}
2025-06-05 13:11:59 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 1323: Simulating Random error
2025-06-05 13:11:59 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1324 with data: {"GOT": "Joseran", "LOTR": "Tom Bombadil"}
2025-06-05 13:11:59 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 1324: Simulating Random error
2025-06-05 13:12:00 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#1318]
2025-06-05 13:12:01 [http-nio-8080-exec-4] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:12:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1326] with data {"LOTR":"Saruman the White","GOT":"Mathis Rowan"}
2025-06-05 13:12:02 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:12:02 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:12:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1327] with data {"LOTR":"Boromir","GOT":"Groleo"}
2025-06-05 13:12:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:12:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [1323, 1324, 1325]
2025-06-05 13:12:05 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1323 with data: {"GOT": "Melaquin", "LOTR": "Gandalf the Grey"}
2025-06-05 13:12:05 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1324 with data: {"GOT": "Joseran", "LOTR": "Tom Bombadil"}
2025-06-05 13:12:05 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 1323: Simulating Random error
2025-06-05 13:12:05 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 1324: Simulating Random error
2025-06-05 13:12:05 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 1325 with data: {"GOT": "Gage", "LOTR": "Éomer"}
2025-06-05 13:12:06 [http-nio-8080-exec-5] WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotAcceptableException: No acceptable representation]
2025-06-05 13:12:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1328] with data {"LOTR":"Éomer","GOT":"Philip Plumm"}
2025-06-05 13:12:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:12:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:12:10 [http-nio-8080-exec-7] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 1
2025-06-05 13:12:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1329] with data {"LOTR":"Beregond","GOT":"Denys Mallister"}
2025-06-05 13:12:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:12:11 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:12:11 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [1323, 1324, 1326]
2025-06-05 13:12:11 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1323 with data: {"GOT": "Melaquin", "LOTR": "Gandalf the Grey"}
2025-06-05 13:12:11 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1326 with data: {"GOT": "Mathis Rowan", "LOTR": "Saruman the White"}
2025-06-05 13:12:11 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 1324 with data: {"GOT": "Joseran", "LOTR": "Tom Bombadil"}
2025-06-05 13:12:11 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 1324: Simulating Random error
2025-06-05 13:12:11 [pool-2-thread-1] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 1324 with id da91648a-4f63-4217-8331-e7902530ee59 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:12:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1330] with data {"LOTR":"Boromir","GOT":"Pate"}
2025-06-05 13:12:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:12:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:12:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1331] with data {"LOTR":"Legolas","GOT":"Robert Brax"}
2025-06-05 13:12:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:12:17 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:12:17 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [1327, 1328, 1329]
2025-06-05 13:12:17 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1327 with data: {"GOT": "Groleo", "LOTR": "Boromir"}
2025-06-05 13:12:17 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1328 with data: {"GOT": "Philip Plumm", "LOTR": "Éomer"}
2025-06-05 13:12:17 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1329 with data: {"GOT": "Denys Mallister", "LOTR": "Beregond"}
2025-06-05 13:12:17 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 1329: Simulating Random error
2025-06-05 13:12:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:12:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:12:19 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 13:24:22 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 4996 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:24:22 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:24:22 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:24:22 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:24:24 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:24:24 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:24:24 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:24:26 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:24:26 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 112 ms. Found 2 JPA repository interfaces.
2025-06-05 13:24:27 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:24:27 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:24:27 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:24:27 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:24:27 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:24:27 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2809 ms
2025-06-05 13:24:27 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:24:28 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:24:28 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:24:28 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:24:28 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:24:29 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@7390dfc3
2025-06-05 13:24:29 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:24:29 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:24:30 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:24:30 [restartedMain] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Warning Code: 0, SQLState: 00000
2025-06-05 13:24:30 [restartedMain] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - constraint "ukpfutsvs1qoooef5fe75trara8" of relation "generic_queue" does not exist, skipping
2025-06-05 13:24:30 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:24:31 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:24:32 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:24:32 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:24:32 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:24:32 [restartedMain] INFO  jon.db.queue.Application - Started Application in 10.967 seconds (process running for 12.062)
2025-06-05 13:24:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [1] with data {"LOTR":"Éomer","GOT":"Hodor"}
2025-06-05 13:24:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:24:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:24:33 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:33 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:33 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:33 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:33 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:33 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:33 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:33 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:33 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:24:33 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:33 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:33 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:33 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:24:33 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:24:33 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:24:33 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:24:33 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:24:33 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:24:33 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:24:33 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:24:33 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:24:33 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-06-05 13:24:34 [http-nio-8080-exec-1] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 1
2025-06-05 13:24:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [2] with data {"LOTR":"Gandalf the Grey","GOT":"Joth Quickbow"}
2025-06-05 13:24:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:24:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [3] with data {"LOTR":"Éomer","GOT":"Michael Mertyns"}
2025-06-05 13:24:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:24:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:24:41 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:41 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:41 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:24:41 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:24:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [4] with data {"LOTR":"Elrond","GOT":"Anya Waynwood"}
2025-06-05 13:24:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:24:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:24:43 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:43 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:43 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:43 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:43 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:43 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:43 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:43 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:43 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:43 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:24:43 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:24:43 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:24:43 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:24:43 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:24:43 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:24:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [5] with data {"LOTR":"Gandalf the Grey","GOT":"Dontos Hollard"}
2025-06-05 13:24:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:24:45 [http-nio-8080-exec-2] INFO  j.d.q.s.GenericQueuePosgreSQLRepo -     SELECT count(*)
    FROM pg_locks l
    JOIN pg_class t ON l.relation = t.oid
    WHERE t.relname = :tableName
      AND l.mode = 'RowExclusiveLock'
      AND l.granted

2025-06-05 13:24:47 [http-nio-8080-exec-3] INFO  j.d.q.s.GenericQueuePosgreSQLRepo -     SELECT count(*)
    FROM pg_locks l
    JOIN pg_class t ON l.relation = t.oid
    WHERE t.relname = :tableName
      AND l.mode = 'RowExclusiveLock'
      AND l.granted

2025-06-05 13:24:47 [http-nio-8080-exec-4] INFO  j.d.q.s.GenericQueuePosgreSQLRepo -     SELECT count(*)
    FROM pg_locks l
    JOIN pg_class t ON l.relation = t.oid
    WHERE t.relname = :tableName
      AND l.mode = 'RowExclusiveLock'
      AND l.granted

2025-06-05 13:24:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [6] with data {"LOTR":"Treebeard","GOT":"Dagon Ironmaker"}
2025-06-05 13:24:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:24:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:24:49 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:49 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:49 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:24:49 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:24:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [7] with data {"LOTR":"Gollum","GOT":"Peter Plumm"}
2025-06-05 13:24:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:24:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:24:53 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:53 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:53 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:53 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:53 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:53 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:53 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:53 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:53 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:53 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:24:53 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:24:53 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:24:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:24:53 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:24:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:24:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [8] with data {"LOTR":"Elrond","GOT":"Cedrik Storm"}
2025-06-05 13:24:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:24:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:24:57 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:24:57 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:24:57 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:24:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:24:57 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:24:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [9] with data {"LOTR":"Legolas","GOT":"Selwyn Tarth"}
2025-06-05 13:24:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id deedae80-ba3a-4d16-94df-8eb2914510f1
2025-06-05 13:25:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [10] with data {"LOTR":"Théoden","GOT":"Shyra"}
2025-06-05 13:25:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:00 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:25:00 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(deedae80-ba3a-4d16-94df-8eb2914510f1) already exists.
2025-06-05 13:25:00 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(deedae80-ba3a-4d16-94df-8eb2914510f1) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:102)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(deedae80-ba3a-4d16-94df-8eb2914510f1) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(deedae80-ba3a-4d16-94df-8eb2914510f1) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:25:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:25:03 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:03 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:03 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:03 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:03 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:03 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:03 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:03 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:03 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:25:03 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:25:03 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:25:03 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:25:03 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:03 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:25:03 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:25:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [12] with data {"LOTR":"Théoden","GOT":"Robin Flint"}
2025-06-05 13:25:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:25:05 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:05 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:05 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:25:05 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:25:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [13] with data {"LOTR":"Boromir","GOT":"Jaehaera Targaryen"}
2025-06-05 13:25:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [14] with data {"LOTR":"Arwen Evenstar","GOT":"Mors Manwoody"}
2025-06-05 13:25:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [15] with data {"LOTR":"Meriadoc Brandybuck","GOT":"Meliana"}
2025-06-05 13:25:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:25:13 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:13 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:13 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:13 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:13 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:13 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:13 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:13 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:25:13 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:25:13 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:13 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:25:13 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:13 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:25:13 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:25:13 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:25:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:25:13 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:13 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:13 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:25:13 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:25:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [16] with data {"LOTR":"Glorfindel","GOT":"Steffon Hollard"}
2025-06-05 13:25:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [17] with data {"LOTR":"Théoden","GOT":"Mawney"}
2025-06-05 13:25:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:25:21 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:21 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:21 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:25:21 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:25:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [18] with data {"LOTR":"Denethor","GOT":"Henly"}
2025-06-05 13:25:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:25:23 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:23 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:23 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:23 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:23 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:23 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:23 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:23 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:23 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:23 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:25:23 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:25:23 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:25:23 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:25:23 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:25:23 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:25:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [19] with data {"LOTR":"Sauron","GOT":"Meg"}
2025-06-05 13:25:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [20] with data {"LOTR":"Boromir","GOT":"Collio Quaynis"}
2025-06-05 13:25:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:25:29 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:29 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:29 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:25:29 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:25:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [21] with data {"LOTR":"Samwise Gamgee","GOT":"Gyles III Gardener"}
2025-06-05 13:25:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:25:33 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:33 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:33 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:33 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:33 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:33 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:33 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:33 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:33 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:33 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:25:33 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:25:33 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:25:33 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:25:33 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:25:33 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:25:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [22] with data {"LOTR":"Shadowfax","GOT":"Prendahl na Ghezn"}
2025-06-05 13:25:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [23] with data {"LOTR":"Legolas","GOT":"Quaro"}
2025-06-05 13:25:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:25:37 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:37 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:37 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:25:37 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:25:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [24] with data {"LOTR":"Sauron","GOT":"Jate Blackberry"}
2025-06-05 13:25:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [25] with data {"LOTR":"Shelob","GOT":"Alliser Thorne"}
2025-06-05 13:25:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:25:43 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:43 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:43 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:43 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:43 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:25:43 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:43 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:43 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:25:43 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:43 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:43 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:43 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:25:43 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:25:43 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:25:43 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:25:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:25:45 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:45 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:45 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:25:45 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:25:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [26] with data {"LOTR":"Saruman the White","GOT":"Woth"}
2025-06-05 13:25:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [27] with data {"LOTR":"Tom Bombadil","GOT":"Dolf"}
2025-06-05 13:25:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [28] with data {"LOTR":"Treebeard","GOT":"Alester Florent"}
2025-06-05 13:25:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:25:53 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:53 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:53 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:53 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:53 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:53 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:53 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:53 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:53 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:25:53 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:25:53 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:25:53 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:25:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:25:53 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:25:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:25:53 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:25:53 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:25:53 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:25:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:25:53 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:25:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [29] with data {"LOTR":"Shadowfax","GOT":"Poetess"}
2025-06-05 13:25:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:25:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [30] with data {"LOTR":"Barliman Butterbur","GOT":"Lucan"}
2025-06-05 13:25:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:26:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 4a199e55-33ae-4a91-b7f0-df8f11716ab1
2025-06-05 13:26:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [31] with data {"LOTR":"Treebeard","GOT":"Haldon"}
2025-06-05 13:26:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:26:01 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:26:01 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(4a199e55-33ae-4a91-b7f0-df8f11716ab1) already exists.
2025-06-05 13:26:01 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(4a199e55-33ae-4a91-b7f0-df8f11716ab1) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:102)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(4a199e55-33ae-4a91-b7f0-df8f11716ab1) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(4a199e55-33ae-4a91-b7f0-df8f11716ab1) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:26:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:26:01 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:01 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:01 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:26:01 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:26:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:26:03 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:03 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:03 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:03 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:03 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:03 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:03 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:03 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:03 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:26:03 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:03 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:26:03 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:26:03 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:26:03 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:26:03 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:26:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [33] with data {"LOTR":"Legolas","GOT":"Waltyr Frey"}
2025-06-05 13:26:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:26:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [34] with data {"LOTR":"Gollum","GOT":"Wynafryd Manderly"}
2025-06-05 13:26:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:26:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:26:09 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:09 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:09 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:26:09 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:26:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [35] with data {"LOTR":"Shelob","GOT":"Barre"}
2025-06-05 13:26:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:26:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:26:13 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:13 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:13 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:13 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:13 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:13 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:13 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:13 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:13 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:13 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:26:13 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:26:13 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:26:13 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:26:13 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:26:13 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:26:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [36] with data {"LOTR":"Bilbo Baggins","GOT":"Cynthea Frey"}
2025-06-05 13:26:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:26:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [37] with data {"LOTR":"Éomer","GOT":"Ronnet Connington"}
2025-06-05 13:26:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:26:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:26:17 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:17 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:17 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:26:17 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:26:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [38] with data {"LOTR":"Treebeard","GOT":"Alys Frey"}
2025-06-05 13:26:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:26:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [39] with data {"LOTR":"Théoden","GOT":"Woth"}
2025-06-05 13:26:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:26:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:26:23 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:23 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:23 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:23 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:23 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:23 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:23 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:23 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:26:23 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:26:23 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:23 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:26:23 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:26:23 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:23 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:26:23 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:26:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:26:25 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:25 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:25 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:26:25 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:26:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [40] with data {"LOTR":"Galadriel","GOT":"Gwin Goodbrother"}
2025-06-05 13:26:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:26:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [41] with data {"LOTR":"Gimli","GOT":"Gyldayn"}
2025-06-05 13:26:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:26:28 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 13:26:47 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 24972 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:26:47 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:26:47 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:26:47 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:26:48 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:26:48 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:26:48 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:26:50 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:26:50 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 99 ms. Found 2 JPA repository interfaces.
2025-06-05 13:26:51 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:26:51 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:26:51 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:26:51 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:26:51 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:26:51 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2610 ms
2025-06-05 13:26:51 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:26:52 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:26:52 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:26:52 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:26:52 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:26:53 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@28b56c4c
2025-06-05 13:26:53 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:26:53 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:26:54 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:26:54 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:26:55 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:26:56 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:26:56 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:26:56 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:26:56 [restartedMain] INFO  jon.db.queue.Application - Started Application in 10.73 seconds (process running for 11.771)
2025-06-05 13:26:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [42] with data {"GOT":"Wallace Waynwood","LOTR":"Peregrin Took"}
2025-06-05 13:26:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:26:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:26:57 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:57 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:57 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:57 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:57 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:57 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:26:57 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:57 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:26:57 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:26:57 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:57 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:57 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:26:57 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:26:57 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:26:57 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:26:57 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:26:57 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:26:57 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:26:57 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:27:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [43] with data {"GOT":"Manfred Swann","LOTR":"Saruman the White"}
2025-06-05 13:27:00 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:27:00 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:27:00 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-06-05 13:27:00 [http-nio-8080-exec-1] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 1
2025-06-05 13:27:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [44] with data {"GOT":"Utt","LOTR":"Grìma Wormtongue"}
2025-06-05 13:27:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:27:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:27:05 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:05 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:05 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:27:05 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:27:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [45] with data {"GOT":"Marianne Vance","LOTR":"Legolas"}
2025-06-05 13:27:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:27:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:27:07 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:07 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:07 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:07 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:07 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:07 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:07 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:07 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:27:07 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:07 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:27:07 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:07 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:27:07 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:27:07 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:27:07 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:27:07 [http-nio-8080-exec-3] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 2
2025-06-05 13:27:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [46] with data {"GOT":"Bump","LOTR":"Arwen Evenstar"}
2025-06-05 13:27:09 [scheduling-1] WARN  j.d.q.g.GenericQueueSseEmitter - Failed to send message to client: 1
org.springframework.web.context.request.async.AsyncRequestNotUsableException: ServletOutputStream failed to flush: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleHttpServletResponse.handleIOException(StandardServletAsyncWebRequest.java:346)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:418)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.apache.catalina.connector.ClientAbortException: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:304)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	... 32 common frames omitted
Caused by: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	... 35 common frames omitted
2025-06-05 13:27:09 [http-nio-8080-exec-4] ERROR j.d.q.g.GenericQueueSseEmitter - SSE error for client: 1
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:27:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:09 [http-nio-8080-exec-4] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:27:09 [http-nio-8080-exec-4] INFO  j.d.q.g.GenericQueueSseEmitter - SSE connection completed for client: 1
2025-06-05 13:27:09 [http-nio-8080-exec-4] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:27:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id de96e700-ba8e-4601-bc51-95055af40dbf
2025-06-05 13:27:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [47] with data {"GOT":"Tagganaro","LOTR":"Théoden"}
2025-06-05 13:27:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:12 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:27:12 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(de96e700-ba8e-4601-bc51-95055af40dbf) already exists.
2025-06-05 13:27:12 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(de96e700-ba8e-4601-bc51-95055af40dbf) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:98)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(de96e700-ba8e-4601-bc51-95055af40dbf) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(de96e700-ba8e-4601-bc51-95055af40dbf) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:27:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:27:13 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:13 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:13 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:27:13 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:27:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [49] with data {"GOT":"Baelor I Targaryen","LOTR":"Théoden"}
2025-06-05 13:27:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:27:17 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:17 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:17 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:17 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:17 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:17 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:17 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:17 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:17 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:17 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:27:17 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:27:17 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:27:17 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:27:17 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:27:17 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:27:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [50] with data {"GOT":"Lewis Lanster","LOTR":"Peregrin Took"}
2025-06-05 13:27:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:27:21 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:21 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:21 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:27:21 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:27:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [51] with data {"GOT":"Cotter Pyke","LOTR":"Saruman the White"}
2025-06-05 13:27:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [52] with data {"GOT":"Arnolf Karstark","LOTR":"Théoden"}
2025-06-05 13:27:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:27:27 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:27 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:27 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:27 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:27 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:27 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:27 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:27 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:27 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:27:27 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:27 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:27:27 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:27:27 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:27:27 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:27:27 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:27:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [53] with data {"GOT":"Tobbot","LOTR":"Éomer"}
2025-06-05 13:27:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:27:29 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:29 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:29 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:27:29 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:27:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [54] with data {"GOT":"Lady of the Leaves","LOTR":"Samwise Gamgee"}
2025-06-05 13:27:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [55] with data {"GOT":"Alysanne Bulwer","LOTR":"Elrond"}
2025-06-05 13:27:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [56] with data {"GOT":"Roose Bolton","LOTR":"Gollum"}
2025-06-05 13:27:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:27:37 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:37 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:37 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:37 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:37 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:37 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:37 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:37 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:27:37 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:27:37 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:37 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:37 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:27:37 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:27:37 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:27:37 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:27:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:27:37 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:37 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:37 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:27:37 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:27:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [57] with data {"GOT":"Elmar Frey","LOTR":"Grìma Wormtongue"}
2025-06-05 13:27:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [58] with data {"GOT":"Ralf","LOTR":"Denethor"}
2025-06-05 13:27:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:27:45 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:45 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:45 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:27:45 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:27:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [59] with data {"GOT":"Galbart Glover","LOTR":"Théoden"}
2025-06-05 13:27:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:27:47 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:47 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:47 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:47 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:47 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:47 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:47 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:47 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:47 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:47 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:27:47 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:27:47 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:27:47 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:27:47 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:27:47 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:27:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [60] with data {"GOT":"Lyn Corbray","LOTR":"Grìma Wormtongue"}
2025-06-05 13:27:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [61] with data {"GOT":"Alequo Adarys","LOTR":"Shelob"}
2025-06-05 13:27:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:27:53 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:53 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:53 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:27:53 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:27:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [62] with data {"GOT":"Brown Bernarr","LOTR":"Arwen Evenstar"}
2025-06-05 13:27:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:27:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:27:57 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:57 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:57 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:57 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:27:57 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:57 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:27:57 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:57 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:57 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:27:57 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:27:57 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:27:57 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:27:57 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:27:57 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:27:57 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:27:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [63] with data {"GOT":"Lenn","LOTR":"Legolas"}
2025-06-05 13:27:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [64] with data {"GOT":"Sam Stoops","LOTR":"Éowyn"}
2025-06-05 13:28:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:28:01 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:01 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:01 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:28:01 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:28:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [65] with data {"GOT":"Cleon","LOTR":"Shelob"}
2025-06-05 13:28:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [66] with data {"GOT":"Violet","LOTR":"Samwise Gamgee"}
2025-06-05 13:28:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:28:07 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:07 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:07 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:07 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:07 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:07 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:07 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:07 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:28:07 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:28:07 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:07 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:07 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:28:07 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:28:07 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:28:07 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:28:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:28:09 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:09 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:09 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:28:09 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:28:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [67] with data {"GOT":"Rob","LOTR":"Shelob"}
2025-06-05 13:28:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [68] with data {"GOT":"Quaro","LOTR":"Gandalf the Grey"}
2025-06-05 13:28:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [69] with data {"GOT":"Dan","LOTR":"Samwise Gamgee"}
2025-06-05 13:28:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:28:17 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:17 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:17 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:17 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:17 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:17 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:17 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:17 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:17 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:17 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:28:17 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:28:17 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:28:17 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:28:17 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:28:17 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:28:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:28:17 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:17 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:17 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:28:17 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:28:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [70] with data {"GOT":"Duncan","LOTR":"Éowyn"}
2025-06-05 13:28:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [71] with data {"GOT":"Alys Karstark","LOTR":"Samwise Gamgee"}
2025-06-05 13:28:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [72] with data {"GOT":"Myria Jordayne","LOTR":"Shadowfax"}
2025-06-05 13:28:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:28:25 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:25 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:25 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:28:25 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:28:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:28:27 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:27 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:27 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:27 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:27 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:27 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:27 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:27 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:27 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:27 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:28:27 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:28:27 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:28:27 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:28:27 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:28:27 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:28:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [73] with data {"GOT":"Helliweg","LOTR":"Galadriel"}
2025-06-05 13:28:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [74] with data {"GOT":"Garth of Oldtown","LOTR":"Grìma Wormtongue"}
2025-06-05 13:28:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:28:33 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:33 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:33 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:28:33 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:28:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [75] with data {"GOT":"Brown Bernarr","LOTR":"Denethor"}
2025-06-05 13:28:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:28:37 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:37 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:37 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:37 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:37 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:37 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:37 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:37 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:37 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:37 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:28:37 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:28:37 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:28:37 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:28:37 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:28:37 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:28:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [76] with data {"GOT":"Cregan Karstark","LOTR":"Shadowfax"}
2025-06-05 13:28:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [77] with data {"GOT":"Melwyn Sarsfield","LOTR":"Shadowfax"}
2025-06-05 13:28:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:28:41 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:41 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:41 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:28:41 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:28:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [78] with data {"GOT":"Kaeth","LOTR":"Glorfindel"}
2025-06-05 13:28:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [79] with data {"GOT":"Joffrey Caswell","LOTR":"Sauron"}
2025-06-05 13:28:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:28:47 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:47 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:47 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:47 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:47 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:47 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:47 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:47 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:47 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:47 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:28:47 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:28:47 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:28:47 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:28:47 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:28:47 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:28:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:28:49 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:49 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:49 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:28:49 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:28:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [80] with data {"GOT":"Colmar Frey","LOTR":"Arwen Evenstar"}
2025-06-05 13:28:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 1526411a-22ea-4eb5-9354-ab4d74a5a246
2025-06-05 13:28:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [81] with data {"GOT":"Lyonel Frey","LOTR":"Denethor"}
2025-06-05 13:28:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:52 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:28:52 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(1526411a-22ea-4eb5-9354-ab4d74a5a246) already exists.
2025-06-05 13:28:52 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(1526411a-22ea-4eb5-9354-ab4d74a5a246) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:98)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(1526411a-22ea-4eb5-9354-ab4d74a5a246) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(1526411a-22ea-4eb5-9354-ab4d74a5a246) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:28:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [83] with data {"GOT":"Satin","LOTR":"Faramir"}
2025-06-05 13:28:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:28:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:28:57 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:57 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:57 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:57 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:57 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:57 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:57 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:57 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:57 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:57 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:28:57 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:28:57 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:28:57 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:28:57 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:28:57 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:28:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:28:57 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:28:57 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:28:57 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:28:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:28:57 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:28:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [84] with data {"GOT":"Shiera Seastar","LOTR":"Théoden"}
2025-06-05 13:28:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:29:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [85] with data {"GOT":"Tickler","LOTR":"Gollum"}
2025-06-05 13:29:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:29:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [86] with data {"GOT":"Willis Fell","LOTR":"Éomer"}
2025-06-05 13:29:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:29:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:29:05 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:29:05 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:29:05 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:29:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:29:05 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:29:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:29:07 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:29:07 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:29:07 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:29:07 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:29:07 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:29:07 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:29:07 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:29:07 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:29:07 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:29:07 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:29:07 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:29:07 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:29:07 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:29:07 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:29:07 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:29:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [87] with data {"GOT":"Lenwood Tawney","LOTR":"Elrond"}
2025-06-05 13:29:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:29:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [88] with data {"GOT":"Harodon","LOTR":"Éowyn"}
2025-06-05 13:29:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:29:10 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 13:29:21 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 4460 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:29:21 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:29:21 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:29:21 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:29:23 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:29:23 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:29:23 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:29:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:29:24 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 118 ms. Found 2 JPA repository interfaces.
2025-06-05 13:29:25 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:29:25 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:29:25 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:29:25 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:29:25 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:29:25 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2569 ms
2025-06-05 13:29:26 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:29:26 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:29:26 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:29:26 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:29:26 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:29:27 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3829dc3
2025-06-05 13:29:27 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:29:27 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:29:28 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:29:28 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:29:29 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:29:30 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:29:30 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:29:30 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:29:30 [restartedMain] INFO  jon.db.queue.Application - Started Application in 10.49 seconds (process running for 11.563)
2025-06-05 13:29:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:29:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:29:49 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:29:49 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:29:49 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-06-05 13:29:49 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:29:49 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:29:49 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:29:49 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:29:49 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:29:49 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:29:49 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:29:49 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:29:49 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:29:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:29:55 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:29:55 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:29:55 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:29:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:29:55 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:29:55 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:29:55 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:29:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:29:55 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:29:55 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:29:55 [http-nio-8080-exec-1] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 1
2025-06-05 13:29:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [89] with data {"LOTR":"Frodo Baggins","GOT":"Sebaston Farman"}
2025-06-05 13:29:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:29:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:30:51 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m24s371ms994µs900ns).
2025-06-05 13:30:51 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:30:51 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:30:51 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:30:51 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:30:51 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:30:51 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:30:51 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:30:51 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:30:51 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:30:51 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:30:51 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:30:51 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:30:51 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:30:51 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:30:51 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:30:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [90] with data {"LOTR":"Denethor","GOT":"Jeyne Beesbury"}
2025-06-05 13:30:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:30:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:30:51 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:30:51 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:30:51 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:30:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:30:51 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:30:51 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 13:31:14 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 26524 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:31:14 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:31:14 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:31:14 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:31:16 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:31:16 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:31:16 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:31:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:31:24 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 14676 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:31:24 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:31:24 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:31:24 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:31:26 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:31:26 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:31:26 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:31:27 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:31:27 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 138 ms. Found 2 JPA repository interfaces.
2025-06-05 13:31:28 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:31:28 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:31:28 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:31:28 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:31:29 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:31:29 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2771 ms
2025-06-05 13:31:29 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:31:29 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:31:29 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:31:30 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:31:30 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:31:30 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3829dc3
2025-06-05 13:31:30 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:31:31 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:31:32 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:31:32 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:31:33 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:31:34 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:31:34 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:31:34 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:31:34 [restartedMain] INFO  jon.db.queue.Application - Started Application in 11.206 seconds (process running for 12.257)
2025-06-05 13:31:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [91] with data {"GOT":"Small Paul","LOTR":"Éomer"}
2025-06-05 13:31:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:31:35 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:35 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:35 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:31:35 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:31:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:31:35 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:35 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:35 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:35 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:35 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:35 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:35 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:35 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:35 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:35 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:31:35 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:31:35 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:31:35 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:31:35 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:31:35 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:31:35 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:31:35 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:31:35 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-06-05 13:31:35 [http-nio-8080-exec-1] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 1
2025-06-05 13:31:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [92] with data {"GOT":"Hazzea","LOTR":"Tom Bombadil"}
2025-06-05 13:31:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:31:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [93] with data {"GOT":"Harry Sawyer","LOTR":"Legolas"}
2025-06-05 13:31:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:31:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:31:43 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:43 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:43 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:31:43 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:31:44 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [94] with data {"GOT":"Quentin Tyrell","LOTR":"Glorfindel"}
2025-06-05 13:31:44 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:31:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:31:45 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:45 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:45 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:45 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:45 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:45 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:45 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:45 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:45 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:31:45 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:45 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:31:45 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:31:45 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:31:45 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:31:45 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:31:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [95] with data {"GOT":"Harrold Westerling","LOTR":"Glorfindel"}
2025-06-05 13:31:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:31:50 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [96] with data {"GOT":"Mallador Locke","LOTR":"Éomer"}
2025-06-05 13:31:50 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:31:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:31:51 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:51 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:51 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:31:51 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:31:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [97] with data {"GOT":"Craghas Drahar","LOTR":"Bilbo Baggins"}
2025-06-05 13:31:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:31:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:31:55 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:55 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:55 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:55 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:55 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:55 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:55 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:55 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:31:55 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:31:55 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:55 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:31:55 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:31:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:31:55 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:31:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [98] with data {"GOT":"Steffon Frey","LOTR":"Tom Bombadil"}
2025-06-05 13:31:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:31:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:31:59 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:31:59 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:31:59 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:31:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:31:59 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:31:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [99] with data {"GOT":"Victor Tyrell","LOTR":"Glorfindel"}
2025-06-05 13:31:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:02 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [100] with data {"GOT":"Willamen Frey","LOTR":"Théoden"}
2025-06-05 13:32:02 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:32:05 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:05 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:05 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:05 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:05 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:05 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:05 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:05 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:05 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:32:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:32:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:32:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:32:05 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:32:05 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:32:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [101] with data {"GOT":"Delonne Allyrion","LOTR":"Éomer"}
2025-06-05 13:32:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:32:07 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:07 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:07 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:32:07 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:32:08 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [102] with data {"GOT":"Rhialta Vance","LOTR":"Théoden"}
2025-06-05 13:32:08 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [103] with data {"GOT":"Rosamund Lannister","LOTR":"Legolas"}
2025-06-05 13:32:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [104] with data {"GOT":"Alannys Harlaw","LOTR":"Faramir"}
2025-06-05 13:32:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:32:15 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:15 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:15 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:15 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:15 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:15 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:15 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:15 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:15 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:15 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:32:15 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:32:15 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:32:15 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:32:15 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:32:15 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:32:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:32:15 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:15 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:15 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:32:15 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:32:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [105] with data {"GOT":"Shiera Crakehall","LOTR":"Beregond"}
2025-06-05 13:32:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:20 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [106] with data {"GOT":"Robin Greyjoy","LOTR":"Boromir"}
2025-06-05 13:32:20 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:32:23 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:23 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:23 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:32:23 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:32:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [107] with data {"GOT":"Lord Commander Qorgyle","LOTR":"Bilbo Baggins"}
2025-06-05 13:32:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:32:25 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:25 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:25 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:25 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:25 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:25 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:25 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:25 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:25 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:25 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:32:25 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:32:25 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:32:25 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:32:25 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:32:25 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:32:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [108] with data {"GOT":"Stonehand","LOTR":"Meriadoc Brandybuck"}
2025-06-05 13:32:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [109] with data {"GOT":"Boremund Harlaw","LOTR":"Gandalf the Grey"}
2025-06-05 13:32:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:32:31 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:31 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:31 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:32:31 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:32:32 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [110] with data {"GOT":"Cuger","LOTR":"Shelob"}
2025-06-05 13:32:32 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:32:35 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:35 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:35 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:35 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:35 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:35 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:35 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:35 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:35 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:32:35 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:35 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:32:35 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:32:35 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:32:35 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:32:35 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:32:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id fc3b792f-f4b4-4b13-8c05-d4fcba9ee4e5
2025-06-05 13:32:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [111] with data {"GOT":"Wylla Manderly","LOTR":"Legolas"}
2025-06-05 13:32:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:35 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:32:35 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(fc3b792f-f4b4-4b13-8c05-d4fcba9ee4e5) already exists.
2025-06-05 13:32:35 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(fc3b792f-f4b4-4b13-8c05-d4fcba9ee4e5) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:100)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(fc3b792f-f4b4-4b13-8c05-d4fcba9ee4e5) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(fc3b792f-f4b4-4b13-8c05-d4fcba9ee4e5) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:32:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [113] with data {"GOT":"Quill","LOTR":"Peregrin Took"}
2025-06-05 13:32:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:32:39 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:39 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:39 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:32:39 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:32:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [114] with data {"GOT":"Arrec Durrandon","LOTR":"Samwise Gamgee"}
2025-06-05 13:32:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:44 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [115] with data {"GOT":"Goady","LOTR":"Galadriel"}
2025-06-05 13:32:44 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:32:45 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:45 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:45 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:45 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:45 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:45 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:45 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:32:45 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:45 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:32:45 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:45 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:32:45 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:45 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:32:45 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:32:45 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:32:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:32:47 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:47 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:47 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:32:47 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:32:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [116] with data {"GOT":"Benedict","LOTR":"Sauron"}
2025-06-05 13:32:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:50 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [117] with data {"GOT":"Guncer Sunglass","LOTR":"Glorfindel"}
2025-06-05 13:32:50 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [118] with data {"GOT":"Red Oarsman","LOTR":"Arwen Evenstar"}
2025-06-05 13:32:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:32:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:32:55 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:55 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:55 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:55 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:55 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:55 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:55 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:55 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:32:55 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:55 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:55 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:32:55 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:32:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:32:55 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:32:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:32:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:32:55 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:32:55 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:32:55 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:32:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:32:55 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:32:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [119] with data {"GOT":"Barth","LOTR":"Tom Bombadil"}
2025-06-05 13:32:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [120] with data {"GOT":"Daeryssa","LOTR":"Quickbeam"}
2025-06-05 13:33:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [121] with data {"GOT":"Cragorn","LOTR":"Quickbeam"}
2025-06-05 13:33:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:33:03 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:03 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:03 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:33:03 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:33:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:33:05 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:05 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:05 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:05 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:05 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:05 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:05 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:05 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:05 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:33:05 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:33:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:33:05 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:33:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:33:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:33:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [122] with data {"GOT":"Errok","LOTR":"Shelob"}
2025-06-05 13:33:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [123] with data {"GOT":"Damion Lannister","LOTR":"Quickbeam"}
2025-06-05 13:33:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:33:11 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:11 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:11 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:33:11 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:33:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [124] with data {"GOT":"Danelle Lothston","LOTR":"Barliman Butterbur"}
2025-06-05 13:33:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [125] with data {"GOT":"Ormond","LOTR":"Aragorn"}
2025-06-05 13:33:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:33:15 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:15 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:15 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:15 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:15 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:15 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:15 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:15 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:33:15 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:33:15 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:15 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:15 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:33:15 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:33:15 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:33:15 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:33:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [126] with data {"GOT":"Unella","LOTR":"Gandalf the Grey"}
2025-06-05 13:33:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:33:19 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:19 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:19 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:33:19 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:33:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [127] with data {"GOT":"Cleos Frey","LOTR":"Bilbo Baggins"}
2025-06-05 13:33:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [128] with data {"GOT":"Manfrey Martell","LOTR":"Bilbo Baggins"}
2025-06-05 13:33:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:33:25 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:25 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:25 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:25 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:25 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:25 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:25 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:25 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:25 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:33:25 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:33:25 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:33:25 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:33:25 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:25 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:33:25 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:33:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [129] with data {"GOT":"Hamish the Harper","LOTR":"Legolas"}
2025-06-05 13:33:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:33:27 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:27 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:27 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:33:27 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:33:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [130] with data {"GOT":"Sansa Stark","LOTR":"Denethor"}
2025-06-05 13:33:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [131] with data {"GOT":"Walton Stark","LOTR":"Legolas"}
2025-06-05 13:33:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:33:35 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:35 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:35 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:35 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:35 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:35 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:35 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:35 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:33:35 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:33:35 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:35 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:33:35 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:33:35 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:35 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:33:35 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:33:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:33:35 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:35 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:35 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:33:35 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:33:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [132] with data {"GOT":"Toregg the Tall","LOTR":"Éowyn"}
2025-06-05 13:33:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [133] with data {"GOT":"Kym","LOTR":"Elrond"}
2025-06-05 13:33:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [134] with data {"GOT":"Becca the Baker","LOTR":"Gandalf the Grey"}
2025-06-05 13:33:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:33:43 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:43 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:43 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:33:43 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:33:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:33:45 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:45 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:45 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:45 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:45 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:45 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:45 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:45 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:33:45 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:33:45 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:45 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:45 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:33:45 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:33:45 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:33:45 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:33:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [135] with data {"GOT":"Tywin Frey","LOTR":"Faramir"}
2025-06-05 13:33:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [136] with data {"GOT":"Sharna","LOTR":"Bilbo Baggins"}
2025-06-05 13:33:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:33:51 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:51 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:51 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:33:51 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:33:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [137] with data {"GOT":"Malwyn Frey","LOTR":"Beregond"}
2025-06-05 13:33:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [138] with data {"GOT":"Alannys Harlaw","LOTR":"Legolas"}
2025-06-05 13:33:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:33:55 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:55 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:55 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:55 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:55 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:55 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:55 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:55 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:33:55 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:33:55 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:33:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:33:55 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:55 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:33:55 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:33:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [139] with data {"GOT":"Rafe","LOTR":"Sauron"}
2025-06-05 13:33:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:33:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:33:59 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:33:59 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:33:59 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:33:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:33:59 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:34:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [140] with data {"GOT":"Mylenda Caron","LOTR":"Grìma Wormtongue"}
2025-06-05 13:34:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:34:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 8c4bb0b1-dceb-4d91-bec3-f721199584f7
2025-06-05 13:34:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [141] with data {"GOT":"Becca","LOTR":"Gandalf the Grey"}
2025-06-05 13:34:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:34:03 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:34:03 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(8c4bb0b1-dceb-4d91-bec3-f721199584f7) already exists.
2025-06-05 13:34:03 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(8c4bb0b1-dceb-4d91-bec3-f721199584f7) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:100)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(8c4bb0b1-dceb-4d91-bec3-f721199584f7) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(8c4bb0b1-dceb-4d91-bec3-f721199584f7) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:34:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:34:05 [pool-3-thread-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:34:05 [pool-3-thread-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:34:05 [pool-3-thread-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:34:05 [pool-3-thread-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:34:05 [pool-3-thread-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:34:05 [pool-3-thread-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:34:05 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:34:05 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 0 messages []
2025-06-05 13:34:05 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:34:05 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:34:05 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND non_timeout_retries <= ?
ORDER BY internal_id ASC
FETCH FIRST ? ROWS ONLY
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:34:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 0 messages []
2025-06-05 13:34:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 0 messages []
2025-06-05 13:34:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:34:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:34:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [143] with data {"GOT":"Halmon Paege","LOTR":"Peregrin Took"}
2025-06-05 13:34:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:34:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:34:07 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42601
2025-06-05 13:34:07 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: syntax error at or near "$1"
  Position: 15
2025-06-05 13:34:07 [scheduling-1] ERROR j.d.q.g.GenericQueueProcessor - Error retrieving queue messages from DB, abnormal: JDBC exception executing SQL [SELECT * FROM ?
WHERE processed_at IS NULL
AND arrived_at < ?
ORDER BY internal_id ASC
FOR NO KEY UPDATE SKIP LOCKED
] [ERROR: syntax error at or near "$1"
  Position: 15] [n/a]; SQL [n/a]
2025-06-05 13:34:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:34:07 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:804)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.generic_queue.GenericQueueWorker$$SpringCGLIB$$0.moveToDeadLetterQueue(<generated>)
	at jon.db.queue.generic_queue.GenericQueueScheduler.moveToDLQ(GenericQueuePoller.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:34:09 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 13:34:16 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 23328 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:34:16 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:34:16 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:34:17 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:34:18 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:34:18 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:34:18 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:34:20 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:34:20 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 114 ms. Found 2 JPA repository interfaces.
2025-06-05 13:34:21 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:34:21 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:34:21 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:34:21 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:34:21 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:34:21 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2767 ms
2025-06-05 13:34:21 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:34:22 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:34:22 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:34:22 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:34:22 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:34:23 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@664be377
2025-06-05 13:34:23 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:34:23 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:34:24 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:34:24 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:34:25 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:34:26 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:34:26 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:34:26 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:34:26 [restartedMain] INFO  jon.db.queue.Application - Started Application in 10.833 seconds (process running for 11.942)
2025-06-05 13:34:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:34:26 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [1, 2, 3]
2025-06-05 13:34:26 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [7, 8, 9]
2025-06-05 13:34:26 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [4, 5, 6]
2025-06-05 13:34:26 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 4 with data: {"GOT": "Anya Waynwood", "LOTR": "Elrond"}
2025-06-05 13:34:26 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 7 with data: {"GOT": "Peter Plumm", "LOTR": "Gollum"}
2025-06-05 13:34:26 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 1 with data: {"GOT": "Hodor", "LOTR": "Éomer"}
2025-06-05 13:34:26 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 5 with data: {"GOT": "Dontos Hollard", "LOTR": "Gandalf the Grey"}
2025-06-05 13:34:26 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 8 with data: {"GOT": "Cedrik Storm", "LOTR": "Elrond"}
2025-06-05 13:34:26 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 7: Simulating Random error
2025-06-05 13:34:26 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 2 with data: {"GOT": "Joth Quickbow", "LOTR": "Gandalf the Grey"}
2025-06-05 13:34:26 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 2: Simulating Random error
2025-06-05 13:34:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [144] with data {"GOT":"Kyra","LOTR":"Galadriel"}
2025-06-05 13:34:27 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 3 with data: {"GOT": "Michael Mertyns", "LOTR": "Éomer"}
2025-06-05 13:34:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:34:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:34:29 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 6 with data: {"GOT": "Dagon Ironmaker", "LOTR": "Treebeard"}
2025-06-05 13:34:29 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 6: Simulating Random error
2025-06-05 13:34:29 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 9 with data: {"GOT": "Selwyn Tarth", "LOTR": "Legolas"}
2025-06-05 13:34:29 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:34:29 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:34:29 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-06-05 13:34:29 [http-nio-8080-exec-1] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 1
2025-06-05 13:34:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [145] with data {"GOT":"Jon Heddle","LOTR":"Gollum"}
2025-06-05 13:34:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:34:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [146] with data {"GOT":"Samwell Tarly","LOTR":"Legolas"}
2025-06-05 13:34:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:34:34 [http-nio-8080-exec-3] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 2
2025-06-05 13:34:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:34:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:34:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [147] with data {"GOT":"Hallis Mollen","LOTR":"Saruman the White"}
2025-06-05 13:34:36 [scheduling-1] WARN  j.d.q.g.GenericQueueSseEmitter - Failed to send message to client: 1
org.springframework.web.context.request.async.AsyncRequestNotUsableException: ServletOutputStream failed to flush: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleHttpServletResponse.handleIOException(StandardServletAsyncWebRequest.java:346)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:418)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.apache.catalina.connector.ClientAbortException: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:304)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	... 32 common frames omitted
Caused by: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	... 35 common frames omitted
2025-06-05 13:34:36 [http-nio-8080-exec-4] ERROR j.d.q.g.GenericQueueSseEmitter - SSE error for client: 1
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:34:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:34:36 [http-nio-8080-exec-4] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:34:36 [http-nio-8080-exec-4] INFO  j.d.q.g.GenericQueueSseEmitter - SSE connection completed for client: 1
2025-06-05 13:34:36 [http-nio-8080-exec-4] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:34:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:34:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [148] with data {"GOT":"Cadwyn","LOTR":"Gollum"}
2025-06-05 13:34:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:34:41 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:34:41 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [2, 6, 7]
2025-06-05 13:34:41 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 6 with data: {"GOT": "Dagon Ironmaker", "LOTR": "Treebeard"}
2025-06-05 13:34:41 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 2 with data: {"GOT": "Joth Quickbow", "LOTR": "Gandalf the Grey"}
2025-06-05 13:34:41 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 7 with data: {"GOT": "Peter Plumm", "LOTR": "Gollum"}
2025-06-05 13:34:41 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 6: Simulating Random error
2025-06-05 13:34:41 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 2: Simulating Random error
2025-06-05 13:34:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [149] with data {"GOT":"Raymund Frey","LOTR":"Faramir"}
2025-06-05 13:34:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:34:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:34:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:34:44 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:34:45 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:34:45 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [2, 6, 10]
2025-06-05 13:34:45 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 2 with data: {"GOT": "Joth Quickbow", "LOTR": "Gandalf the Grey"}
2025-06-05 13:34:45 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 6 with data: {"GOT": "Dagon Ironmaker", "LOTR": "Treebeard"}
2025-06-05 13:34:45 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 10 with data: {"GOT": "Shyra", "LOTR": "Théoden"}
2025-06-05 13:34:45 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 2: Simulating Random error
2025-06-05 13:34:45 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 6: Simulating Random error
2025-06-05 13:34:45 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 10: Simulating Random error
2025-06-05 13:34:45 [pool-2-thread-5] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 2 with id f51b309a-3329-4e24-82b1-c7c835dc34e4 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:34:45 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 6 with id 9a7c042b-1aee-41bc-9d47-a1843a4b0cba has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:34:45 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [12, 13, 14]
2025-06-05 13:34:45 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 12 with data: {"GOT": "Robin Flint", "LOTR": "Théoden"}
2025-06-05 13:34:45 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 13 with data: {"GOT": "Jaehaera Targaryen", "LOTR": "Boromir"}
2025-06-05 13:34:45 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 14 with data: {"GOT": "Mors Manwoody", "LOTR": "Arwen Evenstar"}
2025-06-05 13:34:45 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#2]
2025-06-05 13:34:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [150] with data {"GOT":"Addam Osgrey","LOTR":"Arwen Evenstar"}
2025-06-05 13:34:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:34:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:34:46 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [10, 15, 16]
2025-06-05 13:34:46 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 10 with data: {"GOT": "Shyra", "LOTR": "Théoden"}
2025-06-05 13:34:46 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 15 with data: {"GOT": "Meliana", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:34:46 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 16 with data: {"GOT": "Steffon Hollard", "LOTR": "Glorfindel"}
2025-06-05 13:34:46 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 16: Simulating Random error
2025-06-05 13:34:48 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:34:48 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [16, 17, 18]
2025-06-05 13:34:48 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 16 with data: {"GOT": "Steffon Hollard", "LOTR": "Glorfindel"}
2025-06-05 13:34:48 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 17 with data: {"GOT": "Mawney", "LOTR": "Théoden"}
2025-06-05 13:34:48 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 16: Simulating Random error
2025-06-05 13:34:48 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 17: Simulating Random error
2025-06-05 13:34:48 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 18 with data: {"GOT": "Henly", "LOTR": "Denethor"}
2025-06-05 13:34:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [151] with data {"GOT":"Tansy","LOTR":"Gollum"}
2025-06-05 13:34:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:34:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:34:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:34:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [152] with data {"GOT":"Qarl Correy","LOTR":"Shadowfax"}
2025-06-05 13:34:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:34:53 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:34:53 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [16, 17, 19]
2025-06-05 13:34:53 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 16 with data: {"GOT": "Steffon Hollard", "LOTR": "Glorfindel"}
2025-06-05 13:34:53 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 17 with data: {"GOT": "Mawney", "LOTR": "Théoden"}
2025-06-05 13:34:53 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 16: Simulating Random error
2025-06-05 13:34:53 [pool-2-thread-1] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 16 with id fcab877d-e285-4c28-b9e9-2437a1a2ba96 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:34:53 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 19 with data: {"GOT": "Meg", "LOTR": "Sauron"}
2025-06-05 13:34:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [153] with data {"GOT":"Alester Florent","LOTR":"Aragorn"}
2025-06-05 13:34:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:34:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:34:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [154] with data {"GOT":"Syrio Forel","LOTR":"Éowyn"}
2025-06-05 13:34:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:34:57 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:34:57 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [20, 21, 22]
2025-06-05 13:34:57 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 20 with data: {"GOT": "Collio Quaynis", "LOTR": "Boromir"}
2025-06-05 13:34:57 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 21 with data: {"GOT": "Gyles III Gardener", "LOTR": "Samwise Gamgee"}
2025-06-05 13:34:57 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 21: Simulating Random error
2025-06-05 13:34:57 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 22 with data: {"GOT": "Prendahl na Ghezn", "LOTR": "Shadowfax"}
2025-06-05 13:34:57 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 22: Simulating Random error
2025-06-05 13:34:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:34:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:35:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [155] with data {"GOT":"Genna Lannister","LOTR":"Gollum"}
2025-06-05 13:35:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [156] with data {"GOT":"Harwin Strong","LOTR":"Gimli"}
2025-06-05 13:35:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:35:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [21, 22, 23]
2025-06-05 13:35:05 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 22 with data: {"GOT": "Prendahl na Ghezn", "LOTR": "Shadowfax"}
2025-06-05 13:35:05 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 21 with data: {"GOT": "Gyles III Gardener", "LOTR": "Samwise Gamgee"}
2025-06-05 13:35:05 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 22: Simulating Random error
2025-06-05 13:35:05 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 21: Simulating Random error
2025-06-05 13:35:05 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 23 with data: {"GOT": "Quaro", "LOTR": "Legolas"}
2025-06-05 13:35:05 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 23: Simulating Random error
2025-06-05 13:35:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:35:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [21, 22, 23]
2025-06-05 13:35:05 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 21 with data: {"GOT": "Gyles III Gardener", "LOTR": "Samwise Gamgee"}
2025-06-05 13:35:05 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 22 with data: {"GOT": "Prendahl na Ghezn", "LOTR": "Shadowfax"}
2025-06-05 13:35:05 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 23 with data: {"GOT": "Quaro", "LOTR": "Legolas"}
2025-06-05 13:35:05 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 23: Simulating Random error
2025-06-05 13:35:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [157] with data {"GOT":"Rickard Thorne","LOTR":"Éowyn"}
2025-06-05 13:35:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:35:06 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:35:06 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [23, 24, 25]
2025-06-05 13:35:06 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 23 with data: {"GOT": "Quaro", "LOTR": "Legolas"}
2025-06-05 13:35:06 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 25 with data: {"GOT": "Alliser Thorne", "LOTR": "Shelob"}
2025-06-05 13:35:06 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 24 with data: {"GOT": "Jate Blackberry", "LOTR": "Sauron"}
2025-06-05 13:35:06 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 23: Simulating Random error
2025-06-05 13:35:06 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 25: Simulating Random error
2025-06-05 13:35:06 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 24: Simulating Random error
2025-06-05 13:35:06 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 23 with id 288d4dcd-b3d1-468e-8206-7c2e6fb1d293 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:35:06 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#23]
2025-06-05 13:35:06 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [24, 25, 26]
2025-06-05 13:35:06 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 24 with data: {"GOT": "Jate Blackberry", "LOTR": "Sauron"}
2025-06-05 13:35:06 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 25 with data: {"GOT": "Alliser Thorne", "LOTR": "Shelob"}
2025-06-05 13:35:06 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 26 with data: {"GOT": "Woth", "LOTR": "Saruman the White"}
2025-06-05 13:35:06 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 25: Simulating Random error
2025-06-05 13:35:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:35:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:35:09 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#16]
2025-06-05 13:35:09 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [25, 27, 28]
2025-06-05 13:35:09 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 25 with data: {"GOT": "Alliser Thorne", "LOTR": "Shelob"}
2025-06-05 13:35:09 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 27 with data: {"GOT": "Dolf", "LOTR": "Tom Bombadil"}
2025-06-05 13:35:09 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 25: Simulating Random error
2025-06-05 13:35:09 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 27: Simulating Random error
2025-06-05 13:35:09 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 25 with id 6f143b1e-e867-4f1e-b41e-ccd55fd535e1 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:35:09 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 28 with data: {"GOT": "Alester Florent", "LOTR": "Treebeard"}
2025-06-05 13:35:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [158] with data {"GOT":"Umar","LOTR":"Frodo Baggins"}
2025-06-05 13:35:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [159] with data {"GOT":"Morrec","LOTR":"Legolas"}
2025-06-05 13:35:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:35:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:35:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [160] with data {"GOT":"Robin Hill","LOTR":"Tom Bombadil"}
2025-06-05 13:35:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:35:17 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:35:17 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [27, 29, 30]
2025-06-05 13:35:17 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 27 with data: {"GOT": "Dolf", "LOTR": "Tom Bombadil"}
2025-06-05 13:35:17 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 30 with data: {"GOT": "Lucan", "LOTR": "Barliman Butterbur"}
2025-06-05 13:35:17 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 29 with data: {"GOT": "Poetess", "LOTR": "Shadowfax"}
2025-06-05 13:35:17 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 30: Simulating Random error
2025-06-05 13:35:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [161] with data {"GOT":"Reysen","LOTR":"Frodo Baggins"}
2025-06-05 13:35:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id e71ffa29-587f-4fdd-8a00-a5d353175203
2025-06-05 13:35:21 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:35:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [162] with data {"GOT":"Lyonel Bentley","LOTR":"Peregrin Took"}
2025-06-05 13:35:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:21 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [30, 31, 33]
2025-06-05 13:35:21 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 30 with data: {"GOT": "Lucan", "LOTR": "Barliman Butterbur"}
2025-06-05 13:35:21 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 31 with data: {"GOT": "Haldon", "LOTR": "Treebeard"}
2025-06-05 13:35:21 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 30: Simulating Random error
2025-06-05 13:35:21 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 33 with data: {"GOT": "Waltyr Frey", "LOTR": "Legolas"}
2025-06-05 13:35:21 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:35:21 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(e71ffa29-587f-4fdd-8a00-a5d353175203) already exists.
2025-06-05 13:35:21 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(e71ffa29-587f-4fdd-8a00-a5d353175203) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(e71ffa29-587f-4fdd-8a00-a5d353175203) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(e71ffa29-587f-4fdd-8a00-a5d353175203) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:35:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:35:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:35:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [164] with data {"GOT":"Sailor's Wife","LOTR":"Boromir"}
2025-06-05 13:35:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:26 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#25]
2025-06-05 13:35:26 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [30, 34, 35]
2025-06-05 13:35:26 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 30 with data: {"GOT": "Lucan", "LOTR": "Barliman Butterbur"}
2025-06-05 13:35:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:35:27 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 34 with data: {"GOT": "Wynafryd Manderly", "LOTR": "Gollum"}
2025-06-05 13:35:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [165] with data {"GOT":"Luke of Longtown","LOTR":"Frodo Baggins"}
2025-06-05 13:35:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:30 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 35 with data: {"GOT": "Barre", "LOTR": "Shelob"}
2025-06-05 13:35:30 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:35:30 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 35: Simulating Random error
2025-06-05 13:35:30 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [35, 36, 37]
2025-06-05 13:35:30 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 35 with data: {"GOT": "Barre", "LOTR": "Shelob"}
2025-06-05 13:35:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [166] with data {"GOT":"Amerei Frey","LOTR":"Legolas"}
2025-06-05 13:35:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:35:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:35:32 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 36 with data: {"GOT": "Cynthea Frey", "LOTR": "Bilbo Baggins"}
2025-06-05 13:35:32 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 36: Simulating Random error
2025-06-05 13:35:32 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 37 with data: {"GOT": "Ronnet Connington", "LOTR": "Éomer"}
2025-06-05 13:35:32 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 37: Simulating Random error
2025-06-05 13:35:32 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:35:32 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [36, 37, 38]
2025-06-05 13:35:32 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 36 with data: {"GOT": "Cynthea Frey", "LOTR": "Bilbo Baggins"}
2025-06-05 13:35:32 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 36: Simulating Random error
2025-06-05 13:35:32 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 37 with data: {"GOT": "Ronnet Connington", "LOTR": "Éomer"}
2025-06-05 13:35:32 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 37: Simulating Random error
2025-06-05 13:35:32 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 38 with data: {"GOT": "Alys Frey", "LOTR": "Treebeard"}
2025-06-05 13:35:32 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 38: Simulating Random error
2025-06-05 13:35:32 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:35:32 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [36, 37, 38]
2025-06-05 13:35:32 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 36 with data: {"GOT": "Cynthea Frey", "LOTR": "Bilbo Baggins"}
2025-06-05 13:35:33 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 37 with data: {"GOT": "Ronnet Connington", "LOTR": "Éomer"}
2025-06-05 13:35:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 65e452c7-0d4e-4c87-895d-51d478e74543
2025-06-05 13:35:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [167] with data {"GOT":"Romny Weaver","LOTR":"Galadriel"}
2025-06-05 13:35:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:33 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:35:33 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(65e452c7-0d4e-4c87-895d-51d478e74543) already exists.
2025-06-05 13:35:33 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(65e452c7-0d4e-4c87-895d-51d478e74543) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(65e452c7-0d4e-4c87-895d-51d478e74543) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(65e452c7-0d4e-4c87-895d-51d478e74543) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:35:34 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 38 with data: {"GOT": "Alys Frey", "LOTR": "Treebeard"}
2025-06-05 13:35:34 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:35:34 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 38: Simulating Random error
2025-06-05 13:35:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:35:36 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [38, 39, 40]
2025-06-05 13:35:36 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 38 with data: {"GOT": "Alys Frey", "LOTR": "Treebeard"}
2025-06-05 13:35:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [169] with data {"GOT":"Jhezane","LOTR":"Bilbo Baggins"}
2025-06-05 13:35:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:35:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:35:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [170] with data {"GOT":"Mudge","LOTR":"Théoden"}
2025-06-05 13:35:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:41 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 39 with data: {"GOT": "Woth", "LOTR": "Théoden"}
2025-06-05 13:35:41 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:35:41 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 40 with data: {"GOT": "Gwin Goodbrother", "LOTR": "Galadriel"}
2025-06-05 13:35:41 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [40, 41, 42]
2025-06-05 13:35:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 8c4cbdf9-357c-4968-9769-67af6091457b
2025-06-05 13:35:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [171] with data {"GOT":"Maris","LOTR":"Elrond"}
2025-06-05 13:35:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:43 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:35:43 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(8c4cbdf9-357c-4968-9769-67af6091457b) already exists.
2025-06-05 13:35:43 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(8c4cbdf9-357c-4968-9769-67af6091457b) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(8c4cbdf9-357c-4968-9769-67af6091457b) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(8c4cbdf9-357c-4968-9769-67af6091457b) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:35:43 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 40 with data: {"GOT": "Gwin Goodbrother", "LOTR": "Galadriel"}
2025-06-05 13:35:43 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 40: Simulating Random error
2025-06-05 13:35:43 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 41 with data: {"GOT": "Gyldayn", "LOTR": "Gimli"}
2025-06-05 13:35:43 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 41: Simulating Random error
2025-06-05 13:35:43 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 42 with data: {"GOT": "Wallace Waynwood", "LOTR": "Peregrin Took"}
2025-06-05 13:35:43 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 42: Simulating Random error
2025-06-05 13:35:43 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:35:43 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [40, 41, 42]
2025-06-05 13:35:43 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 40 with data: {"GOT": "Gwin Goodbrother", "LOTR": "Galadriel"}
2025-06-05 13:35:43 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 40: Simulating Random error
2025-06-05 13:35:43 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 41 with data: {"GOT": "Gyldayn", "LOTR": "Gimli"}
2025-06-05 13:35:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id f83bde76-befe-41c1-9aa6-5455a266d75b
2025-06-05 13:35:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [173] with data {"GOT":"Watt","LOTR":"Sauron"}
2025-06-05 13:35:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:46 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:35:46 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(f83bde76-befe-41c1-9aa6-5455a266d75b) already exists.
2025-06-05 13:35:46 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(f83bde76-befe-41c1-9aa6-5455a266d75b) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(f83bde76-befe-41c1-9aa6-5455a266d75b) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(f83bde76-befe-41c1-9aa6-5455a266d75b) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:35:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:35:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:35:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:35:47 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 42 with data: {"GOT": "Wallace Waynwood", "LOTR": "Peregrin Took"}
2025-06-05 13:35:47 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 42: Simulating Random error
2025-06-05 13:35:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [175] with data {"GOT":"Willas Tyrell","LOTR":"Quickbeam"}
2025-06-05 13:35:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:49 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:35:49 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [40, 42, 43]
2025-06-05 13:35:49 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 40 with data: {"GOT": "Gwin Goodbrother", "LOTR": "Galadriel"}
2025-06-05 13:35:49 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 40: Simulating Random error
2025-06-05 13:35:49 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 42 with data: {"GOT": "Wallace Waynwood", "LOTR": "Peregrin Took"}
2025-06-05 13:35:49 [pool-2-thread-2] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 40 with id 2ad5ee44-990d-4be3-a19f-9c826d4b8142 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:35:49 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 43 with data: {"GOT": "Manfred Swann", "LOTR": "Saruman the White"}
2025-06-05 13:35:49 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:35:49 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [44, 45, 46]
2025-06-05 13:35:49 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 44 with data: {"GOT": "Utt", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:35:49 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 45 with data: {"GOT": "Marianne Vance", "LOTR": "Legolas"}
2025-06-05 13:35:51 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:35:51 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 46 with data: {"GOT": "Bump", "LOTR": "Arwen Evenstar"}
2025-06-05 13:35:51 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 46: Simulating Random error
2025-06-05 13:35:51 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [46, 47, 49]
2025-06-05 13:35:51 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 46 with data: {"GOT": "Bump", "LOTR": "Arwen Evenstar"}
2025-06-05 13:35:51 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 46: Simulating Random error
2025-06-05 13:35:51 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 47 with data: {"GOT": "Tagganaro", "LOTR": "Théoden"}
2025-06-05 13:35:51 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 49 with data: {"GOT": "Baelor I Targaryen", "LOTR": "Théoden"}
2025-06-05 13:35:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [176] with data {"GOT":"Ygritte","LOTR":"Elrond"}
2025-06-05 13:35:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:35:52 [http-nio-8080-exec-6] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 3
2025-06-05 13:35:54 [http-nio-8080-exec-8] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 4
2025-06-05 13:35:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [177] with data {"GOT":"Beck","LOTR":"Frodo Baggins"}
2025-06-05 13:35:55 [scheduling-1] WARN  j.d.q.g.GenericQueueSseEmitter - Failed to send message to client: 2
org.springframework.web.context.request.async.AsyncRequestNotUsableException: ServletOutputStream failed to flush: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleHttpServletResponse.handleIOException(StandardServletAsyncWebRequest.java:346)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:418)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.apache.catalina.connector.ClientAbortException: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:304)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	... 32 common frames omitted
Caused by: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	... 35 common frames omitted
2025-06-05 13:35:55 [http-nio-8080-exec-9] ERROR j.d.q.g.GenericQueueSseEmitter - SSE error for client: 2
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:35:55 [http-nio-8080-exec-10] ERROR j.d.q.g.GenericQueueSseEmitter - SSE error for client: 3
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:35:55 [scheduling-1] WARN  j.d.q.g.GenericQueueSseEmitter - Failed to send message to client: 3
org.springframework.web.context.request.async.AsyncRequestNotUsableException: ServletOutputStream failed to flush: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleHttpServletResponse.handleIOException(StandardServletAsyncWebRequest.java:346)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:418)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.apache.catalina.connector.ClientAbortException: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:304)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	... 32 common frames omitted
Caused by: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	... 35 common frames omitted
2025-06-05 13:35:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:35:55 [http-nio-8080-exec-10] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:35:55 [http-nio-8080-exec-10] INFO  j.d.q.g.GenericQueueSseEmitter - SSE connection completed for client: 3
2025-06-05 13:35:55 [http-nio-8080-exec-9] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:35:55 [http-nio-8080-exec-10] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:35:55 [http-nio-8080-exec-9] INFO  j.d.q.g.GenericQueueSseEmitter - SSE connection completed for client: 2
2025-06-05 13:35:55 [http-nio-8080-exec-9] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:35:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:35:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:35:56 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:35:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:35:56 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [46, 50, 51]
2025-06-05 13:35:56 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 46 with data: {"GOT": "Bump", "LOTR": "Arwen Evenstar"}
2025-06-05 13:35:56 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 50 with data: {"GOT": "Lewis Lanster", "LOTR": "Peregrin Took"}
2025-06-05 13:35:56 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 51 with data: {"GOT": "Cotter Pyke", "LOTR": "Saruman the White"}
2025-06-05 13:35:56 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 50: Simulating Random error
2025-06-05 13:35:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [178] with data {"GOT":"Horton Redfort","LOTR":"Shadowfax"}
2025-06-05 13:35:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [179] with data {"GOT":"Lothar Mallery","LOTR":"Gandalf the Grey"}
2025-06-05 13:36:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:36:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:36:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [180] with data {"GOT":"Gawen Wylde","LOTR":"Boromir"}
2025-06-05 13:36:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:04 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:36:04 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [50, 52, 53]
2025-06-05 13:36:04 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 50 with data: {"GOT": "Lewis Lanster", "LOTR": "Peregrin Took"}
2025-06-05 13:36:04 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 52 with data: {"GOT": "Arnolf Karstark", "LOTR": "Théoden"}
2025-06-05 13:36:04 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 53 with data: {"GOT": "Tobbot", "LOTR": "Éomer"}
2025-06-05 13:36:04 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 53: Simulating Random error
2025-06-05 13:36:04 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:36:04 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [54, 55, 56]
2025-06-05 13:36:04 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 54 with data: {"GOT": "Lady of the Leaves", "LOTR": "Samwise Gamgee"}
2025-06-05 13:36:04 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 55 with data: {"GOT": "Alysanne Bulwer", "LOTR": "Elrond"}
2025-06-05 13:36:04 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 56 with data: {"GOT": "Roose Bolton", "LOTR": "Gollum"}
2025-06-05 13:36:04 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 54: Simulating Random error
2025-06-05 13:36:04 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 56: Simulating Random error
2025-06-05 13:36:06 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#40]
2025-06-05 13:36:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:36:06 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [53, 54, 56]
2025-06-05 13:36:06 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 53 with data: {"GOT": "Tobbot", "LOTR": "Éomer"}
2025-06-05 13:36:06 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 54 with data: {"GOT": "Lady of the Leaves", "LOTR": "Samwise Gamgee"}
2025-06-05 13:36:06 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 56 with data: {"GOT": "Roose Bolton", "LOTR": "Gollum"}
2025-06-05 13:36:06 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 53: Simulating Random error
2025-06-05 13:36:06 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 56: Simulating Random error
2025-06-05 13:36:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [181] with data {"GOT":"Brandon Stark","LOTR":"Saruman the White"}
2025-06-05 13:36:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:08 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:36:08 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [53, 56, 57]
2025-06-05 13:36:08 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 56 with data: {"GOT": "Roose Bolton", "LOTR": "Gollum"}
2025-06-05 13:36:08 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 53 with data: {"GOT": "Tobbot", "LOTR": "Éomer"}
2025-06-05 13:36:08 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 57 with data: {"GOT": "Elmar Frey", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:36:08 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 56: Simulating Random error
2025-06-05 13:36:08 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 53: Simulating Random error
2025-06-05 13:36:08 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 56 with id db4e2df8-72cc-43c0-a703-3a3736175f03 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:36:08 [pool-2-thread-5] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 53 with id dc68c945-a553-4a32-93a5-1354fc17b995 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:36:08 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:36:08 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [58, 59, 60]
2025-06-05 13:36:08 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 58 with data: {"GOT": "Ralf", "LOTR": "Denethor"}
2025-06-05 13:36:08 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 59 with data: {"GOT": "Galbart Glover", "LOTR": "Théoden"}
2025-06-05 13:36:08 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 58: Simulating Random error
2025-06-05 13:36:08 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 60 with data: {"GOT": "Lyn Corbray", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:36:08 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#53]
2025-06-05 13:36:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [182] with data {"GOT":"Harwood Fell","LOTR":"Quickbeam"}
2025-06-05 13:36:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:36:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:36:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [183] with data {"GOT":"Donnel Drumm","LOTR":"Quickbeam"}
2025-06-05 13:36:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [184] with data {"GOT":"Antario Jast","LOTR":"Frodo Baggins"}
2025-06-05 13:36:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:36:16 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [58, 61, 62]
2025-06-05 13:36:16 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 58 with data: {"GOT": "Ralf", "LOTR": "Denethor"}
2025-06-05 13:36:16 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 61 with data: {"GOT": "Alequo Adarys", "LOTR": "Shelob"}
2025-06-05 13:36:16 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 62 with data: {"GOT": "Brown Bernarr", "LOTR": "Arwen Evenstar"}
2025-06-05 13:36:16 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 61: Simulating Random error
2025-06-05 13:36:16 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 62: Simulating Random error
2025-06-05 13:36:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:36:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:36:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [185] with data {"GOT":"Roelle","LOTR":"Aragorn"}
2025-06-05 13:36:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:20 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:36:20 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [61, 62, 63]
2025-06-05 13:36:20 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 61 with data: {"GOT": "Alequo Adarys", "LOTR": "Shelob"}
2025-06-05 13:36:20 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 62 with data: {"GOT": "Brown Bernarr", "LOTR": "Arwen Evenstar"}
2025-06-05 13:36:20 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 63 with data: {"GOT": "Lenn", "LOTR": "Legolas"}
2025-06-05 13:36:20 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 62: Simulating Random error
2025-06-05 13:36:20 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 63: Simulating Random error
2025-06-05 13:36:20 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:36:20 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [62, 63, 64]
2025-06-05 13:36:20 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 62 with data: {"GOT": "Brown Bernarr", "LOTR": "Arwen Evenstar"}
2025-06-05 13:36:20 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 63 with data: {"GOT": "Lenn", "LOTR": "Legolas"}
2025-06-05 13:36:20 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 64 with data: {"GOT": "Sam Stoops", "LOTR": "Éowyn"}
2025-06-05 13:36:20 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 63: Simulating Random error
2025-06-05 13:36:20 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 64: Simulating Random error
2025-06-05 13:36:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [186] with data {"GOT":"Qhorin Halfhand","LOTR":"Gandalf the Grey"}
2025-06-05 13:36:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:22 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:36:23 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:36:23 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:36:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [187] with data {"GOT":"Nymella Toland","LOTR":"Éowyn"}
2025-06-05 13:36:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:36:26 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [66, 67, 68]
2025-06-05 13:36:26 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 66 with data: {"GOT": "Violet", "LOTR": "Samwise Gamgee"}
2025-06-05 13:36:26 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 67 with data: {"GOT": "Rob", "LOTR": "Shelob"}
2025-06-05 13:36:26 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 68 with data: {"GOT": "Quaro", "LOTR": "Gandalf the Grey"}
2025-06-05 13:36:26 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [63, 64, 65]
2025-06-05 13:36:26 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [69, 70, 71]
2025-06-05 13:36:26 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 63 with data: {"GOT": "Lenn", "LOTR": "Legolas"}
2025-06-05 13:36:26 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 64 with data: {"GOT": "Sam Stoops", "LOTR": "Éowyn"}
2025-06-05 13:36:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:36:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:36:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [188] with data {"GOT":"Euron Greyjoy","LOTR":"Treebeard"}
2025-06-05 13:36:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:28 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 65 with data: {"GOT": "Cleon", "LOTR": "Shelob"}
2025-06-05 13:36:29 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 69 with data: {"GOT": "Dan", "LOTR": "Samwise Gamgee"}
2025-06-05 13:36:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [189] with data {"GOT":"Ternesio Terys","LOTR":"Tom Bombadil"}
2025-06-05 13:36:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:32 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 70 with data: {"GOT": "Duncan", "LOTR": "Éowyn"}
2025-06-05 13:36:32 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 70: Simulating Random error
2025-06-05 13:36:32 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 71 with data: {"GOT": "Alys Karstark", "LOTR": "Samwise Gamgee"}
2025-06-05 13:36:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [190] with data {"GOT":"Urzen","LOTR":"Gollum"}
2025-06-05 13:36:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:36:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:36:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:36:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [191] with data {"GOT":"Taena of Myr","LOTR":"Barliman Butterbur"}
2025-06-05 13:36:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 8f828c56-2904-4ac4-85a3-6df979a0e545
2025-06-05 13:36:40 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:36:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [192] with data {"GOT":"Harmune","LOTR":"Grìma Wormtongue"}
2025-06-05 13:36:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:40 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [70, 72, 73]
2025-06-05 13:36:40 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 70 with data: {"GOT": "Duncan", "LOTR": "Éowyn"}
2025-06-05 13:36:40 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 72 with data: {"GOT": "Myria Jordayne", "LOTR": "Shadowfax"}
2025-06-05 13:36:40 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 73 with data: {"GOT": "Helliweg", "LOTR": "Galadriel"}
2025-06-05 13:36:40 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 70: Simulating Random error
2025-06-05 13:36:40 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 73: Simulating Random error
2025-06-05 13:36:40 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 72: Simulating Random error
2025-06-05 13:36:40 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:36:40 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:36:40 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(8f828c56-2904-4ac4-85a3-6df979a0e545) already exists.
2025-06-05 13:36:40 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(8f828c56-2904-4ac4-85a3-6df979a0e545) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(8f828c56-2904-4ac4-85a3-6df979a0e545) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(8f828c56-2904-4ac4-85a3-6df979a0e545) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:36:40 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [70, 72, 73]
2025-06-05 13:36:40 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 70 with data: {"GOT": "Duncan", "LOTR": "Éowyn"}
2025-06-05 13:36:40 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 73 with data: {"GOT": "Helliweg", "LOTR": "Galadriel"}
2025-06-05 13:36:40 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 72 with data: {"GOT": "Myria Jordayne", "LOTR": "Shadowfax"}
2025-06-05 13:36:40 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 73: Simulating Random error
2025-06-05 13:36:40 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 72: Simulating Random error
2025-06-05 13:36:42 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:36:42 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [72, 73, 74]
2025-06-05 13:36:42 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 72 with data: {"GOT": "Myria Jordayne", "LOTR": "Shadowfax"}
2025-06-05 13:36:42 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 73 with data: {"GOT": "Helliweg", "LOTR": "Galadriel"}
2025-06-05 13:36:42 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 74 with data: {"GOT": "Garth of Oldtown", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:36:42 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 73: Simulating Random error
2025-06-05 13:36:42 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 74: Simulating Random error
2025-06-05 13:36:42 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 73 with id b58641a5-1555-4e89-ae3d-a6f20e1184f1 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:36:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:36:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:36:43 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:36:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [194] with data {"GOT":"Alys Karstark","LOTR":"Quickbeam"}
2025-06-05 13:36:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:36:46 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [74, 75, 76]
2025-06-05 13:36:46 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 74 with data: {"GOT": "Garth of Oldtown", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:36:46 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 75 with data: {"GOT": "Brown Bernarr", "LOTR": "Denethor"}
2025-06-05 13:36:46 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 76 with data: {"GOT": "Cregan Karstark", "LOTR": "Shadowfax"}
2025-06-05 13:36:46 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 76: Simulating Random error
2025-06-05 13:36:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [195] with data {"GOT":"Owen","LOTR":"Gimli"}
2025-06-05 13:36:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [196] with data {"GOT":"Richard Horpe","LOTR":"Galadriel"}
2025-06-05 13:36:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:50 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#73]
2025-06-05 13:36:50 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [76, 77, 78]
2025-06-05 13:36:50 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 76 with data: {"GOT": "Cregan Karstark", "LOTR": "Shadowfax"}
2025-06-05 13:36:50 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 77 with data: {"GOT": "Melwyn Sarsfield", "LOTR": "Shadowfax"}
2025-06-05 13:36:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:36:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:36:52 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 78 with data: {"GOT": "Kaeth", "LOTR": "Glorfindel"}
2025-06-05 13:36:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [197] with data {"GOT":"Obara Sand","LOTR":"Frodo Baggins"}
2025-06-05 13:36:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [198] with data {"GOT":"Lucas Codd","LOTR":"Aragorn"}
2025-06-05 13:36:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:36:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [199] with data {"GOT":"Rolland Uffering","LOTR":"Tom Bombadil"}
2025-06-05 13:36:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:36:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:36:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:36:59 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:36:59 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [79, 80, 81]
2025-06-05 13:36:59 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 79 with data: {"GOT": "Joffrey Caswell", "LOTR": "Sauron"}
2025-06-05 13:36:59 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 79: Simulating Random error
2025-06-05 13:36:59 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 81 with data: {"GOT": "Lyonel Frey", "LOTR": "Denethor"}
2025-06-05 13:36:59 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 80 with data: {"GOT": "Colmar Frey", "LOTR": "Arwen Evenstar"}
2025-06-05 13:36:59 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 81: Simulating Random error
2025-06-05 13:37:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [200] with data {"GOT":"Ezzelyno","LOTR":"Boromir"}
2025-06-05 13:37:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [201] with data {"GOT":"Hugh","LOTR":"Grìma Wormtongue"}
2025-06-05 13:37:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:37:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [79, 81, 83]
2025-06-05 13:37:05 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 79 with data: {"GOT": "Joffrey Caswell", "LOTR": "Sauron"}
2025-06-05 13:37:05 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 81 with data: {"GOT": "Lyonel Frey", "LOTR": "Denethor"}
2025-06-05 13:37:05 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 79: Simulating Random error
2025-06-05 13:37:05 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 81: Simulating Random error
2025-06-05 13:37:05 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 83 with data: {"GOT": "Satin", "LOTR": "Faramir"}
2025-06-05 13:37:05 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 83: Simulating Random error
2025-06-05 13:37:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:37:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [79, 81, 83]
2025-06-05 13:37:05 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 79 with data: {"GOT": "Joffrey Caswell", "LOTR": "Sauron"}
2025-06-05 13:37:05 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 81 with data: {"GOT": "Lyonel Frey", "LOTR": "Denethor"}
2025-06-05 13:37:05 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 79: Simulating Random error
2025-06-05 13:37:05 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 83 with data: {"GOT": "Satin", "LOTR": "Faramir"}
2025-06-05 13:37:05 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 81: Simulating Random error
2025-06-05 13:37:05 [pool-2-thread-5] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 79 with id 8c153b31-86bf-4398-9ea0-8c15b1bcbda1 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:37:05 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 81 with id 1526411a-22ea-4eb5-9354-ab4d74a5a246 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:37:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:37:05 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#79]
2025-06-05 13:37:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [84, 85, 86]
2025-06-05 13:37:05 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 84 with data: {"GOT": "Shiera Seastar", "LOTR": "Théoden"}
2025-06-05 13:37:05 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 86 with data: {"GOT": "Willis Fell", "LOTR": "Éomer"}
2025-06-05 13:37:05 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 85 with data: {"GOT": "Tickler", "LOTR": "Gollum"}
2025-06-05 13:37:05 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 85: Simulating Random error
2025-06-05 13:37:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:37:06 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [85, 87, 88]
2025-06-05 13:37:06 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 85 with data: {"GOT": "Tickler", "LOTR": "Gollum"}
2025-06-05 13:37:06 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 87 with data: {"GOT": "Lenwood Tawney", "LOTR": "Elrond"}
2025-06-05 13:37:06 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 88 with data: {"GOT": "Harodon", "LOTR": "Éowyn"}
2025-06-05 13:37:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:37:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:37:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [202] with data {"GOT":"Daemon II Blackfyre","LOTR":"Barliman Butterbur"}
2025-06-05 13:37:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:09 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:37:09 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [89, 90, 91]
2025-06-05 13:37:09 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 89 with data: {"GOT": "Sebaston Farman", "LOTR": "Frodo Baggins"}
2025-06-05 13:37:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [203] with data {"GOT":"Biter","LOTR":"Gollum"}
2025-06-05 13:37:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [204] with data {"GOT":"Luwin","LOTR":"Samwise Gamgee"}
2025-06-05 13:37:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:37:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:37:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:37:16 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 90 with data: {"GOT": "Jeyne Beesbury", "LOTR": "Denethor"}
2025-06-05 13:37:16 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 91 with data: {"GOT": "Small Paul", "LOTR": "Éomer"}
2025-06-05 13:37:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [205] with data {"GOT":"Duncan","LOTR":"Peregrin Took"}
2025-06-05 13:37:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:20 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [206] with data {"GOT":"Godric Borrell","LOTR":"Grìma Wormtongue"}
2025-06-05 13:37:20 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:21 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:37:21 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [92, 93, 94]
2025-06-05 13:37:21 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 92 with data: {"GOT": "Hazzea", "LOTR": "Tom Bombadil"}
2025-06-05 13:37:21 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 93 with data: {"GOT": "Harry Sawyer", "LOTR": "Legolas"}
2025-06-05 13:37:21 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 92: Simulating Random error
2025-06-05 13:37:21 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 94 with data: {"GOT": "Quentin Tyrell", "LOTR": "Glorfindel"}
2025-06-05 13:37:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [207] with data {"GOT":"Spare Boot","LOTR":"Glorfindel"}
2025-06-05 13:37:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:37:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:37:23 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:37:23 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [92, 95, 96]
2025-06-05 13:37:23 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 92 with data: {"GOT": "Hazzea", "LOTR": "Tom Bombadil"}
2025-06-05 13:37:23 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 95 with data: {"GOT": "Harrold Westerling", "LOTR": "Glorfindel"}
2025-06-05 13:37:23 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 95: Simulating Random error
2025-06-05 13:37:23 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 96 with data: {"GOT": "Mallador Locke", "LOTR": "Éomer"}
2025-06-05 13:37:23 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 96: Simulating Random error
2025-06-05 13:37:24 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:37:24 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [95, 96, 97]
2025-06-05 13:37:24 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 95 with data: {"GOT": "Harrold Westerling", "LOTR": "Glorfindel"}
2025-06-05 13:37:24 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 96 with data: {"GOT": "Mallador Locke", "LOTR": "Éomer"}
2025-06-05 13:37:24 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 96: Simulating Random error
2025-06-05 13:37:24 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 97 with data: {"GOT": "Craghas Drahar", "LOTR": "Bilbo Baggins"}
2025-06-05 13:37:24 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 97: Simulating Random error
2025-06-05 13:37:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [208] with data {"GOT":"Andrew Estermont","LOTR":"Peregrin Took"}
2025-06-05 13:37:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:37:28 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:37:28 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [96, 97, 98]
2025-06-05 13:37:28 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 96 with data: {"GOT": "Mallador Locke", "LOTR": "Éomer"}
2025-06-05 13:37:28 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 97 with data: {"GOT": "Craghas Drahar", "LOTR": "Bilbo Baggins"}
2025-06-05 13:37:28 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 98 with data: {"GOT": "Steffon Frey", "LOTR": "Tom Bombadil"}
2025-06-05 13:37:28 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 97: Simulating Random error
2025-06-05 13:37:28 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 96: Simulating Random error
2025-06-05 13:37:28 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 98: Simulating Random error
2025-06-05 13:37:28 [pool-2-thread-2] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 96 with id cffa397f-b37d-4cbb-a6df-2020cc57d475 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:37:28 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#96]
2025-06-05 13:37:28 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [97, 98, 99]
2025-06-05 13:37:28 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 97 with data: {"GOT": "Craghas Drahar", "LOTR": "Bilbo Baggins"}
2025-06-05 13:37:28 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 98 with data: {"GOT": "Steffon Frey", "LOTR": "Tom Bombadil"}
2025-06-05 13:37:28 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 99 with data: {"GOT": "Victor Tyrell", "LOTR": "Glorfindel"}
2025-06-05 13:37:28 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 98: Simulating Random error
2025-06-05 13:37:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [209] with data {"GOT":"Robin Ryger","LOTR":"Arwen Evenstar"}
2025-06-05 13:37:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:37:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:37:32 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [210] with data {"GOT":"Brandon the Bad","LOTR":"Gandalf the Grey"}
2025-06-05 13:37:32 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [211] with data {"GOT":"Sumner Crakehall","LOTR":"Gimli"}
2025-06-05 13:37:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:37:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [212] with data {"GOT":"Quaithe","LOTR":"Arwen Evenstar"}
2025-06-05 13:37:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:37:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:37:39 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:37:39 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [98, 100, 101]
2025-06-05 13:37:39 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 100 with data: {"GOT": "Willamen Frey", "LOTR": "Théoden"}
2025-06-05 13:37:39 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 98 with data: {"GOT": "Steffon Frey", "LOTR": "Tom Bombadil"}
2025-06-05 13:37:39 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 101 with data: {"GOT": "Delonne Allyrion", "LOTR": "Éomer"}
2025-06-05 13:37:39 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 98: Simulating Random error
2025-06-05 13:37:39 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 98 with id 94eb22d4-b629-408c-9b49-ce395f8113e3 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:37:40 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:37:40 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [102, 103, 104]
2025-06-05 13:37:40 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 102 with data: {"GOT": "Rhialta Vance", "LOTR": "Théoden"}
2025-06-05 13:37:40 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 103 with data: {"GOT": "Rosamund Lannister", "LOTR": "Legolas"}
2025-06-05 13:37:40 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 104 with data: {"GOT": "Alannys Harlaw", "LOTR": "Faramir"}
2025-06-05 13:37:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [213] with data {"GOT":"Torwold Browntooth","LOTR":"Boromir"}
2025-06-05 13:37:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:42 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#98]
2025-06-05 13:37:42 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [105, 106, 107]
2025-06-05 13:37:42 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 105 with data: {"GOT": "Shiera Crakehall", "LOTR": "Beregond"}
2025-06-05 13:37:42 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 105: Simulating Random error
2025-06-05 13:37:42 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 106 with data: {"GOT": "Robin Greyjoy", "LOTR": "Boromir"}
2025-06-05 13:37:42 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 107 with data: {"GOT": "Lord Commander Qorgyle", "LOTR": "Bilbo Baggins"}
2025-06-05 13:37:42 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 107: Simulating Random error
2025-06-05 13:37:42 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:37:42 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [105, 107, 108]
2025-06-05 13:37:42 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 105 with data: {"GOT": "Shiera Crakehall", "LOTR": "Beregond"}
2025-06-05 13:37:42 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 107 with data: {"GOT": "Lord Commander Qorgyle", "LOTR": "Bilbo Baggins"}
2025-06-05 13:37:44 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [214] with data {"GOT":"Cedra","LOTR":"Gimli"}
2025-06-05 13:37:44 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:45 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 108 with data: {"GOT": "Stonehand", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:37:45 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 108: Simulating Random error
2025-06-05 13:37:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:37:46 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:37:46 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [108, 109, 110]
2025-06-05 13:37:46 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 108 with data: {"GOT": "Stonehand", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:37:46 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 109 with data: {"GOT": "Boremund Harlaw", "LOTR": "Gandalf the Grey"}
2025-06-05 13:37:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [215] with data {"GOT":"Robin","LOTR":"Galadriel"}
2025-06-05 13:37:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:37:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:37:50 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [216] with data {"GOT":"Marianne Vance","LOTR":"Théoden"}
2025-06-05 13:37:50 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:50 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 110 with data: {"GOT": "Cuger", "LOTR": "Shelob"}
2025-06-05 13:37:52 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:37:52 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [111, 113, 114]
2025-06-05 13:37:52 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 111 with data: {"GOT": "Wylla Manderly", "LOTR": "Legolas"}
2025-06-05 13:37:52 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 113 with data: {"GOT": "Quill", "LOTR": "Peregrin Took"}
2025-06-05 13:37:52 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 111: Simulating Random error
2025-06-05 13:37:52 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 114 with data: {"GOT": "Arrec Durrandon", "LOTR": "Samwise Gamgee"}
2025-06-05 13:37:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [217] with data {"GOT":"Shella Whent","LOTR":"Denethor"}
2025-06-05 13:37:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:37:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:37:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [218] with data {"GOT":"Larence Snow","LOTR":"Saruman the White"}
2025-06-05 13:37:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:37:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [219] with data {"GOT":"Osney Kettleblack","LOTR":"Sauron"}
2025-06-05 13:37:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:37:59 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:37:59 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [111, 115, 116]
2025-06-05 13:37:59 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 111 with data: {"GOT": "Wylla Manderly", "LOTR": "Legolas"}
2025-06-05 13:37:59 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 115 with data: {"GOT": "Goady", "LOTR": "Galadriel"}
2025-06-05 13:37:59 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 111: Simulating Random error
2025-06-05 13:37:59 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 116 with data: {"GOT": "Benedict", "LOTR": "Sauron"}
2025-06-05 13:37:59 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 116: Simulating Random error
2025-06-05 13:38:01 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:38:01 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [111, 116, 117]
2025-06-05 13:38:01 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 111 with data: {"GOT": "Wylla Manderly", "LOTR": "Legolas"}
2025-06-05 13:38:01 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 116 with data: {"GOT": "Benedict", "LOTR": "Sauron"}
2025-06-05 13:38:01 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 111: Simulating Random error
2025-06-05 13:38:01 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 116: Simulating Random error
2025-06-05 13:38:01 [pool-2-thread-1] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 111 with id fc3b792f-f4b4-4b13-8c05-d4fcba9ee4e5 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:38:01 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 117 with data: {"GOT": "Guncer Sunglass", "LOTR": "Glorfindel"}
2025-06-05 13:38:01 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 117: Simulating Random error
2025-06-05 13:38:01 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#111]
2025-06-05 13:38:01 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [116, 117, 118]
2025-06-05 13:38:01 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 116 with data: {"GOT": "Benedict", "LOTR": "Sauron"}
2025-06-05 13:38:01 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 117 with data: {"GOT": "Guncer Sunglass", "LOTR": "Glorfindel"}
2025-06-05 13:38:02 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [220] with data {"GOT":"Lomas Estermont","LOTR":"Quickbeam"}
2025-06-05 13:38:02 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:38:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:38:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [221] with data {"GOT":"Glendon Hewett","LOTR":"Quickbeam"}
2025-06-05 13:38:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:05 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:38:05 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 118 with data: {"GOT": "Red Oarsman", "LOTR": "Arwen Evenstar"}
2025-06-05 13:38:05 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 118: Simulating Random error
2025-06-05 13:38:05 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [118, 119, 120]
2025-06-05 13:38:05 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 118 with data: {"GOT": "Red Oarsman", "LOTR": "Arwen Evenstar"}
2025-06-05 13:38:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:38:06 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 119 with data: {"GOT": "Barth", "LOTR": "Tom Bombadil"}
2025-06-05 13:38:08 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [222] with data {"GOT":"Emmon Frey","LOTR":"Peregrin Took"}
2025-06-05 13:38:08 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:08 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:38:08 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 120 with data: {"GOT": "Daeryssa", "LOTR": "Quickbeam"}
2025-06-05 13:38:08 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 120: Simulating Random error
2025-06-05 13:38:08 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [120, 121, 122]
2025-06-05 13:38:08 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 120 with data: {"GOT": "Daeryssa", "LOTR": "Quickbeam"}
2025-06-05 13:38:10 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 121 with data: {"GOT": "Cragorn", "LOTR": "Quickbeam"}
2025-06-05 13:38:10 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 121: Simulating Random error
2025-06-05 13:38:10 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 122 with data: {"GOT": "Errok", "LOTR": "Shelob"}
2025-06-05 13:38:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:38:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:38:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [223] with data {"GOT":"Galtry the Green","LOTR":"Boromir"}
2025-06-05 13:38:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [224] with data {"GOT":"Lymond Goodbrook","LOTR":"Shelob"}
2025-06-05 13:38:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:15 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:38:15 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [121, 123, 124]
2025-06-05 13:38:15 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 121 with data: {"GOT": "Cragorn", "LOTR": "Quickbeam"}
2025-06-05 13:38:15 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 123 with data: {"GOT": "Damion Lannister", "LOTR": "Quickbeam"}
2025-06-05 13:38:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:38:16 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 124 with data: {"GOT": "Danelle Lothston", "LOTR": "Barliman Butterbur"}
2025-06-05 13:38:16 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 124: Simulating Random error
2025-06-05 13:38:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [225] with data {"GOT":"Sylva Santagar","LOTR":"Shelob"}
2025-06-05 13:38:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:19 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:38:19 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [124, 125, 126]
2025-06-05 13:38:19 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 125 with data: {"GOT": "Ormond", "LOTR": "Aragorn"}
2025-06-05 13:38:19 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 124 with data: {"GOT": "Danelle Lothston", "LOTR": "Barliman Butterbur"}
2025-06-05 13:38:19 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 125: Simulating Random error
2025-06-05 13:38:19 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 126 with data: {"GOT": "Unella", "LOTR": "Gandalf the Grey"}
2025-06-05 13:38:19 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 126: Simulating Random error
2025-06-05 13:38:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:38:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:38:20 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [226] with data {"GOT":"Daena Targaryen","LOTR":"Tom Bombadil"}
2025-06-05 13:38:20 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:22 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:38:22 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [125, 126, 127]
2025-06-05 13:38:22 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 125 with data: {"GOT": "Ormond", "LOTR": "Aragorn"}
2025-06-05 13:38:22 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 127 with data: {"GOT": "Cleos Frey", "LOTR": "Bilbo Baggins"}
2025-06-05 13:38:22 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 126 with data: {"GOT": "Unella", "LOTR": "Gandalf the Grey"}
2025-06-05 13:38:22 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 125: Simulating Random error
2025-06-05 13:38:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [227] with data {"GOT":"Serra Frey","LOTR":"Grìma Wormtongue"}
2025-06-05 13:38:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:24 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:38:24 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [125, 128, 129]
2025-06-05 13:38:24 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 125 with data: {"GOT": "Ormond", "LOTR": "Aragorn"}
2025-06-05 13:38:24 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 128 with data: {"GOT": "Manfrey Martell", "LOTR": "Bilbo Baggins"}
2025-06-05 13:38:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:38:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [228] with data {"GOT":"Rymolf","LOTR":"Treebeard"}
2025-06-05 13:38:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:26 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 129 with data: {"GOT": "Hamish the Harper", "LOTR": "Legolas"}
2025-06-05 13:38:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:38:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:38:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [229] with data {"GOT":"Morosh the Myrman","LOTR":"Barliman Butterbur"}
2025-06-05 13:38:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:32 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [230] with data {"GOT":"Goodwin","LOTR":"Elrond"}
2025-06-05 13:38:32 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:38:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:38:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [231] with data {"GOT":"Brogg","LOTR":"Frodo Baggins"}
2025-06-05 13:38:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:36 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:38:36 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [130, 131, 132]
2025-06-05 13:38:36 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 130 with data: {"GOT": "Sansa Stark", "LOTR": "Denethor"}
2025-06-05 13:38:36 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 131 with data: {"GOT": "Walton Stark", "LOTR": "Legolas"}
2025-06-05 13:38:36 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 131: Simulating Random error
2025-06-05 13:38:36 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 132 with data: {"GOT": "Toregg the Tall", "LOTR": "Éowyn"}
2025-06-05 13:38:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:38:37 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:38:37 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [131, 133, 134]
2025-06-05 13:38:37 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 131 with data: {"GOT": "Walton Stark", "LOTR": "Legolas"}
2025-06-05 13:38:37 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 133 with data: {"GOT": "Kym", "LOTR": "Elrond"}
2025-06-05 13:38:37 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 131: Simulating Random error
2025-06-05 13:38:37 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 133: Simulating Random error
2025-06-05 13:38:37 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 134 with data: {"GOT": "Becca the Baker", "LOTR": "Gandalf the Grey"}
2025-06-05 13:38:37 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 134: Simulating Random error
2025-06-05 13:38:37 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:38:37 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [131, 133, 134]
2025-06-05 13:38:37 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 131 with data: {"GOT": "Walton Stark", "LOTR": "Legolas"}
2025-06-05 13:38:37 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 133 with data: {"GOT": "Kym", "LOTR": "Elrond"}
2025-06-05 13:38:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [232] with data {"GOT":"Emrick","LOTR":"Shadowfax"}
2025-06-05 13:38:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:38 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 134 with data: {"GOT": "Becca the Baker", "LOTR": "Gandalf the Grey"}
2025-06-05 13:38:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [233] with data {"GOT":"Mathos Mallarawan","LOTR":"Éomer"}
2025-06-05 13:38:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:41 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:38:42 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [135, 136, 137]
2025-06-05 13:38:42 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 135 with data: {"GOT": "Tywin Frey", "LOTR": "Faramir"}
2025-06-05 13:38:42 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 135: Simulating Random error
2025-06-05 13:38:42 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 136 with data: {"GOT": "Sharna", "LOTR": "Bilbo Baggins"}
2025-06-05 13:38:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:38:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:38:44 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 137 with data: {"GOT": "Malwyn Frey", "LOTR": "Beregond"}
2025-06-05 13:38:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [234] with data {"GOT":"Theomore Harlaw","LOTR":"Grìma Wormtongue"}
2025-06-05 13:38:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:38:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [235] with data {"GOT":"Osbert Serry","LOTR":"Arwen Evenstar"}
2025-06-05 13:38:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:49 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:38:49 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [135, 138, 139]
2025-06-05 13:38:49 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 135 with data: {"GOT": "Tywin Frey", "LOTR": "Faramir"}
2025-06-05 13:38:49 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 138 with data: {"GOT": "Alannys Harlaw", "LOTR": "Legolas"}
2025-06-05 13:38:50 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 139 with data: {"GOT": "Rafe", "LOTR": "Sauron"}
2025-06-05 13:38:50 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 139: Simulating Random error
2025-06-05 13:38:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [236] with data {"GOT":"Philip Foote","LOTR":"Boromir"}
2025-06-05 13:38:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:38:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:38:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:38:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [139, 140, 141]
2025-06-05 13:38:53 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 139 with data: {"GOT": "Rafe", "LOTR": "Sauron"}
2025-06-05 13:38:53 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 140 with data: {"GOT": "Mylenda Caron", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:38:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 9bcc7f2e-99c5-41e4-9ea6-5663c5d74754
2025-06-05 13:38:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [237] with data {"GOT":"Ferrego Antaryon","LOTR":"Meriadoc Brandybuck"}
2025-06-05 13:38:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:54 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:38:54 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(9bcc7f2e-99c5-41e4-9ea6-5663c5d74754) already exists.
2025-06-05 13:38:54 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(9bcc7f2e-99c5-41e4-9ea6-5663c5d74754) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(9bcc7f2e-99c5-41e4-9ea6-5663c5d74754) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(9bcc7f2e-99c5-41e4-9ea6-5663c5d74754) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:38:55 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 141 with data: {"GOT": "Becca", "LOTR": "Gandalf the Grey"}
2025-06-05 13:38:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:38:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [141, 143, 144]
2025-06-05 13:38:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:38:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [239] with data {"GOT":"Weasel","LOTR":"Gandalf the Grey"}
2025-06-05 13:38:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:38:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:38:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:39:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [240] with data {"GOT":"Gerold Dayne","LOTR":"Meriadoc Brandybuck"}
2025-06-05 13:39:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:01 [http-nio-8080-exec-4] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 5
2025-06-05 13:39:01 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 141 with data: {"GOT": "Becca", "LOTR": "Gandalf the Grey"}
2025-06-05 13:39:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [241] with data {"GOT":"Mallor","LOTR":"Éomer"}
2025-06-05 13:39:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:05 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 144 with data: {"GOT": "Kyra", "LOTR": "Galadriel"}
2025-06-05 13:39:05 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 143 with data: {"GOT": "Halmon Paege", "LOTR": "Peregrin Took"}
2025-06-05 13:39:05 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 144: Simulating Random error
2025-06-05 13:39:05 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 143: Simulating Random error
2025-06-05 13:39:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [242] with data {"GOT":"Mallor","LOTR":"Théoden"}
2025-06-05 13:39:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:39:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:39:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:39:08 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:39:08 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [143, 144, 145]
2025-06-05 13:39:08 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 143 with data: {"GOT": "Halmon Paege", "LOTR": "Peregrin Took"}
2025-06-05 13:39:08 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 144 with data: {"GOT": "Kyra", "LOTR": "Galadriel"}
2025-06-05 13:39:08 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 145 with data: {"GOT": "Jon Heddle", "LOTR": "Gollum"}
2025-06-05 13:39:08 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 145: Simulating Random error
2025-06-05 13:39:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [243] with data {"GOT":"Clayton Suggs","LOTR":"Peregrin Took"}
2025-06-05 13:39:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [244] with data {"GOT":"Daemon II Blackfyre","LOTR":"Tom Bombadil"}
2025-06-05 13:39:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:13 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:39:13 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:39:13 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [145, 146, 147]
2025-06-05 13:39:13 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 145 with data: {"GOT": "Jon Heddle", "LOTR": "Gollum"}
2025-06-05 13:39:13 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 146 with data: {"GOT": "Samwell Tarly", "LOTR": "Legolas"}
2025-06-05 13:39:13 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 147 with data: {"GOT": "Hallis Mollen", "LOTR": "Saruman the White"}
2025-06-05 13:39:13 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 145: Simulating Random error
2025-06-05 13:39:13 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 147: Simulating Random error
2025-06-05 13:39:13 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [148, 149, 150]
2025-06-05 13:39:13 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 148 with data: {"GOT": "Cadwyn", "LOTR": "Gollum"}
2025-06-05 13:39:13 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 149 with data: {"GOT": "Raymund Frey", "LOTR": "Faramir"}
2025-06-05 13:39:13 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 149: Simulating Random error
2025-06-05 13:39:13 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 150 with data: {"GOT": "Addam Osgrey", "LOTR": "Arwen Evenstar"}
2025-06-05 13:39:13 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 150: Simulating Random error
2025-06-05 13:39:14 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:39:14 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [145, 147, 149]
2025-06-05 13:39:14 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 147 with data: {"GOT": "Hallis Mollen", "LOTR": "Saruman the White"}
2025-06-05 13:39:14 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 145 with data: {"GOT": "Jon Heddle", "LOTR": "Gollum"}
2025-06-05 13:39:14 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 149 with data: {"GOT": "Raymund Frey", "LOTR": "Faramir"}
2025-06-05 13:39:14 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:39:14 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [150, 151, 152]
2025-06-05 13:39:14 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 150 with data: {"GOT": "Addam Osgrey", "LOTR": "Arwen Evenstar"}
2025-06-05 13:39:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [245] with data {"GOT":"Mathis Rowan","LOTR":"Quickbeam"}
2025-06-05 13:39:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:39:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:39:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:39:18 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 151 with data: {"GOT": "Tansy", "LOTR": "Gollum"}
2025-06-05 13:39:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [246] with data {"GOT":"Sleepy Jack","LOTR":"Gandalf the Grey"}
2025-06-05 13:39:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:21 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 152 with data: {"GOT": "Qarl Correy", "LOTR": "Shadowfax"}
2025-06-05 13:39:21 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 152: Simulating Random error
2025-06-05 13:39:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [247] with data {"GOT":"Melwys Rivers","LOTR":"Glorfindel"}
2025-06-05 13:39:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:39:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:39:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [248] with data {"GOT":"Andar Royce","LOTR":"Frodo Baggins"}
2025-06-05 13:39:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:26 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:39:26 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [152, 153, 154]
2025-06-05 13:39:26 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 152 with data: {"GOT": "Qarl Correy", "LOTR": "Shadowfax"}
2025-06-05 13:39:26 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 153 with data: {"GOT": "Alester Florent", "LOTR": "Aragorn"}
2025-06-05 13:39:26 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 154 with data: {"GOT": "Syrio Forel", "LOTR": "Éowyn"}
2025-06-05 13:39:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:39:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [249] with data {"GOT":"Hilmar Drumm","LOTR":"Elrond"}
2025-06-05 13:39:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:28 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:39:28 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [155, 156, 157]
2025-06-05 13:39:28 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 155 with data: {"GOT": "Genna Lannister", "LOTR": "Gollum"}
2025-06-05 13:39:28 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 155: Simulating Random error
2025-06-05 13:39:28 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 156 with data: {"GOT": "Harwin Strong", "LOTR": "Gimli"}
2025-06-05 13:39:28 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 156: Simulating Random error
2025-06-05 13:39:28 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 157 with data: {"GOT": "Rickard Thorne", "LOTR": "Éowyn"}
2025-06-05 13:39:28 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 157: Simulating Random error
2025-06-05 13:39:28 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:39:28 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [155, 156, 157]
2025-06-05 13:39:28 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 155 with data: {"GOT": "Genna Lannister", "LOTR": "Gollum"}
2025-06-05 13:39:28 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 156 with data: {"GOT": "Harwin Strong", "LOTR": "Gimli"}
2025-06-05 13:39:28 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:39:28 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 156: Simulating Random error
2025-06-05 13:39:28 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [156, 157, 158]
2025-06-05 13:39:28 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 157 with data: {"GOT": "Rickard Thorne", "LOTR": "Éowyn"}
2025-06-05 13:39:28 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 157: Simulating Random error
2025-06-05 13:39:28 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 156 with data: {"GOT": "Harwin Strong", "LOTR": "Gimli"}
2025-06-05 13:39:28 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 157 with data: {"GOT": "Rickard Thorne", "LOTR": "Éowyn"}
2025-06-05 13:39:28 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 157: Simulating Random error
2025-06-05 13:39:28 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 158 with data: {"GOT": "Umar", "LOTR": "Frodo Baggins"}
2025-06-05 13:39:28 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 158: Simulating Random error
2025-06-05 13:39:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [250] with data {"GOT":"Alia","LOTR":"Bilbo Baggins"}
2025-06-05 13:39:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:39:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:39:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [251] with data {"GOT":"Elys Westerling","LOTR":"Galadriel"}
2025-06-05 13:39:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [252] with data {"GOT":"Marghaz zo Loraq","LOTR":"Frodo Baggins"}
2025-06-05 13:39:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:39:38 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:39:38 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [157, 158, 159]
2025-06-05 13:39:38 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 157 with data: {"GOT": "Rickard Thorne", "LOTR": "Éowyn"}
2025-06-05 13:39:38 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 158 with data: {"GOT": "Umar", "LOTR": "Frodo Baggins"}
2025-06-05 13:39:38 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 159 with data: {"GOT": "Morrec", "LOTR": "Legolas"}
2025-06-05 13:39:38 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 157: Simulating Random error
2025-06-05 13:39:38 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 158: Simulating Random error
2025-06-05 13:39:38 [pool-2-thread-5] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 157 with id dfb96c90-bfa1-4dee-8cac-969460850901 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:39:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [253] with data {"GOT":"Lysa Arryn","LOTR":"Denethor"}
2025-06-05 13:39:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:39:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:39:41 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:39:41 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [158, 160, 161]
2025-06-05 13:39:41 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 158 with data: {"GOT": "Umar", "LOTR": "Frodo Baggins"}
2025-06-05 13:39:41 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 160 with data: {"GOT": "Robin Hill", "LOTR": "Tom Bombadil"}
2025-06-05 13:39:41 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 161 with data: {"GOT": "Reysen", "LOTR": "Frodo Baggins"}
2025-06-05 13:39:41 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 160: Simulating Random error
2025-06-05 13:39:41 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 161: Simulating Random error
2025-06-05 13:39:42 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:39:42 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [160, 161, 162]
2025-06-05 13:39:42 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 160 with data: {"GOT": "Robin Hill", "LOTR": "Tom Bombadil"}
2025-06-05 13:39:42 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 162 with data: {"GOT": "Lyonel Bentley", "LOTR": "Peregrin Took"}
2025-06-05 13:39:42 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 161 with data: {"GOT": "Reysen", "LOTR": "Frodo Baggins"}
2025-06-05 13:39:42 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 162: Simulating Random error
2025-06-05 13:39:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id f9a525a7-67c8-4ea5-8251-21ebe2c4dd9d
2025-06-05 13:39:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [254] with data {"GOT":"Mordane","LOTR":"Legolas"}
2025-06-05 13:39:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:42 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:39:42 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(f9a525a7-67c8-4ea5-8251-21ebe2c4dd9d) already exists.
2025-06-05 13:39:42 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(f9a525a7-67c8-4ea5-8251-21ebe2c4dd9d) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(f9a525a7-67c8-4ea5-8251-21ebe2c4dd9d) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(f9a525a7-67c8-4ea5-8251-21ebe2c4dd9d) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:39:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [256] with data {"GOT":"Mina Tyrell","LOTR":"Éomer"}
2025-06-05 13:39:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:46 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:39:46 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [162, 164, 165]
2025-06-05 13:39:46 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 162 with data: {"GOT": "Lyonel Bentley", "LOTR": "Peregrin Took"}
2025-06-05 13:39:46 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 164 with data: {"GOT": "Sailor's Wife", "LOTR": "Boromir"}
2025-06-05 13:39:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:39:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:39:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:39:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [257] with data {"GOT":"Assadora of Ibben","LOTR":"Gollum"}
2025-06-05 13:39:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:49 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 165 with data: {"GOT": "Luke of Longtown", "LOTR": "Frodo Baggins"}
2025-06-05 13:39:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [258] with data {"GOT":"Lyle Crakehall","LOTR":"Galadriel"}
2025-06-05 13:39:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:53 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#157]
2025-06-05 13:39:53 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [166, 167, 169]
2025-06-05 13:39:53 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 166 with data: {"GOT": "Amerei Frey", "LOTR": "Legolas"}
2025-06-05 13:39:53 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 167 with data: {"GOT": "Romny Weaver", "LOTR": "Galadriel"}
2025-06-05 13:39:53 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 166: Simulating Random error
2025-06-05 13:39:53 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 167: Simulating Random error
2025-06-05 13:39:53 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 169 with data: {"GOT": "Jhezane", "LOTR": "Bilbo Baggins"}
2025-06-05 13:39:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [259] with data {"GOT":"Garth Greenhand","LOTR":"Galadriel"}
2025-06-05 13:39:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:39:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:39:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:39:57 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:39:57 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [166, 167, 170]
2025-06-05 13:39:57 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 166 with data: {"GOT": "Amerei Frey", "LOTR": "Legolas"}
2025-06-05 13:39:57 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 167 with data: {"GOT": "Romny Weaver", "LOTR": "Galadriel"}
2025-06-05 13:39:57 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 170 with data: {"GOT": "Mudge", "LOTR": "Théoden"}
2025-06-05 13:39:57 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 167: Simulating Random error
2025-06-05 13:39:57 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 170: Simulating Random error
2025-06-05 13:39:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [260] with data {"GOT":"Sigrin","LOTR":"Gollum"}
2025-06-05 13:39:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:39:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:39:58 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:39:58 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [167, 170, 171]
2025-06-05 13:39:58 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 167 with data: {"GOT": "Romny Weaver", "LOTR": "Galadriel"}
2025-06-05 13:39:58 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 170 with data: {"GOT": "Mudge", "LOTR": "Théoden"}
2025-06-05 13:39:58 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 171 with data: {"GOT": "Maris", "LOTR": "Elrond"}
2025-06-05 13:39:58 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 167: Simulating Random error
2025-06-05 13:39:58 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 170: Simulating Random error
2025-06-05 13:39:58 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 167 with id 65e452c7-0d4e-4c87-895d-51d478e74543 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:40:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [261] with data {"GOT":"Qyle","LOTR":"Tom Bombadil"}
2025-06-05 13:40:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:03 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:40:03 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [170, 173, 175]
2025-06-05 13:40:03 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 170 with data: {"GOT": "Mudge", "LOTR": "Théoden"}
2025-06-05 13:40:03 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 173 with data: {"GOT": "Watt", "LOTR": "Sauron"}
2025-06-05 13:40:03 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 175 with data: {"GOT": "Willas Tyrell", "LOTR": "Quickbeam"}
2025-06-05 13:40:03 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 170: Simulating Random error
2025-06-05 13:40:03 [pool-2-thread-5] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 170 with id 50003fa4-82c7-4dbb-9b17-87a81cfc9411 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:40:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [262] with data {"GOT":"Kedry","LOTR":"Éowyn"}
2025-06-05 13:40:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:40:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:40:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:40:05 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [176, 177, 178]
2025-06-05 13:40:05 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 176 with data: {"GOT": "Ygritte", "LOTR": "Elrond"}
2025-06-05 13:40:05 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 177 with data: {"GOT": "Beck", "LOTR": "Frodo Baggins"}
2025-06-05 13:40:05 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 176: Simulating Random error
2025-06-05 13:40:05 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 178 with data: {"GOT": "Horton Redfort", "LOTR": "Shadowfax"}
2025-06-05 13:40:05 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 178: Simulating Random error
2025-06-05 13:40:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:40:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [263] with data {"GOT":"Eden Risley","LOTR":"Shelob"}
2025-06-05 13:40:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [264] with data {"GOT":"Denys Arryn","LOTR":"Gollum"}
2025-06-05 13:40:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:40:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:40:12 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#167]
2025-06-05 13:40:12 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [176, 178, 179]
2025-06-05 13:40:12 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 176 with data: {"GOT": "Ygritte", "LOTR": "Elrond"}
2025-06-05 13:40:12 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 178 with data: {"GOT": "Horton Redfort", "LOTR": "Shadowfax"}
2025-06-05 13:40:12 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 179 with data: {"GOT": "Lothar Mallery", "LOTR": "Gandalf the Grey"}
2025-06-05 13:40:12 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 176: Simulating Random error
2025-06-05 13:40:12 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 179: Simulating Random error
2025-06-05 13:40:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [265] with data {"GOT":"Alysanne Osgrey","LOTR":"Arwen Evenstar"}
2025-06-05 13:40:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [266] with data {"GOT":"Ashara Dayne","LOTR":"Théoden"}
2025-06-05 13:40:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:16 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:40:16 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [176, 179, 180]
2025-06-05 13:40:16 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 176 with data: {"GOT": "Ygritte", "LOTR": "Elrond"}
2025-06-05 13:40:16 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 179 with data: {"GOT": "Lothar Mallery", "LOTR": "Gandalf the Grey"}
2025-06-05 13:40:16 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 180 with data: {"GOT": "Gawen Wylde", "LOTR": "Boromir"}
2025-06-05 13:40:16 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 176: Simulating Random error
2025-06-05 13:40:16 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 176 with id bfd5eeef-deb1-40aa-9b54-b0130832fba3 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:40:16 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 180: Simulating Random error
2025-06-05 13:40:16 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#176]
2025-06-05 13:40:16 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [180, 181, 182]
2025-06-05 13:40:16 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 180 with data: {"GOT": "Gawen Wylde", "LOTR": "Boromir"}
2025-06-05 13:40:16 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 181 with data: {"GOT": "Brandon Stark", "LOTR": "Saruman the White"}
2025-06-05 13:40:16 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 182 with data: {"GOT": "Harwood Fell", "LOTR": "Quickbeam"}
2025-06-05 13:40:16 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 180: Simulating Random error
2025-06-05 13:40:16 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 181: Simulating Random error
2025-06-05 13:40:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:40:17 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#170]
2025-06-05 13:40:17 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [180, 181, 183]
2025-06-05 13:40:17 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 180 with data: {"GOT": "Gawen Wylde", "LOTR": "Boromir"}
2025-06-05 13:40:17 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 181 with data: {"GOT": "Brandon Stark", "LOTR": "Saruman the White"}
2025-06-05 13:40:17 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 183 with data: {"GOT": "Donnel Drumm", "LOTR": "Quickbeam"}
2025-06-05 13:40:17 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 181: Simulating Random error
2025-06-05 13:40:17 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 183: Simulating Random error
2025-06-05 13:40:17 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:40:17 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [181, 183, 184]
2025-06-05 13:40:17 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 181 with data: {"GOT": "Brandon Stark", "LOTR": "Saruman the White"}
2025-06-05 13:40:17 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 183 with data: {"GOT": "Donnel Drumm", "LOTR": "Quickbeam"}
2025-06-05 13:40:17 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 184 with data: {"GOT": "Antario Jast", "LOTR": "Frodo Baggins"}
2025-06-05 13:40:17 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 184: Simulating Random error
2025-06-05 13:40:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [267] with data {"GOT":"Craghas Drahar","LOTR":"Elrond"}
2025-06-05 13:40:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:40:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:40:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [268] with data {"GOT":"Jate Blackberry","LOTR":"Peregrin Took"}
2025-06-05 13:40:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:22 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:40:22 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [184, 185, 186]
2025-06-05 13:40:22 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 185 with data: {"GOT": "Roelle", "LOTR": "Aragorn"}
2025-06-05 13:40:22 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 184 with data: {"GOT": "Antario Jast", "LOTR": "Frodo Baggins"}
2025-06-05 13:40:22 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 185: Simulating Random error
2025-06-05 13:40:22 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 186 with data: {"GOT": "Qhorin Halfhand", "LOTR": "Gandalf the Grey"}
2025-06-05 13:40:22 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 186: Simulating Random error
2025-06-05 13:40:24 [http-nio-8080-exec-6] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 6
2025-06-05 13:40:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [269] with data {"GOT":"Donnel of Duskendale","LOTR":"Théoden"}
2025-06-05 13:40:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:40:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:40:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:40:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:40:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [270] with data {"GOT":"Gormon Peake","LOTR":"Legolas"}
2025-06-05 13:40:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:40:30 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:40:30 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [185, 186, 187]
2025-06-05 13:40:30 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 185 with data: {"GOT": "Roelle", "LOTR": "Aragorn"}
2025-06-05 13:40:30 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 186 with data: {"GOT": "Qhorin Halfhand", "LOTR": "Gandalf the Grey"}
2025-06-05 13:40:30 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 187 with data: {"GOT": "Nymella Toland", "LOTR": "Éowyn"}
2025-06-05 13:40:30 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 185: Simulating Random error
2025-06-05 13:40:30 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 187: Simulating Random error
2025-06-05 13:40:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [271] with data {"GOT":"Tytos Frey","LOTR":"Théoden"}
2025-06-05 13:40:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:40:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [272] with data {"GOT":"Alebelly","LOTR":"Tom Bombadil"}
2025-06-05 13:40:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:40:34 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:40:34 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [185, 187, 188]
2025-06-05 13:40:34 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 185 with data: {"GOT": "Roelle", "LOTR": "Aragorn"}
2025-06-05 13:40:34 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 187 with data: {"GOT": "Nymella Toland", "LOTR": "Éowyn"}
2025-06-05 13:40:34 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 188 with data: {"GOT": "Euron Greyjoy", "LOTR": "Treebeard"}
2025-06-05 13:40:34 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 185: Simulating Random error
2025-06-05 13:40:34 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 185 with id be307d09-73e7-4d4d-9014-1e93a88f7349 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:40:34 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 188: Simulating Random error
2025-06-05 13:40:34 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 187: Simulating Random error
2025-06-05 13:40:34 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#185]
2025-06-05 13:40:34 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [187, 188, 189]
2025-06-05 13:40:34 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 187 with data: {"GOT": "Nymella Toland", "LOTR": "Éowyn"}
2025-06-05 13:40:34 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 188 with data: {"GOT": "Euron Greyjoy", "LOTR": "Treebeard"}
2025-06-05 13:40:34 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 189 with data: {"GOT": "Ternesio Terys", "LOTR": "Tom Bombadil"}
2025-06-05 13:40:34 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 189: Simulating Random error
2025-06-05 13:40:35 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:40:35 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [189, 190, 191]
2025-06-05 13:40:35 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 189 with data: {"GOT": "Ternesio Terys", "LOTR": "Tom Bombadil"}
2025-06-05 13:40:35 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 190 with data: {"GOT": "Urzen", "LOTR": "Gollum"}
2025-06-05 13:40:35 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 189: Simulating Random error
2025-06-05 13:40:35 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 191 with data: {"GOT": "Taena of Myr", "LOTR": "Barliman Butterbur"}
2025-06-05 13:40:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:40:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:40:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:40:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [273] with data {"GOT":"Delp","LOTR":"Saruman the White"}
2025-06-05 13:40:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:40:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id a405d654-ac30-4b88-97a9-e5b593a8048e
2025-06-05 13:40:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [274] with data {"GOT":"Justin Massey","LOTR":"Peregrin Took"}
2025-06-05 13:40:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:40:40 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:40:40 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(a405d654-ac30-4b88-97a9-e5b593a8048e) already exists.
2025-06-05 13:40:40 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(a405d654-ac30-4b88-97a9-e5b593a8048e) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(a405d654-ac30-4b88-97a9-e5b593a8048e) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(a405d654-ac30-4b88-97a9-e5b593a8048e) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:40:42 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:40:42 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [189, 192, 194]
2025-06-05 13:40:42 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 189 with data: {"GOT": "Ternesio Terys", "LOTR": "Tom Bombadil"}
2025-06-05 13:40:42 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 189: Simulating Random error
2025-06-05 13:40:42 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 189 with id 2d54897f-656e-41e6-909e-8922c9e85124 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:40:42 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 192 with data: {"GOT": "Harmune", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:40:42 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 192: Simulating Random error
2025-06-05 13:40:42 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 194 with data: {"GOT": "Alys Karstark", "LOTR": "Quickbeam"}
2025-06-05 13:40:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [276] with data {"GOT":"Joramun","LOTR":"Frodo Baggins"}
2025-06-05 13:40:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:40:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:40:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:40:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [277] with data {"GOT":"Marq Rankenfell","LOTR":"Treebeard"}
2025-06-05 13:40:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:40:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:40:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [278] with data {"GOT":"Ben","LOTR":"Gollum"}
2025-06-05 13:40:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:40:49 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#189]
2025-06-05 13:40:49 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [192, 195, 196]
2025-06-05 13:40:49 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 192 with data: {"GOT": "Harmune", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:40:49 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 196 with data: {"GOT": "Richard Horpe", "LOTR": "Galadriel"}
2025-06-05 13:40:49 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 195 with data: {"GOT": "Owen", "LOTR": "Gimli"}
2025-06-05 13:40:49 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 192: Simulating Random error
2025-06-05 13:40:49 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 196: Simulating Random error
2025-06-05 13:40:49 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 195: Simulating Random error
2025-06-05 13:40:49 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:40:49 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [192, 195, 196]
2025-06-05 13:40:49 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 192 with data: {"GOT": "Harmune", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:40:49 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 195 with data: {"GOT": "Owen", "LOTR": "Gimli"}
2025-06-05 13:40:49 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 196 with data: {"GOT": "Richard Horpe", "LOTR": "Galadriel"}
2025-06-05 13:40:49 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 195: Simulating Random error
2025-06-05 13:40:49 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 196: Simulating Random error
2025-06-05 13:40:49 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:40:49 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [195, 196, 197]
2025-06-05 13:40:49 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 195 with data: {"GOT": "Owen", "LOTR": "Gimli"}
2025-06-05 13:40:49 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 196 with data: {"GOT": "Richard Horpe", "LOTR": "Galadriel"}
2025-06-05 13:40:49 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 197 with data: {"GOT": "Obara Sand", "LOTR": "Frodo Baggins"}
2025-06-05 13:40:49 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 195: Simulating Random error
2025-06-05 13:40:49 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 196: Simulating Random error
2025-06-05 13:40:49 [pool-2-thread-2] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 195 with id b19b7cd4-8852-470f-b912-ccb36e20a39f has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:40:49 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 196 with id 594d61fb-09a3-4642-a982-7d212aea493d has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:40:50 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:40:50 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [198, 199, 200]
2025-06-05 13:40:50 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 198 with data: {"GOT": "Lucas Codd", "LOTR": "Aragorn"}
2025-06-05 13:40:50 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 199 with data: {"GOT": "Rolland Uffering", "LOTR": "Tom Bombadil"}
2025-06-05 13:40:50 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 200 with data: {"GOT": "Ezzelyno", "LOTR": "Boromir"}
2025-06-05 13:40:50 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 198: Simulating Random error
2025-06-05 13:40:51 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:40:51 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [198, 201, 202]
2025-06-05 13:40:51 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 198 with data: {"GOT": "Lucas Codd", "LOTR": "Aragorn"}
2025-06-05 13:40:51 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 201 with data: {"GOT": "Hugh", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:40:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:40:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:40:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [279] with data {"GOT":"Rhaena Targaryen","LOTR":"Beregond"}
2025-06-05 13:40:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:40:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [280] with data {"GOT":"Benjen the Sweet","LOTR":"Beregond"}
2025-06-05 13:40:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:40:56 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 202 with data: {"GOT": "Daemon II Blackfyre", "LOTR": "Barliman Butterbur"}
2025-06-05 13:40:56 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#195]
2025-06-05 13:40:56 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [202, 203, 204]
2025-06-05 13:40:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:40:57 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 202 with data: {"GOT": "Daemon II Blackfyre", "LOTR": "Barliman Butterbur"}
2025-06-05 13:40:57 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 202: Simulating Random error
2025-06-05 13:40:57 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 203 with data: {"GOT": "Biter", "LOTR": "Gollum"}
2025-06-05 13:40:57 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 203: Simulating Random error
2025-06-05 13:40:57 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 204 with data: {"GOT": "Luwin", "LOTR": "Samwise Gamgee"}
2025-06-05 13:40:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [281] with data {"GOT":"Antario Jast","LOTR":"Éowyn"}
2025-06-05 13:40:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:40:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:40:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:40:58 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:40:58 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [202, 203, 205]
2025-06-05 13:40:58 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 202 with data: {"GOT": "Daemon II Blackfyre", "LOTR": "Barliman Butterbur"}
2025-06-05 13:40:58 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 203 with data: {"GOT": "Biter", "LOTR": "Gollum"}
2025-06-05 13:40:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:40:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:41:00 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:41:00 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 205 with data: {"GOT": "Duncan", "LOTR": "Peregrin Took"}
2025-06-05 13:41:00 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [205, 206, 207]
2025-06-05 13:41:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [282] with data {"GOT":"Qarl Quickaxe","LOTR":"Tom Bombadil"}
2025-06-05 13:41:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:41:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:41:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:41:01 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 205 with data: {"GOT": "Duncan", "LOTR": "Peregrin Took"}
2025-06-05 13:41:01 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 205: Simulating Random error
2025-06-05 13:41:01 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 206 with data: {"GOT": "Godric Borrell", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:41:01 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 206: Simulating Random error
2025-06-05 13:41:01 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 207 with data: {"GOT": "Spare Boot", "LOTR": "Glorfindel"}
2025-06-05 13:41:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [283] with data {"GOT":"Theomore","LOTR":"Galadriel"}
2025-06-05 13:41:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:41:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:41:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:41:06 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:41:06 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [205, 206, 208]
2025-06-05 13:41:06 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 205 with data: {"GOT": "Duncan", "LOTR": "Peregrin Took"}
2025-06-05 13:41:06 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 206 with data: {"GOT": "Godric Borrell", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:41:06 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 206: Simulating Random error
2025-06-05 13:41:06 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 208 with data: {"GOT": "Andrew Estermont", "LOTR": "Peregrin Took"}
2025-06-05 13:41:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:41:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [284] with data {"GOT":"Mellei","LOTR":"Samwise Gamgee"}
2025-06-05 13:41:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:41:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:41:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:41:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:41:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:41:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [285] with data {"GOT":"Bannen","LOTR":"Faramir"}
2025-06-05 13:41:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:41:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:41:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:41:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [286] with data {"GOT":"Osney Kettleblack","LOTR":"Grìma Wormtongue"}
2025-06-05 13:41:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:41:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:41:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:41:13 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:41:13 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [206, 209, 210]
2025-06-05 13:41:13 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 206 with data: {"GOT": "Godric Borrell", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:41:13 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 210 with data: {"GOT": "Brandon the Bad", "LOTR": "Gandalf the Grey"}
2025-06-05 13:41:13 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 209 with data: {"GOT": "Robin Ryger", "LOTR": "Arwen Evenstar"}
2025-06-05 13:41:13 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 210: Simulating Random error
2025-06-05 13:41:13 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 206: Simulating Random error
2025-06-05 13:41:13 [pool-2-thread-1] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 206 with id 1f89f8cc-3c24-4177-9892-e36f8d7e78c3 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:41:14 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:41:14 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [210, 211, 212]
2025-06-05 13:41:14 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 210 with data: {"GOT": "Brandon the Bad", "LOTR": "Gandalf the Grey"}
2025-06-05 13:41:14 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 211 with data: {"GOT": "Sumner Crakehall", "LOTR": "Gimli"}
2025-06-05 13:41:14 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 212 with data: {"GOT": "Quaithe", "LOTR": "Arwen Evenstar"}
2025-06-05 13:41:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:41:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:41:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [287] with data {"GOT":"All-for-Joffrey","LOTR":"Elrond"}
2025-06-05 13:41:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:41:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:41:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:41:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:41:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [288] with data {"GOT":"Eddard Karstark","LOTR":"Frodo Baggins"}
2025-06-05 13:41:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:41:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:41:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:41:19 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#206]
2025-06-05 13:41:19 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [213, 214, 215]
2025-06-05 13:41:19 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 214 with data: {"GOT": "Cedra", "LOTR": "Gimli"}
2025-06-05 13:41:19 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 213 with data: {"GOT": "Torwold Browntooth", "LOTR": "Boromir"}
2025-06-05 13:41:19 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 213: Simulating Random error
2025-06-05 13:41:19 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 215 with data: {"GOT": "Robin", "LOTR": "Galadriel"}
2025-06-05 13:41:21 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:41:21 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [213, 216, 217]
2025-06-05 13:41:21 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 213 with data: {"GOT": "Torwold Browntooth", "LOTR": "Boromir"}
2025-06-05 13:41:21 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 216 with data: {"GOT": "Marianne Vance", "LOTR": "Théoden"}
2025-06-05 13:41:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [289] with data {"GOT":"Daenerys Targaryen","LOTR":"Shadowfax"}
2025-06-05 13:41:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:41:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:41:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:41:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:41:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:41:25 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 217 with data: {"GOT": "Shella Whent", "LOTR": "Denethor"}
2025-06-05 13:41:25 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 217: Simulating Random error
2025-06-05 13:41:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [290] with data {"GOT":"Donnel Drumm","LOTR":"Meriadoc Brandybuck"}
2025-06-05 13:41:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:41:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:41:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:41:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:41:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [291] with data {"GOT":"Ryam Florent","LOTR":"Elrond"}
2025-06-05 13:41:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:41:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:41:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:41:31 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:41:31 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [217, 218, 219]
2025-06-05 13:41:31 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 217 with data: {"GOT": "Shella Whent", "LOTR": "Denethor"}
2025-06-05 13:41:31 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 218 with data: {"GOT": "Larence Snow", "LOTR": "Saruman the White"}
2025-06-05 13:41:31 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 218: Simulating Random error
2025-06-05 13:41:31 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 219 with data: {"GOT": "Osney Kettleblack", "LOTR": "Sauron"}
2025-06-05 13:41:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [292] with data {"GOT":"Tristifer Botley","LOTR":"Galadriel"}
2025-06-05 13:41:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:41:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:41:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:41:32 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:41:32 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:41:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [293] with data {"GOT":"Pycelle","LOTR":"Peregrin Took"}
2025-06-05 13:41:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 4
2025-06-05 13:41:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 5
2025-06-05 13:41:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 6
2025-06-05 13:41:34 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 13:41:38 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 2716 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:41:38 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:41:38 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:41:39 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:41:40 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:41:40 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:41:40 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:41:41 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:41:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 167 ms. Found 2 JPA repository interfaces.
2025-06-05 13:41:43 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:41:43 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:41:43 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:41:43 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:41:43 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:41:43 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2865 ms
2025-06-05 13:41:43 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:41:43 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:41:43 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:41:44 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:41:44 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:41:45 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3e079785
2025-06-05 13:41:45 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:41:45 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:41:46 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:41:46 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:41:47 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:41:48 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:41:48 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:41:48 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:41:48 [restartedMain] INFO  jon.db.queue.Application - Started Application in 10.854 seconds (process running for 11.923)
2025-06-05 13:41:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:41:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:41:48 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:41:48 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:41:48 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-06-05 13:41:48 [http-nio-8080-exec-1] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 1
2025-06-05 13:41:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [294] with data {"LOTR":"Elrond","GOT":"Walder Haigh"}
2025-06-05 13:41:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:41:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:41:49 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [218, 220, 221]
2025-06-05 13:41:49 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [225, 226, 227]
2025-06-05 13:41:49 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [222, 223, 224]
2025-06-05 13:41:49 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 218 with data: {"GOT": "Larence Snow", "LOTR": "Saruman the White"}
2025-06-05 13:41:49 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 222 with data: {"GOT": "Emmon Frey", "LOTR": "Peregrin Took"}
2025-06-05 13:41:49 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 225 with data: {"GOT": "Sylva Santagar", "LOTR": "Shelob"}
2025-06-05 13:41:49 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 223 with data: {"GOT": "Galtry the Green", "LOTR": "Boromir"}
2025-06-05 13:41:49 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 220 with data: {"GOT": "Lomas Estermont", "LOTR": "Quickbeam"}
2025-06-05 13:41:49 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 225: Simulating Random error
2025-06-05 13:41:49 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 220: Simulating Random error
2025-06-05 13:41:49 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 226 with data: {"GOT": "Daena Targaryen", "LOTR": "Tom Bombadil"}
2025-06-05 13:41:49 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 227 with data: {"GOT": "Serra Frey", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:41:50 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 224 with data: {"GOT": "Lymond Goodbrook", "LOTR": "Shelob"}
2025-06-05 13:41:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [295] with data {"LOTR":"Théoden","GOT":"Hother Umber"}
2025-06-05 13:41:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:41:54 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 13:41:58 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 11128 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:41:58 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:41:58 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:41:58 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:42:00 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:42:00 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:42:00 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:42:01 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:42:01 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 104 ms. Found 2 JPA repository interfaces.
2025-06-05 13:42:02 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:42:02 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:42:02 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:42:02 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:42:03 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:42:03 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2566 ms
2025-06-05 13:42:03 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:42:03 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:42:03 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:42:04 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:42:04 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:42:04 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@38d6ddde
2025-06-05 13:42:04 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:42:04 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:42:06 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:42:06 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:42:07 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:42:07 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:42:07 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:42:07 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:42:07 [restartedMain] INFO  jon.db.queue.Application - Started Application in 10.681 seconds (process running for 11.741)
2025-06-05 13:42:08 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:42:08 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:42:08 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-06-05 13:42:08 [http-nio-8080-exec-1] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 1
2025-06-05 13:42:08 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [296] with data {"LOTR":"Galadriel","GOT":"Hali"}
2025-06-05 13:42:08 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:42:08 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:42:08 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:42:08 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:42:08 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [220, 221, 225]
2025-06-05 13:42:08 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [231, 232, 233]
2025-06-05 13:42:08 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [228, 229, 230]
2025-06-05 13:42:08 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 231 with data: {"GOT": "Brogg", "LOTR": "Frodo Baggins"}
2025-06-05 13:42:08 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 220 with data: {"GOT": "Lomas Estermont", "LOTR": "Quickbeam"}
2025-06-05 13:42:08 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 228 with data: {"GOT": "Rymolf", "LOTR": "Treebeard"}
2025-06-05 13:42:08 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 232 with data: {"GOT": "Emrick", "LOTR": "Shadowfax"}
2025-06-05 13:42:08 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 221 with data: {"GOT": "Glendon Hewett", "LOTR": "Quickbeam"}
2025-06-05 13:42:08 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 231: Simulating Random error
2025-06-05 13:42:08 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 220: Simulating Random error
2025-06-05 13:42:08 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 228: Simulating Random error
2025-06-05 13:42:08 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 232: Simulating Random error
2025-06-05 13:42:08 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 229 with data: {"GOT": "Morosh the Myrman", "LOTR": "Barliman Butterbur"}
2025-06-05 13:42:08 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 230 with data: {"GOT": "Goodwin", "LOTR": "Elrond"}
2025-06-05 13:42:08 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 233 with data: {"GOT": "Mathos Mallarawan", "LOTR": "Éomer"}
2025-06-05 13:42:08 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 225 with data: {"GOT": "Sylva Santagar", "LOTR": "Shelob"}
2025-06-05 13:42:08 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 233: Simulating Random error
2025-06-05 13:42:08 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:42:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [297] with data {"LOTR":"Quickbeam","GOT":"Terrence Toyne"}
2025-06-05 13:42:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:42:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [298] with data {"LOTR":"Boromir","GOT":"Ned Woods"}
2025-06-05 13:42:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:42:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:42:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:42:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [299] with data {"LOTR":"Shadowfax","GOT":"Amerei Frey"}
2025-06-05 13:42:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:42:18 [http-nio-8080-exec-3] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 2
2025-06-05 13:42:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:42:18 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [220, 228, 231]
2025-06-05 13:42:18 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 228 with data: {"GOT": "Rymolf", "LOTR": "Treebeard"}
2025-06-05 13:42:18 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 231 with data: {"GOT": "Brogg", "LOTR": "Frodo Baggins"}
2025-06-05 13:42:18 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 220 with data: {"GOT": "Lomas Estermont", "LOTR": "Quickbeam"}
2025-06-05 13:42:18 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 231: Simulating Random error
2025-06-05 13:42:18 [http-nio-8080-exec-5] ERROR j.d.q.g.GenericQueueSseEmitter - SSE error for client: 1
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageUpdate$4(GenericQueueSseEmitter.java:80)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageUpdate(GenericQueueSseEmitter.java:78)
	at jon.db.queue.generic_queue.GenericQueueProcessor.processMessage(GenericQueuePoller.java:185)
	at jon.db.queue.generic_queue.GenericQueueProcessor.processMessageWithErrorHandling(GenericQueuePoller.java:154)
	at jon.db.queue.generic_queue.GenericQueueWorker.lambda$parallelProcessMessagesInQueue$0(GenericQueuePoller.java:101)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run$$$capture(CompletableFuture.java:1804)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:42:18 [http-nio-8080-exec-5] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageUpdate$4(GenericQueueSseEmitter.java:80)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageUpdate(GenericQueueSseEmitter.java:78)
	at jon.db.queue.generic_queue.GenericQueueProcessor.processMessage(GenericQueuePoller.java:185)
	at jon.db.queue.generic_queue.GenericQueueProcessor.processMessageWithErrorHandling(GenericQueuePoller.java:154)
	at jon.db.queue.generic_queue.GenericQueueWorker.lambda$parallelProcessMessagesInQueue$0(GenericQueuePoller.java:101)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run$$$capture(CompletableFuture.java:1804)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:42:18 [http-nio-8080-exec-5] INFO  j.d.q.g.GenericQueueSseEmitter - SSE connection completed for client: 1
2025-06-05 13:42:18 [http-nio-8080-exec-5] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageUpdate$4(GenericQueueSseEmitter.java:80)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageUpdate(GenericQueueSseEmitter.java:78)
	at jon.db.queue.generic_queue.GenericQueueProcessor.processMessage(GenericQueuePoller.java:185)
	at jon.db.queue.generic_queue.GenericQueueProcessor.processMessageWithErrorHandling(GenericQueuePoller.java:154)
	at jon.db.queue.generic_queue.GenericQueueWorker.lambda$parallelProcessMessagesInQueue$0(GenericQueuePoller.java:101)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run$$$capture(CompletableFuture.java:1804)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:42:18 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:42:18 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [231, 232, 233]
2025-06-05 13:42:18 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 231 with data: {"GOT": "Brogg", "LOTR": "Frodo Baggins"}
2025-06-05 13:42:18 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 232 with data: {"GOT": "Emrick", "LOTR": "Shadowfax"}
2025-06-05 13:42:18 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 232: Simulating Random error
2025-06-05 13:42:18 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 233 with data: {"GOT": "Mathos Mallarawan", "LOTR": "Éomer"}
2025-06-05 13:42:18 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 233: Simulating Random error
2025-06-05 13:42:20 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [300] with data {"LOTR":"Faramir","GOT":"Jasper Wylde"}
2025-06-05 13:42:20 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:42:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [301] with data {"LOTR":"Sauron","GOT":"Kyle"}
2025-06-05 13:42:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:42:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:42:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:42:24 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:42:24 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [232, 233, 234]
2025-06-05 13:42:24 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 232 with data: {"GOT": "Emrick", "LOTR": "Shadowfax"}
2025-06-05 13:42:24 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 233 with data: {"GOT": "Mathos Mallarawan", "LOTR": "Éomer"}
2025-06-05 13:42:24 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 234 with data: {"GOT": "Theomore Harlaw", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:42:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [302] with data {"LOTR":"Éomer","GOT":"Burton Crakehall"}
2025-06-05 13:42:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:42:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:42:28 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:42:28 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [235, 236, 237]
2025-06-05 13:42:28 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 235 with data: {"GOT": "Osbert Serry", "LOTR": "Arwen Evenstar"}
2025-06-05 13:42:28 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 236 with data: {"GOT": "Philip Foote", "LOTR": "Boromir"}
2025-06-05 13:42:28 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 235: Simulating Random error
2025-06-05 13:42:28 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 237 with data: {"GOT": "Ferrego Antaryon", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:42:28 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 237: Simulating Random error
2025-06-05 13:42:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [303] with data {"LOTR":"Glorfindel","GOT":"Tom of Sevenstreams"}
2025-06-05 13:42:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:42:31 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:42:31 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [235, 237, 239]
2025-06-05 13:42:31 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 237 with data: {"GOT": "Ferrego Antaryon", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:42:31 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 235 with data: {"GOT": "Osbert Serry", "LOTR": "Arwen Evenstar"}
2025-06-05 13:42:31 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 237: Simulating Random error
2025-06-05 13:42:31 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 239 with data: {"GOT": "Weasel", "LOTR": "Gandalf the Grey"}
2025-06-05 13:42:32 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:42:32 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:42:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [304] with data {"LOTR":"Gimli","GOT":"Harwin"}
2025-06-05 13:42:33 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:42:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id c2f345f7-59f4-4496-bbb0-aed0ddbf7f66
2025-06-05 13:42:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [305] with data {"LOTR":"Galadriel","GOT":"Veiled Lady"}
2025-06-05 13:42:36 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:42:36 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:42:36 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(c2f345f7-59f4-4496-bbb0-aed0ddbf7f66) already exists.
2025-06-05 13:42:36 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(c2f345f7-59f4-4496-bbb0-aed0ddbf7f66) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(c2f345f7-59f4-4496-bbb0-aed0ddbf7f66) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(c2f345f7-59f4-4496-bbb0-aed0ddbf7f66) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:42:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:42:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [307] with data {"LOTR":"Samwise Gamgee","GOT":"Victor Tyrell"}
2025-06-05 13:42:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:42:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:42:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:42:41 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:42:41 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [237, 240, 241]
2025-06-05 13:42:41 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 237 with data: {"GOT": "Ferrego Antaryon", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:42:41 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 240 with data: {"GOT": "Gerold Dayne", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:42:41 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 241 with data: {"GOT": "Mallor", "LOTR": "Éomer"}
2025-06-05 13:42:41 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 237: Simulating Random error
2025-06-05 13:42:41 [pool-2-thread-1] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 237 with id 9bcc7f2e-99c5-41e4-9ea6-5663c5d74754 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:42:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [308] with data {"LOTR":"Tom Bombadil","GOT":"Lancel V Lannister"}
2025-06-05 13:42:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:42:42 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:42:42 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [242, 243, 244]
2025-06-05 13:42:42 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 243 with data: {"GOT": "Clayton Suggs", "LOTR": "Peregrin Took"}
2025-06-05 13:42:42 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 242 with data: {"GOT": "Mallor", "LOTR": "Théoden"}
2025-06-05 13:42:42 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 242: Simulating Random error
2025-06-05 13:42:42 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 244 with data: {"GOT": "Daemon II Blackfyre", "LOTR": "Tom Bombadil"}
2025-06-05 13:42:44 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 13:42:47 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 22376 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:42:47 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:42:47 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:42:47 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:42:49 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:42:49 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:42:49 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:42:50 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:42:50 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 115 ms. Found 2 JPA repository interfaces.
2025-06-05 13:42:52 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:42:52 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:42:52 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:42:52 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:42:52 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:42:52 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2671 ms
2025-06-05 13:42:52 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:42:52 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:42:52 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:42:53 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:42:53 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:42:54 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3829dc3
2025-06-05 13:42:54 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:42:54 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:42:55 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:42:55 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:42:56 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:42:57 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:42:57 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:42:57 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:42:57 [restartedMain] INFO  jon.db.queue.Application - Started Application in 10.724 seconds (process running for 11.826)
2025-06-05 13:42:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:42:57 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:42:57 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:42:57 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-06-05 13:42:57 [http-nio-8080-exec-1] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 1
2025-06-05 13:42:57 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [250, 251, 252]
2025-06-05 13:42:57 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [242, 245, 246]
2025-06-05 13:42:57 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [247, 248, 249]
2025-06-05 13:42:57 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 247 with data: {"GOT": "Melwys Rivers", "LOTR": "Glorfindel"}
2025-06-05 13:42:57 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 250 with data: {"GOT": "Alia", "LOTR": "Bilbo Baggins"}
2025-06-05 13:42:57 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 242 with data: {"GOT": "Mallor", "LOTR": "Théoden"}
2025-06-05 13:42:57 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 248 with data: {"GOT": "Andar Royce", "LOTR": "Frodo Baggins"}
2025-06-05 13:42:57 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 251 with data: {"GOT": "Elys Westerling", "LOTR": "Galadriel"}
2025-06-05 13:42:57 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 242: Simulating Random error
2025-06-05 13:42:57 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 248: Simulating Random error
2025-06-05 13:42:57 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 251: Simulating Random error
2025-06-05 13:42:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [309] with data {"GOT":"Sebaston Farman","LOTR":"Barliman Butterbur"}
2025-06-05 13:42:57 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 245 with data: {"GOT": "Mathis Rowan", "LOTR": "Quickbeam"}
2025-06-05 13:42:57 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 249 with data: {"GOT": "Hilmar Drumm", "LOTR": "Elrond"}
2025-06-05 13:42:57 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 246 with data: {"GOT": "Sleepy Jack", "LOTR": "Gandalf the Grey"}
2025-06-05 13:42:57 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 249: Simulating Random error
2025-06-05 13:42:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:42:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:42:57 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 252 with data: {"GOT": "Marghaz zo Loraq", "LOTR": "Frodo Baggins"}
2025-06-05 13:42:57 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 252: Simulating Random error
2025-06-05 13:42:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:43:00 [http-nio-8080-exec-3] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 2
2025-06-05 13:43:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id fd7ae682-471d-43a9-836b-66c39f6db7c9
2025-06-05 13:43:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [310] with data {"GOT":"Dick","LOTR":"Boromir"}
2025-06-05 13:43:00 [http-nio-8080-exec-5] ERROR j.d.q.g.GenericQueueSseEmitter - SSE error for client: 1
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:61)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:43:00 [scheduling-1] WARN  j.d.q.g.GenericQueueSseEmitter - Failed to send message to client: 1
org.springframework.web.context.request.async.AsyncRequestNotUsableException: ServletOutputStream failed to flush: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleHttpServletResponse.handleIOException(StandardServletAsyncWebRequest.java:346)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:418)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:61)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.apache.catalina.connector.ClientAbortException: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:304)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	... 32 common frames omitted
Caused by: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	... 35 common frames omitted
2025-06-05 13:43:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:00 [http-nio-8080-exec-5] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:61)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:43:00 [http-nio-8080-exec-5] INFO  j.d.q.g.GenericQueueSseEmitter - SSE connection completed for client: 1
2025-06-05 13:43:00 [http-nio-8080-exec-5] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:61)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:43:00 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:43:00 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(fd7ae682-471d-43a9-836b-66c39f6db7c9) already exists.
2025-06-05 13:43:01 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(fd7ae682-471d-43a9-836b-66c39f6db7c9) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(fd7ae682-471d-43a9-836b-66c39f6db7c9) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(fd7ae682-471d-43a9-836b-66c39f6db7c9) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:43:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [312] with data {"GOT":"Runciter","LOTR":"Faramir"}
2025-06-05 13:43:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:43:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:43:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:43:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [313] with data {"GOT":"Dunsen","LOTR":"Arwen Evenstar"}
2025-06-05 13:43:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:43:07 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [242, 248, 249]
2025-06-05 13:43:07 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 248 with data: {"GOT": "Andar Royce", "LOTR": "Frodo Baggins"}
2025-06-05 13:43:07 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 249 with data: {"GOT": "Hilmar Drumm", "LOTR": "Elrond"}
2025-06-05 13:43:07 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 242 with data: {"GOT": "Mallor", "LOTR": "Théoden"}
2025-06-05 13:43:07 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 248: Simulating Random error
2025-06-05 13:43:07 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 242: Simulating Random error
2025-06-05 13:43:07 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 249: Simulating Random error
2025-06-05 13:43:07 [pool-2-thread-2] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 242 with id 6b0a35fb-aec9-448e-a017-ec709f2fc6c5 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:43:07 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#242]
2025-06-05 13:43:07 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [248, 249, 251]
2025-06-05 13:43:07 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 249 with data: {"GOT": "Hilmar Drumm", "LOTR": "Elrond"}
2025-06-05 13:43:07 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 248 with data: {"GOT": "Andar Royce", "LOTR": "Frodo Baggins"}
2025-06-05 13:43:07 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 249: Simulating Random error
2025-06-05 13:43:07 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 251 with data: {"GOT": "Elys Westerling", "LOTR": "Galadriel"}
2025-06-05 13:43:07 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 249 with id ac0b8434-8e1e-4d88-b151-eaa18fd77575 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:43:07 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 248: Simulating Random error
2025-06-05 13:43:07 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 251: Simulating Random error
2025-06-05 13:43:07 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 248 with id 2997f31a-5ba6-4a94-882a-681df63bb7ca has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:43:07 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#248]
2025-06-05 13:43:07 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [251, 252, 253]
2025-06-05 13:43:07 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 251 with data: {"GOT": "Elys Westerling", "LOTR": "Galadriel"}
2025-06-05 13:43:07 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 252 with data: {"GOT": "Marghaz zo Loraq", "LOTR": "Frodo Baggins"}
2025-06-05 13:43:07 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 253 with data: {"GOT": "Lysa Arryn", "LOTR": "Denethor"}
2025-06-05 13:43:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [314] with data {"GOT":"Frenken","LOTR":"Sauron"}
2025-06-05 13:43:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:10 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:43:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [315] with data {"GOT":"Alannys Harlaw","LOTR":"Saruman the White"}
2025-06-05 13:43:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:13 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:43:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:43:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:43:15 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:43:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [316] with data {"GOT":"Beck","LOTR":"Arwen Evenstar"}
2025-06-05 13:43:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:43:17 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [258, 259, 260]
2025-06-05 13:43:17 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 258 with data: {"GOT": "Lyle Crakehall", "LOTR": "Galadriel"}
2025-06-05 13:43:17 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 260 with data: {"GOT": "Sigrin", "LOTR": "Gollum"}
2025-06-05 13:43:17 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 259 with data: {"GOT": "Garth Greenhand", "LOTR": "Galadriel"}
2025-06-05 13:43:17 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [254, 256, 257]
2025-06-05 13:43:17 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 259: Simulating Random error
2025-06-05 13:43:17 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 254 with data: {"GOT": "Mordane", "LOTR": "Legolas"}
2025-06-05 13:43:17 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 256 with data: {"GOT": "Mina Tyrell", "LOTR": "Éomer"}
2025-06-05 13:43:17 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [261, 262, 263]
2025-06-05 13:43:17 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 257 with data: {"GOT": "Assadora of Ibben", "LOTR": "Gollum"}
2025-06-05 13:43:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [317] with data {"GOT":"Gorne","LOTR":"Shelob"}
2025-06-05 13:43:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:43:21 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:43:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [318] with data {"GOT":"Guthor Grimm","LOTR":"Théoden"}
2025-06-05 13:43:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:23 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 261 with data: {"GOT": "Qyle", "LOTR": "Tom Bombadil"}
2025-06-05 13:43:23 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 261: Simulating Random error
2025-06-05 13:43:23 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 262 with data: {"GOT": "Kedry", "LOTR": "Éowyn"}
2025-06-05 13:43:23 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 262: Simulating Random error
2025-06-05 13:43:23 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 263 with data: {"GOT": "Eden Risley", "LOTR": "Shelob"}
2025-06-05 13:43:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [319] with data {"GOT":"Taena of Myr","LOTR":"Éowyn"}
2025-06-05 13:43:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:43:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [320] with data {"GOT":"Ghael","LOTR":"Éowyn"}
2025-06-05 13:43:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:28 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:43:28 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [259, 261, 262]
2025-06-05 13:43:28 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 259 with data: {"GOT": "Garth Greenhand", "LOTR": "Galadriel"}
2025-06-05 13:43:28 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 261 with data: {"GOT": "Qyle", "LOTR": "Tom Bombadil"}
2025-06-05 13:43:28 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 259: Simulating Random error
2025-06-05 13:43:28 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 261: Simulating Random error
2025-06-05 13:43:28 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 262 with data: {"GOT": "Kedry", "LOTR": "Éowyn"}
2025-06-05 13:43:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:43:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:43:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [321] with data {"GOT":"Rolly Duckfield","LOTR":"Galadriel"}
2025-06-05 13:43:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:31 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:43:31 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [259, 261, 264]
2025-06-05 13:43:31 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 259 with data: {"GOT": "Garth Greenhand", "LOTR": "Galadriel"}
2025-06-05 13:43:31 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 261 with data: {"GOT": "Qyle", "LOTR": "Tom Bombadil"}
2025-06-05 13:43:31 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 264 with data: {"GOT": "Denys Arryn", "LOTR": "Gollum"}
2025-06-05 13:43:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [322] with data {"GOT":"Dick Follard","LOTR":"Samwise Gamgee"}
2025-06-05 13:43:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:35 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:43:35 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [265, 266, 267]
2025-06-05 13:43:35 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 265 with data: {"GOT": "Alysanne Osgrey", "LOTR": "Arwen Evenstar"}
2025-06-05 13:43:35 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 265: Simulating Random error
2025-06-05 13:43:35 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 266 with data: {"GOT": "Ashara Dayne", "LOTR": "Théoden"}
2025-06-05 13:43:35 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:43:35 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 267 with data: {"GOT": "Craghas Drahar", "LOTR": "Elrond"}
2025-06-05 13:43:35 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 267: Simulating Random error
2025-06-05 13:43:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:43:37 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [265, 267, 268]
2025-06-05 13:43:37 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 265 with data: {"GOT": "Alysanne Osgrey", "LOTR": "Arwen Evenstar"}
2025-06-05 13:43:37 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 265: Simulating Random error
2025-06-05 13:43:37 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 267 with data: {"GOT": "Craghas Drahar", "LOTR": "Elrond"}
2025-06-05 13:43:37 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 267: Simulating Random error
2025-06-05 13:43:37 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 268 with data: {"GOT": "Jate Blackberry", "LOTR": "Peregrin Took"}
2025-06-05 13:43:37 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 268: Simulating Random error
2025-06-05 13:43:37 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:43:37 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [265, 267, 268]
2025-06-05 13:43:37 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 265 with data: {"GOT": "Alysanne Osgrey", "LOTR": "Arwen Evenstar"}
2025-06-05 13:43:37 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 265: Simulating Random error
2025-06-05 13:43:37 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 265 with id 89096624-05c7-4341-a917-7bb1f4f30be2 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:43:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 94bea906-efcc-45d3-bf81-e0d985cfa3c2
2025-06-05 13:43:37 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 267 with data: {"GOT": "Craghas Drahar", "LOTR": "Elrond"}
2025-06-05 13:43:37 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 267: Simulating Random error
2025-06-05 13:43:37 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 267 with id 9eb63f2c-f751-4a5d-b2cb-f5352a5311be has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:43:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [323] with data {"GOT":"Symon Hollard","LOTR":"Tom Bombadil"}
2025-06-05 13:43:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:37 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 268 with data: {"GOT": "Jate Blackberry", "LOTR": "Peregrin Took"}
2025-06-05 13:43:37 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 268: Simulating Random error
2025-06-05 13:43:37 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#265]
2025-06-05 13:43:37 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:43:37 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(94bea906-efcc-45d3-bf81-e0d985cfa3c2) already exists.
2025-06-05 13:43:37 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(94bea906-efcc-45d3-bf81-e0d985cfa3c2) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(94bea906-efcc-45d3-bf81-e0d985cfa3c2) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(94bea906-efcc-45d3-bf81-e0d985cfa3c2) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:43:37 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [268, 269, 270]
2025-06-05 13:43:37 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 268 with data: {"GOT": "Jate Blackberry", "LOTR": "Peregrin Took"}
2025-06-05 13:43:37 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 268: Simulating Random error
2025-06-05 13:43:37 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 268 with id 407b0717-275d-45b4-84b8-d5460d6aa736 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:43:37 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 269 with data: {"GOT": "Donnel of Duskendale", "LOTR": "Théoden"}
2025-06-05 13:43:37 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 269: Simulating Random error
2025-06-05 13:43:37 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 270 with data: {"GOT": "Gormon Peake", "LOTR": "Legolas"}
2025-06-05 13:43:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:43:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:43:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [325] with data {"GOT":"Sylas Flatnose","LOTR":"Samwise Gamgee"}
2025-06-05 13:43:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:43:41 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:43:41 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 13:44:38 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 25036 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:44:38 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:44:38 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:44:39 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:44:40 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:44:40 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:44:40 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:44:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:44:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 130 ms. Found 2 JPA repository interfaces.
2025-06-05 13:44:43 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:44:43 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:44:43 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:44:43 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:44:43 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:44:43 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2705 ms
2025-06-05 13:44:43 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:44:43 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:44:43 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:44:44 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:44:44 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:44:44 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@38d6ddde
2025-06-05 13:44:44 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:44:45 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:44:46 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:44:46 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:44:47 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:44:48 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:44:48 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:44:48 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:44:48 [restartedMain] INFO  jon.db.queue.Application - Started Application in 10.521 seconds (process running for 11.593)
2025-06-05 13:44:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:44:48 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:44:48 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:44:48 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-06-05 13:44:48 [http-nio-8080-exec-1] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 1
2025-06-05 13:44:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:44:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:44:48 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [269, 271, 272]
2025-06-05 13:44:48 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [277, 278, 279]
2025-06-05 13:44:48 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [273, 274, 276]
2025-06-05 13:44:48 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 273 with data: {"GOT": "Delp", "LOTR": "Saruman the White"}
2025-06-05 13:44:48 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 269 with data: {"GOT": "Donnel of Duskendale", "LOTR": "Théoden"}
2025-06-05 13:44:48 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 277 with data: {"GOT": "Marq Rankenfell", "LOTR": "Treebeard"}
2025-06-05 13:44:48 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 274 with data: {"GOT": "Justin Massey", "LOTR": "Peregrin Took"}
2025-06-05 13:44:48 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 271 with data: {"GOT": "Tytos Frey", "LOTR": "Théoden"}
2025-06-05 13:44:48 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 277: Simulating Random error
2025-06-05 13:45:05 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 278 with data: {"GOT": "Ben", "LOTR": "Gollum"}
2025-06-05 13:45:05 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 279 with data: {"GOT": "Rhaena Targaryen", "LOTR": "Beregond"}
2025-06-05 13:45:08 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 276 with data: {"GOT": "Joramun", "LOTR": "Frodo Baggins"}
2025-06-05 13:45:08 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 272 with data: {"GOT": "Alebelly", "LOTR": "Tom Bombadil"}
2025-06-05 13:45:08 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 276: Simulating Random error
2025-06-05 13:45:08 [http-nio-8080-exec-4] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 2
2025-06-05 13:45:13 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:45:16 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:45:24 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:45:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [326] with data {"LOTR":"Peregrin Took","GOT":"Hareth"}
2025-06-05 13:45:30 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:45:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:45:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:45:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:45:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:45:31 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [276, 277, 280]
2025-06-05 13:45:31 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 276 with data: {"GOT": "Joramun", "LOTR": "Frodo Baggins"}
2025-06-05 13:45:31 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 277 with data: {"GOT": "Marq Rankenfell", "LOTR": "Treebeard"}
2025-06-05 13:45:31 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 280 with data: {"GOT": "Benjen the Sweet", "LOTR": "Beregond"}
2025-06-05 13:45:31 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 277: Simulating Random error
2025-06-05 13:45:31 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 280: Simulating Random error
2025-06-05 13:45:31 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [284, 285, 286]
2025-06-05 13:45:31 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 284 with data: {"GOT": "Mellei", "LOTR": "Samwise Gamgee"}
2025-06-05 13:45:31 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 285 with data: {"GOT": "Bannen", "LOTR": "Faramir"}
2025-06-05 13:45:31 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 284: Simulating Random error
2025-06-05 13:45:31 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [281, 282, 283]
2025-06-05 13:45:37 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 286 with data: {"GOT": "Osney Kettleblack", "LOTR": "Grìma Wormtongue"}
2025-06-05 13:45:37 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 281 with data: {"GOT": "Antario Jast", "LOTR": "Éowyn"}
2025-06-05 13:45:37 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 282 with data: {"GOT": "Qarl Quickaxe", "LOTR": "Tom Bombadil"}
2025-06-05 13:45:37 [http-nio-8080-exec-1] INFO  o.a.catalina.connector.CoyoteAdapter - Encountered a non-recycled request and recycled it forcedly.
org.apache.catalina.connector.CoyoteAdapter$RecycleRequiredException: null
	at org.apache.catalina.connector.CoyoteAdapter.checkRecycled(CoyoteAdapter.java:522)
	at org.apache.coyote.http11.Http11Processor.recycle(Http11Processor.java:1439)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.release(AbstractProtocol.java:1092)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:1029)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:45:37 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 283 with data: {"GOT": "Theomore", "LOTR": "Galadriel"}
2025-06-05 13:45:37 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:45:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [327] with data {"LOTR":"Bilbo Baggins","GOT":"Gerold Grafton"}
2025-06-05 13:45:37 [scheduling-1] WARN  j.d.q.g.GenericQueueSseEmitter - Failed to send message to client: 1
org.springframework.web.context.request.async.AsyncRequestNotUsableException: Response not usable after response errors.
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleHttpServletResponse.obtainLockOrRaiseException(StandardServletAsyncWebRequest.java:338)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleHttpServletResponse.getOutputStream(StandardServletAsyncWebRequest.java:282)
	at org.springframework.http.server.ServletServerHttpResponse.getBody(ServletServerHttpResponse.java:98)
	at org.springframework.http.server.DelegatingServerHttpResponse.getBody(DelegatingServerHttpResponse.java:71)
	at org.springframework.http.converter.StringHttpMessageConverter.writeInternal(StringHttpMessageConverter.java:128)
	at org.springframework.http.converter.StringHttpMessageConverter.writeInternal(StringHttpMessageConverter.java:44)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:45:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:45:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:45:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:45:40 [http-nio-8080-exec-7] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 3
2025-06-05 13:45:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [328] with data {"LOTR":"Faramir","GOT":"Harmune"}
2025-06-05 13:45:40 [http-nio-8080-exec-8] ERROR j.d.q.g.GenericQueueSseEmitter - SSE error for client: 2
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:45:40 [scheduling-1] WARN  j.d.q.g.GenericQueueSseEmitter - Failed to send message to client: 2
org.springframework.web.context.request.async.AsyncRequestNotUsableException: ServletOutputStream failed to flush: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleHttpServletResponse.handleIOException(StandardServletAsyncWebRequest.java:346)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:418)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.apache.catalina.connector.ClientAbortException: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:304)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	... 32 common frames omitted
Caused by: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	... 35 common frames omitted
2025-06-05 13:45:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 3
2025-06-05 13:45:40 [http-nio-8080-exec-8] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:45:40 [http-nio-8080-exec-8] INFO  j.d.q.g.GenericQueueSseEmitter - SSE connection completed for client: 2
2025-06-05 13:45:40 [http-nio-8080-exec-8] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:45:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:45:41 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [277, 280, 284]
2025-06-05 13:45:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [329] with data {"LOTR":"Sauron","GOT":"Vortimer Crane"}
2025-06-05 13:45:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 3
2025-06-05 13:45:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [330] with data {"LOTR":"Samwise Gamgee","GOT":"Moro"}
2025-06-05 13:45:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 3
2025-06-05 13:45:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:45:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:45:49 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 277 with data: {"GOT": "Marq Rankenfell", "LOTR": "Treebeard"}
2025-06-05 13:45:49 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 277: Simulating Random error
2025-06-05 13:45:49 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 277 with id 318ca267-3113-4dc0-af29-89081101d7cd has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:45:49 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 280 with data: {"GOT": "Benjen the Sweet", "LOTR": "Beregond"}
2025-06-05 13:45:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [331] with data {"LOTR":"Éomer","GOT":"Daegon Shepherd"}
2025-06-05 13:45:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 3
2025-06-05 13:45:50 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 284 with data: {"GOT": "Mellei", "LOTR": "Samwise Gamgee"}
2025-06-05 13:45:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:45:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 7b7b73e1-b50d-4435-9fcb-9a578912e430
2025-06-05 13:45:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [332] with data {"LOTR":"Treebeard","GOT":"Merlon Crakehall"}
2025-06-05 13:45:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 3
2025-06-05 13:45:52 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:45:52 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(7b7b73e1-b50d-4435-9fcb-9a578912e430) already exists.
2025-06-05 13:45:53 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(7b7b73e1-b50d-4435-9fcb-9a578912e430) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(7b7b73e1-b50d-4435-9fcb-9a578912e430) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(7b7b73e1-b50d-4435-9fcb-9a578912e430) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:45:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:45:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [287, 288, 289]
2025-06-05 13:45:53 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 287 with data: {"GOT": "All-for-Joffrey", "LOTR": "Elrond"}
2025-06-05 13:45:53 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 288 with data: {"GOT": "Eddard Karstark", "LOTR": "Frodo Baggins"}
2025-06-05 13:45:53 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 289 with data: {"GOT": "Daenerys Targaryen", "LOTR": "Shadowfax"}
2025-06-05 13:45:53 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 287: Simulating Random error
2025-06-05 13:45:53 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 289: Simulating Random error
2025-06-05 13:45:53 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 288: Simulating Random error
2025-06-05 13:45:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:45:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [287, 288, 289]
2025-06-05 13:45:53 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 287 with data: {"GOT": "All-for-Joffrey", "LOTR": "Elrond"}
2025-06-05 13:45:53 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 288 with data: {"GOT": "Eddard Karstark", "LOTR": "Frodo Baggins"}
2025-06-05 13:45:53 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 289 with data: {"GOT": "Daenerys Targaryen", "LOTR": "Shadowfax"}
2025-06-05 13:45:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:45:55 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [290, 291, 292]
2025-06-05 13:45:55 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 290 with data: {"GOT": "Donnel Drumm", "LOTR": "Meriadoc Brandybuck"}
2025-06-05 13:45:55 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 291 with data: {"GOT": "Ryam Florent", "LOTR": "Elrond"}
2025-06-05 13:45:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:45:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:45:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [334] with data {"LOTR":"Arwen Evenstar","GOT":"Darlessa Marbrand"}
2025-06-05 13:45:58 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 292 with data: {"GOT": "Tristifer Botley", "LOTR": "Galadriel"}
2025-06-05 13:46:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 3
2025-06-05 13:46:17 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:46:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:46:17 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#277]
2025-06-05 13:46:17 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [292, 293, 294]
2025-06-05 13:46:17 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 293 with data: {"GOT": "Pycelle", "LOTR": "Peregrin Took"}
2025-06-05 13:46:17 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 292 with data: {"GOT": "Tristifer Botley", "LOTR": "Galadriel"}
2025-06-05 13:46:17 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 294 with data: {"GOT": "Walder Haigh", "LOTR": "Elrond"}
2025-06-05 13:46:17 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [295, 296, 297]
2025-06-05 13:46:17 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 295 with data: {"GOT": "Hother Umber", "LOTR": "Théoden"}
2025-06-05 13:47:25 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:47:25 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 296 with data: {"GOT": "Hali", "LOTR": "Galadriel"}
2025-06-05 13:47:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [335] with data {"LOTR":"Bilbo Baggins","GOT":"Ryon Allyrion"}
2025-06-05 13:47:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 3
2025-06-05 13:47:25 [HikariPool-1:housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m8s78ms348µs100ns).
2025-06-05 13:47:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:47:25 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [293, 294, 295]
2025-06-05 13:47:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:47:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:47:25 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 13:47:29 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 22644 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:47:29 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:47:29 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:47:29 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:47:30 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:47:30 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:47:30 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:47:32 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:47:32 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 116 ms. Found 2 JPA repository interfaces.
2025-06-05 13:47:33 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:47:33 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:47:33 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:47:33 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:47:33 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:47:33 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2740 ms
2025-06-05 13:47:34 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:47:34 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:47:34 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:47:34 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:47:35 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:47:35 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@192147f
2025-06-05 13:47:35 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:47:35 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:47:37 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:47:37 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:47:38 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:47:38 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:47:38 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:47:38 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:47:38 [restartedMain] INFO  jon.db.queue.Application - Started Application in 11.068 seconds (process running for 12.134)
2025-06-05 13:47:39 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:47:39 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:47:39 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-06-05 13:47:39 [http-nio-8080-exec-1] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 1
2025-06-05 13:47:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [336] with data {"GOT":"Sylas Flatnose","LOTR":"Boromir"}
2025-06-05 13:47:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:47:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:47:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:47:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:47:39 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [297, 298, 299]
2025-06-05 13:47:39 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [303, 304, 305]
2025-06-05 13:47:39 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [300, 301, 302]
2025-06-05 13:47:39 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 300 with data: {"GOT": "Jasper Wylde", "LOTR": "Faramir"}
2025-06-05 13:47:39 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 297 with data: {"GOT": "Terrence Toyne", "LOTR": "Quickbeam"}
2025-06-05 13:47:39 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 303 with data: {"GOT": "Tom of Sevenstreams", "LOTR": "Glorfindel"}
2025-06-05 13:47:39 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 298 with data: {"GOT": "Ned Woods", "LOTR": "Boromir"}
2025-06-05 13:47:39 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 301 with data: {"GOT": "Kyle", "LOTR": "Sauron"}
2025-06-05 13:47:39 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 297: Simulating Random error
2025-06-05 13:47:39 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 298: Simulating Random error
2025-06-05 13:47:39 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 303: Simulating Random error
2025-06-05 13:47:39 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 304 with data: {"GOT": "Harwin", "LOTR": "Gimli"}
2025-06-05 13:47:39 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 305 with data: {"GOT": "Veiled Lady", "LOTR": "Galadriel"}
2025-06-05 13:47:39 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 305: Simulating Random error
2025-06-05 13:47:39 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 299 with data: {"GOT": "Amerei Frey", "LOTR": "Shadowfax"}
2025-06-05 13:47:39 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 302 with data: {"GOT": "Burton Crakehall", "LOTR": "Éomer"}
2025-06-05 13:47:39 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 302: Simulating Random error
2025-06-05 13:47:39 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:47:42 [http-nio-8080-exec-3] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 2
2025-06-05 13:47:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [337] with data {"GOT":"Damon Lannister","LOTR":"Faramir"}
2025-06-05 13:47:42 [http-nio-8080-exec-4] ERROR j.d.q.g.GenericQueueSseEmitter - SSE error for client: 1
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:47:42 [scheduling-1] WARN  j.d.q.g.GenericQueueSseEmitter - Failed to send message to client: 1
org.springframework.web.context.request.async.AsyncRequestNotUsableException: ServletOutputStream failed to flush: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleHttpServletResponse.handleIOException(StandardServletAsyncWebRequest.java:346)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:418)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.apache.catalina.connector.ClientAbortException: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:304)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	... 32 common frames omitted
Caused by: java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	... 35 common frames omitted
2025-06-05 13:47:42 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:47:42 [http-nio-8080-exec-4] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:47:42 [http-nio-8080-exec-4] INFO  j.d.q.g.GenericQueueSseEmitter - SSE connection completed for client: 1
2025-06-05 13:47:42 [http-nio-8080-exec-4] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
java.io.IOException: Se ha anulado una conexión establecida por el software en su equipo host.
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:566)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:618)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:122)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1380)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:764)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:728)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:712)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:156)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1271)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:208)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:300)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:266)
	at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:133)
	at org.springframework.web.context.request.async.StandardServletAsyncWebRequest$LifecycleServletOutputStream.flush(StandardServletAsyncWebRequest.java:415)
	at java.base/java.io.FilterOutputStream.flush(FilterOutputStream.java:155)
	at com.fasterxml.jackson.core.json.UTF8JsonGenerator.flush(UTF8JsonGenerator.java:1205)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1063)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:485)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.writeInternal(AbstractGenericHttpMessageConverter.java:135)
	at org.springframework.http.converter.AbstractHttpMessageConverter.write(AbstractHttpMessageConverter.java:235)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.sendInternal(ResponseBodyEmitterReturnValueHandler.java:310)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitterReturnValueHandler$DefaultSseEmitterHandler.send(ResponseBodyEmitterReturnValueHandler.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.sendInternal(ResponseBodyEmitter.java:226)
	at org.springframework.web.servlet.mvc.method.annotation.ResponseBodyEmitter.send(ResponseBodyEmitter.java:217)
	at org.springframework.web.servlet.mvc.method.annotation.SseEmitter.send(SseEmitter.java:135)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.lambda$sendMessageToAllClients$3(GenericQueueSseEmitter.java:60)
	at java.base/java.util.concurrent.ConcurrentHashMap.forEach(ConcurrentHashMap.java:1605)
	at jon.db.queue.generic_queue.GenericQueueSseEmitter.sendMessageToAllClients(GenericQueueSseEmitter.java:53)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:30)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
2025-06-05 13:47:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [338] with data {"GOT":"Axell Florent","LOTR":"Bilbo Baggins"}
2025-06-05 13:47:45 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:47:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:47:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:47:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [339] with data {"GOT":"Quickfinger","LOTR":"Legolas"}
2025-06-05 13:47:48 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:47:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:47:49 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [297, 298, 302]
2025-06-05 13:47:49 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 297 with data: {"GOT": "Terrence Toyne", "LOTR": "Quickbeam"}
2025-06-05 13:47:49 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 298 with data: {"GOT": "Ned Woods", "LOTR": "Boromir"}
2025-06-05 13:47:49 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 302 with data: {"GOT": "Burton Crakehall", "LOTR": "Éomer"}
2025-06-05 13:47:49 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 302: Simulating Random error
2025-06-05 13:47:49 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:47:49 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [302, 303, 305]
2025-06-05 13:47:49 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 302 with data: {"GOT": "Burton Crakehall", "LOTR": "Éomer"}
2025-06-05 13:47:49 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 303 with data: {"GOT": "Tom of Sevenstreams", "LOTR": "Glorfindel"}
2025-06-05 13:47:49 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 303: Simulating Random error
2025-06-05 13:47:49 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 305 with data: {"GOT": "Veiled Lady", "LOTR": "Galadriel"}
2025-06-05 13:47:49 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 305: Simulating Random error
2025-06-05 13:47:50 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:47:50 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [303, 305, 307]
2025-06-05 13:47:50 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 305 with data: {"GOT": "Veiled Lady", "LOTR": "Galadriel"}
2025-06-05 13:47:50 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 303 with data: {"GOT": "Tom of Sevenstreams", "LOTR": "Glorfindel"}
2025-06-05 13:47:50 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 305: Simulating Random error
2025-06-05 13:47:50 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 303: Simulating Random error
2025-06-05 13:47:50 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 305 with id c2f345f7-59f4-4496-bbb0-aed0ddbf7f66 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:47:50 [pool-2-thread-5] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 303 with id 034aa7d3-f87d-4e83-bd08-7be09ff0f945 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:47:50 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 307 with data: {"GOT": "Victor Tyrell", "LOTR": "Samwise Gamgee"}
2025-06-05 13:47:50 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 307: Simulating Random error
2025-06-05 13:47:50 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#303]
2025-06-05 13:47:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [340] with data {"GOT":"Mariya Darry","LOTR":"Denethor"}
2025-06-05 13:47:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:47:54 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:47:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [341] with data {"GOT":"Janna Tyrell","LOTR":"Gandalf the Grey"}
2025-06-05 13:47:54 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:47:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:47:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:47:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [342] with data {"GOT":"Beldecar","LOTR":"Boromir"}
2025-06-05 13:47:57 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:47:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:47:59 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [307, 308, 309]
2025-06-05 13:47:59 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 307 with data: {"GOT": "Victor Tyrell", "LOTR": "Samwise Gamgee"}
2025-06-05 13:47:59 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 308 with data: {"GOT": "Lancel V Lannister", "LOTR": "Tom Bombadil"}
2025-06-05 13:47:59 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 309 with data: {"GOT": "Sebaston Farman", "LOTR": "Barliman Butterbur"}
2025-06-05 13:47:59 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 309: Simulating Random error
2025-06-05 13:47:59 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [310, 312, 313]
2025-06-05 13:47:59 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 310 with data: {"GOT": "Dick", "LOTR": "Boromir"}
2025-06-05 13:48:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [343] with data {"GOT":"Donnel Haigh","LOTR":"Barliman Butterbur"}
2025-06-05 13:48:00 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:03 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 312 with data: {"GOT": "Runciter", "LOTR": "Faramir"}
2025-06-05 13:48:03 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 312: Simulating Random error
2025-06-05 13:48:03 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 313 with data: {"GOT": "Dunsen", "LOTR": "Arwen Evenstar"}
2025-06-05 13:48:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:48:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:48:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [344] with data {"GOT":"Three Toes","LOTR":"Peregrin Took"}
2025-06-05 13:48:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:48:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [309, 312, 314]
2025-06-05 13:48:05 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 309 with data: {"GOT": "Sebaston Farman", "LOTR": "Barliman Butterbur"}
2025-06-05 13:48:05 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 312 with data: {"GOT": "Runciter", "LOTR": "Faramir"}
2025-06-05 13:48:05 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 309: Simulating Random error
2025-06-05 13:48:05 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 312: Simulating Random error
2025-06-05 13:48:05 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 314 with data: {"GOT": "Frenken", "LOTR": "Sauron"}
2025-06-05 13:48:05 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 314: Simulating Random error
2025-06-05 13:48:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:48:06 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:48:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [345] with data {"GOT":"Cadwyn","LOTR":"Aragorn"}
2025-06-05 13:48:06 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:48:09 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [309, 312, 314]
2025-06-05 13:48:09 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 309 with data: {"GOT": "Sebaston Farman", "LOTR": "Barliman Butterbur"}
2025-06-05 13:48:09 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 312 with data: {"GOT": "Runciter", "LOTR": "Faramir"}
2025-06-05 13:48:09 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 314 with data: {"GOT": "Frenken", "LOTR": "Sauron"}
2025-06-05 13:48:09 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 312: Simulating Random error
2025-06-05 13:48:09 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 312 with id 84695c91-50c1-49e1-9830-64e03897d7b6 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:48:09 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [315, 316, 317]
2025-06-05 13:48:09 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 315 with data: {"GOT": "Alannys Harlaw", "LOTR": "Saruman the White"}
2025-06-05 13:48:09 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 315: Simulating Random error
2025-06-05 13:48:09 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 316 with data: {"GOT": "Beck", "LOTR": "Arwen Evenstar"}
2025-06-05 13:48:09 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 316: Simulating Random error
2025-06-05 13:48:09 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 317 with data: {"GOT": "Gorne", "LOTR": "Shelob"}
2025-06-05 13:48:09 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 317: Simulating Random error
2025-06-05 13:48:09 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:48:09 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [315, 316, 317]
2025-06-05 13:48:09 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 315 with data: {"GOT": "Alannys Harlaw", "LOTR": "Saruman the White"}
2025-06-05 13:48:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [346] with data {"GOT":"Clement Crabb","LOTR":"Elrond"}
2025-06-05 13:48:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:48:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:48:12 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 316 with data: {"GOT": "Beck", "LOTR": "Arwen Evenstar"}
2025-06-05 13:48:12 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 316: Simulating Random error
2025-06-05 13:48:12 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 317 with data: {"GOT": "Gorne", "LOTR": "Shelob"}
2025-06-05 13:48:12 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 317: Simulating Random error
2025-06-05 13:48:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [347] with data {"GOT":"Dacks","LOTR":"Denethor"}
2025-06-05 13:48:12 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:14 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:48:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [348] with data {"GOT":"Royce Coldwater","LOTR":"Saruman the White"}
2025-06-05 13:48:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:16 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:48:18 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#312]
2025-06-05 13:48:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [349] with data {"GOT":"Vylarr","LOTR":"Gandalf the Grey"}
2025-06-05 13:48:18 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:48:19 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [316, 317, 318]
2025-06-05 13:48:19 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 316 with data: {"GOT": "Beck", "LOTR": "Arwen Evenstar"}
2025-06-05 13:48:19 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 317 with data: {"GOT": "Gorne", "LOTR": "Shelob"}
2025-06-05 13:48:19 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 318 with data: {"GOT": "Guthor Grimm", "LOTR": "Théoden"}
2025-06-05 13:48:19 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 316: Simulating Random error
2025-06-05 13:48:19 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 318: Simulating Random error
2025-06-05 13:48:19 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [319, 320, 321]
2025-06-05 13:48:19 [pool-2-thread-5] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 316 with id 8a2ac8d8-0b73-4582-9b60-4b33cad757e1 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:48:19 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [322, 323, 325]
2025-06-05 13:48:19 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 319 with data: {"GOT": "Taena of Myr", "LOTR": "Éowyn"}
2025-06-05 13:48:19 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 320 with data: {"GOT": "Ghael", "LOTR": "Éowyn"}
2025-06-05 13:48:19 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 321 with data: {"GOT": "Rolly Duckfield", "LOTR": "Galadriel"}
2025-06-05 13:48:19 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 321: Simulating Random error
2025-06-05 13:48:19 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 322 with data: {"GOT": "Dick Follard", "LOTR": "Samwise Gamgee"}
2025-06-05 13:48:19 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 322: Simulating Random error
2025-06-05 13:48:19 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 323 with data: {"GOT": "Symon Hollard", "LOTR": "Tom Bombadil"}
2025-06-05 13:48:19 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 325 with data: {"GOT": "Sylas Flatnose", "LOTR": "Samwise Gamgee"}
2025-06-05 13:48:19 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 325: Simulating Random error
2025-06-05 13:48:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:48:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:48:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [350] with data {"GOT":"Wilbert","LOTR":"Barliman Butterbur"}
2025-06-05 13:48:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [351] with data {"GOT":"Tommen Baratheon","LOTR":"Tom Bombadil"}
2025-06-05 13:48:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:48:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:48:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [352] with data {"GOT":"Brea","LOTR":"Peregrin Took"}
2025-06-05 13:48:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:48:29 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:48:29 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [318, 321, 322]
2025-06-05 13:48:29 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 318 with data: {"GOT": "Guthor Grimm", "LOTR": "Théoden"}
2025-06-05 13:48:29 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 321 with data: {"GOT": "Rolly Duckfield", "LOTR": "Galadriel"}
2025-06-05 13:48:29 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 322 with data: {"GOT": "Dick Follard", "LOTR": "Samwise Gamgee"}
2025-06-05 13:48:29 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 321: Simulating Random error
2025-06-05 13:48:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [353] with data {"GOT":"Muttering Bill","LOTR":"Faramir"}
2025-06-05 13:48:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [354] with data {"GOT":"Leana Frey","LOTR":"Sauron"}
2025-06-05 13:48:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:35 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#316]
2025-06-05 13:48:35 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [321, 325, 326]
2025-06-05 13:48:35 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 321 with data: {"GOT": "Rolly Duckfield", "LOTR": "Galadriel"}
2025-06-05 13:48:35 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 325 with data: {"GOT": "Sylas Flatnose", "LOTR": "Samwise Gamgee"}
2025-06-05 13:48:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:48:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:48:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [355] with data {"GOT":"Torrhen Stark","LOTR":"Glorfindel"}
2025-06-05 13:48:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:38 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 326 with data: {"GOT": "Hareth", "LOTR": "Peregrin Took"}
2025-06-05 13:48:38 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:48:38 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [326, 327, 328]
2025-06-05 13:48:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:48:39 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 326 with data: {"GOT": "Hareth", "LOTR": "Peregrin Took"}
2025-06-05 13:48:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [356] with data {"GOT":"Robert Flowers","LOTR":"Barliman Butterbur"}
2025-06-05 13:48:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:41 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 327 with data: {"GOT": "Gerold Grafton", "LOTR": "Bilbo Baggins"}
2025-06-05 13:48:41 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 327: Simulating Random error
2025-06-05 13:48:41 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 328 with data: {"GOT": "Harmune", "LOTR": "Faramir"}
2025-06-05 13:48:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [357] with data {"GOT":"Ryam Florent","LOTR":"Treebeard"}
2025-06-05 13:48:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:48:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:48:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [358] with data {"GOT":"Marwyn Belmore","LOTR":"Quickbeam"}
2025-06-05 13:48:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:47 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:48:47 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [327, 329, 330]
2025-06-05 13:48:47 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 327 with data: {"GOT": "Gerold Grafton", "LOTR": "Bilbo Baggins"}
2025-06-05 13:48:47 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 329 with data: {"GOT": "Vortimer Crane", "LOTR": "Sauron"}
2025-06-05 13:48:47 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 330 with data: {"GOT": "Moro", "LOTR": "Samwise Gamgee"}
2025-06-05 13:48:47 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 327: Simulating Random error
2025-06-05 13:48:48 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:48:48 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [327, 331, 332]
2025-06-05 13:48:48 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 327 with data: {"GOT": "Gerold Grafton", "LOTR": "Bilbo Baggins"}
2025-06-05 13:48:48 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 331 with data: {"GOT": "Daegon Shepherd", "LOTR": "Éomer"}
2025-06-05 13:48:48 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 327: Simulating Random error
2025-06-05 13:48:48 [pool-2-thread-1] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 327 with id c688eef4-48ca-4422-bec2-c52dc0637182 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:48:48 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 332 with data: {"GOT": "Merlon Crakehall", "LOTR": "Treebeard"}
2025-06-05 13:48:48 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 332: Simulating Random error
2025-06-05 13:48:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [359] with data {"GOT":"Endrew Tarth","LOTR":"Éomer"}
2025-06-05 13:48:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:48:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:48:51 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:48:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [360] with data {"GOT":"Boremund Harlaw","LOTR":"Galadriel"}
2025-06-05 13:48:52 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:54 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:48:54 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [332, 334, 335]
2025-06-05 13:48:54 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 332 with data: {"GOT": "Merlon Crakehall", "LOTR": "Treebeard"}
2025-06-05 13:48:54 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 334 with data: {"GOT": "Darlessa Marbrand", "LOTR": "Arwen Evenstar"}
2025-06-05 13:48:54 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 334: Simulating Random error
2025-06-05 13:48:54 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 335 with data: {"GOT": "Ryon Allyrion", "LOTR": "Bilbo Baggins"}
2025-06-05 13:48:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [361] with data {"GOT":"Gyles","LOTR":"Gollum"}
2025-06-05 13:48:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 84009585-6a33-4aee-a480-5c89a6606a1c
2025-06-05 13:48:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [362] with data {"GOT":"Thormor Ironmaker","LOTR":"Denethor"}
2025-06-05 13:48:58 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:48:58 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:48:58 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(84009585-6a33-4aee-a480-5c89a6606a1c) already exists.
2025-06-05 13:48:58 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(84009585-6a33-4aee-a480-5c89a6606a1c) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(84009585-6a33-4aee-a480-5c89a6606a1c) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(84009585-6a33-4aee-a480-5c89a6606a1c) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:48:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:48:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:48:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:49:00 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:49:00 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [334, 336, 337]
2025-06-05 13:49:00 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 334 with data: {"GOT": "Darlessa Marbrand", "LOTR": "Arwen Evenstar"}
2025-06-05 13:49:00 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 336 with data: {"GOT": "Sylas Flatnose", "LOTR": "Boromir"}
2025-06-05 13:49:00 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 337 with data: {"GOT": "Damon Lannister", "LOTR": "Faramir"}
2025-06-05 13:49:00 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 334: Simulating Random error
2025-06-05 13:49:00 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 337: Simulating Random error
2025-06-05 13:49:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [364] with data {"GOT":"Samwell Spicer","LOTR":"Arwen Evenstar"}
2025-06-05 13:49:01 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:01 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:49:01 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [334, 337, 338]
2025-06-05 13:49:01 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 334 with data: {"GOT": "Darlessa Marbrand", "LOTR": "Arwen Evenstar"}
2025-06-05 13:49:01 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 337 with data: {"GOT": "Damon Lannister", "LOTR": "Faramir"}
2025-06-05 13:49:01 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 338 with data: {"GOT": "Axell Florent", "LOTR": "Bilbo Baggins"}
2025-06-05 13:49:01 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 334: Simulating Random error
2025-06-05 13:49:01 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 337: Simulating Random error
2025-06-05 13:49:01 [pool-2-thread-1] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 334 with id 480d7e68-32f5-42ec-84f2-37f14fd759fc has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:49:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [365] with data {"GOT":"Luceon Frey","LOTR":"Barliman Butterbur"}
2025-06-05 13:49:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:06 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#327]
2025-06-05 13:49:06 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [337, 339, 340]
2025-06-05 13:49:06 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 339 with data: {"GOT": "Quickfinger", "LOTR": "Legolas"}
2025-06-05 13:49:06 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 340 with data: {"GOT": "Mariya Darry", "LOTR": "Denethor"}
2025-06-05 13:49:06 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 337 with data: {"GOT": "Damon Lannister", "LOTR": "Faramir"}
2025-06-05 13:49:06 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 340: Simulating Random error
2025-06-05 13:49:06 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 339: Simulating Random error
2025-06-05 13:49:06 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 337: Simulating Random error
2025-06-05 13:49:06 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 337 with id eb70eb78-4b6d-469a-8039-faeb316c0f5d has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:49:06 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#337]
2025-06-05 13:49:06 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [339, 340, 341]
2025-06-05 13:49:06 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 339 with data: {"GOT": "Quickfinger", "LOTR": "Legolas"}
2025-06-05 13:49:06 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 340 with data: {"GOT": "Mariya Darry", "LOTR": "Denethor"}
2025-06-05 13:49:06 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 341 with data: {"GOT": "Janna Tyrell", "LOTR": "Gandalf the Grey"}
2025-06-05 13:49:06 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 340: Simulating Random error
2025-06-05 13:49:06 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 341: Simulating Random error
2025-06-05 13:49:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [366] with data {"GOT":"Amerei Frey","LOTR":"Boromir"}
2025-06-05 13:49:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:49:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:49:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:49:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [367] with data {"GOT":"Tumberjon","LOTR":"Bilbo Baggins"}
2025-06-05 13:49:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:10 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:49:10 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [340, 341, 342]
2025-06-05 13:49:10 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 340 with data: {"GOT": "Mariya Darry", "LOTR": "Denethor"}
2025-06-05 13:49:10 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 342 with data: {"GOT": "Beldecar", "LOTR": "Boromir"}
2025-06-05 13:49:10 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 341 with data: {"GOT": "Janna Tyrell", "LOTR": "Gandalf the Grey"}
2025-06-05 13:49:10 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 340: Simulating Random error
2025-06-05 13:49:10 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 341: Simulating Random error
2025-06-05 13:49:10 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 340 with id 3aa885ee-07b5-40ba-ada8-92a86f9fd594 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:49:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [368] with data {"GOT":"Fralegg","LOTR":"Gollum"}
2025-06-05 13:49:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:49:15 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:49:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [369] with data {"GOT":"Bess Bracken","LOTR":"Gollum"}
2025-06-05 13:49:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:18 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#340]
2025-06-05 13:49:18 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [341, 343, 344]
2025-06-05 13:49:18 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 341 with data: {"GOT": "Janna Tyrell", "LOTR": "Gandalf the Grey"}
2025-06-05 13:49:18 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 343 with data: {"GOT": "Donnel Haigh", "LOTR": "Barliman Butterbur"}
2025-06-05 13:49:18 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 343: Simulating Random error
2025-06-05 13:49:18 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 341: Simulating Random error
2025-06-05 13:49:18 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 344 with data: {"GOT": "Three Toes", "LOTR": "Peregrin Took"}
2025-06-05 13:49:18 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 341 with id a5968cdf-a82c-470e-b15b-d5f6655aa540 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:49:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:49:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [370] with data {"GOT":"Rodrik Ryswell","LOTR":"Arwen Evenstar"}
2025-06-05 13:49:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:20 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:49:20 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [343, 345, 346]
2025-06-05 13:49:20 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 345 with data: {"GOT": "Cadwyn", "LOTR": "Aragorn"}
2025-06-05 13:49:20 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 343 with data: {"GOT": "Donnel Haigh", "LOTR": "Barliman Butterbur"}
2025-06-05 13:49:20 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 346 with data: {"GOT": "Clement Crabb", "LOTR": "Elrond"}
2025-06-05 13:49:20 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#334]
2025-06-05 13:49:20 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [343, 346, 347]
2025-06-05 13:49:20 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 343 with data: {"GOT": "Donnel Haigh", "LOTR": "Barliman Butterbur"}
2025-06-05 13:49:20 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 346 with data: {"GOT": "Clement Crabb", "LOTR": "Elrond"}
2025-06-05 13:49:20 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 346: Simulating Random error
2025-06-05 13:49:20 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 347 with data: {"GOT": "Dacks", "LOTR": "Denethor"}
2025-06-05 13:49:20 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 347: Simulating Random error
2025-06-05 13:49:20 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:49:20 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [346, 347, 348]
2025-06-05 13:49:20 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 346 with data: {"GOT": "Clement Crabb", "LOTR": "Elrond"}
2025-06-05 13:49:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [371] with data {"GOT":"Steffon Seaworth","LOTR":"Barliman Butterbur"}
2025-06-05 13:49:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:49:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:49:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [372] with data {"GOT":"Erreg","LOTR":"Shadowfax"}
2025-06-05 13:49:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:28 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 347 with data: {"GOT": "Dacks", "LOTR": "Denethor"}
2025-06-05 13:49:28 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 347: Simulating Random error
2025-06-05 13:49:28 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 348 with data: {"GOT": "Royce Coldwater", "LOTR": "Saruman the White"}
2025-06-05 13:49:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [373] with data {"GOT":"Jyzene","LOTR":"Éomer"}
2025-06-05 13:49:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:49:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [374] with data {"GOT":"Rickard Ryswell","LOTR":"Éomer"}
2025-06-05 13:49:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:49:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:49:32 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#341]
2025-06-05 13:49:32 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [347, 349, 350]
2025-06-05 13:49:32 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 347 with data: {"GOT": "Dacks", "LOTR": "Denethor"}
2025-06-05 13:49:32 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 349 with data: {"GOT": "Vylarr", "LOTR": "Gandalf the Grey"}
2025-06-05 13:49:32 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 347: Simulating Random error
2025-06-05 13:49:32 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 349: Simulating Random error
2025-06-05 13:49:32 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 347 with id 422dc6ea-e35f-42d7-91ed-1622f432e6ae has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:49:32 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 350 with data: {"GOT": "Wilbert", "LOTR": "Barliman Butterbur"}
2025-06-05 13:49:33 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:49:33 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [349, 351, 352]
2025-06-05 13:49:33 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 349 with data: {"GOT": "Vylarr", "LOTR": "Gandalf the Grey"}
2025-06-05 13:49:33 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 351 with data: {"GOT": "Tommen Baratheon", "LOTR": "Tom Bombadil"}
2025-06-05 13:49:33 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 352 with data: {"GOT": "Brea", "LOTR": "Peregrin Took"}
2025-06-05 13:49:33 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 352: Simulating Random error
2025-06-05 13:49:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [375] with data {"GOT":"Narbo","LOTR":"Denethor"}
2025-06-05 13:49:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [376] with data {"GOT":"Benedar Belmore","LOTR":"Gandalf the Grey"}
2025-06-05 13:49:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:49:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:49:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:49:40 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:49:40 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [352, 353, 354]
2025-06-05 13:49:40 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 352 with data: {"GOT": "Brea", "LOTR": "Peregrin Took"}
2025-06-05 13:49:40 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 353 with data: {"GOT": "Muttering Bill", "LOTR": "Faramir"}
2025-06-05 13:49:40 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 354 with data: {"GOT": "Leana Frey", "LOTR": "Sauron"}
2025-06-05 13:49:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [377] with data {"GOT":"Todric","LOTR":"Shadowfax"}
2025-06-05 13:49:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:42 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:49:42 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [355, 356, 357]
2025-06-05 13:49:42 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 355 with data: {"GOT": "Torrhen Stark", "LOTR": "Glorfindel"}
2025-06-05 13:49:42 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 355: Simulating Random error
2025-06-05 13:49:42 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 356 with data: {"GOT": "Robert Flowers", "LOTR": "Barliman Butterbur"}
2025-06-05 13:49:42 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 357 with data: {"GOT": "Ryam Florent", "LOTR": "Treebeard"}
2025-06-05 13:49:42 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 357: Simulating Random error
2025-06-05 13:49:42 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:49:42 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [355, 357, 358]
2025-06-05 13:49:42 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 355 with data: {"GOT": "Torrhen Stark", "LOTR": "Glorfindel"}
2025-06-05 13:49:42 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 357 with data: {"GOT": "Ryam Florent", "LOTR": "Treebeard"}
2025-06-05 13:49:42 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 357: Simulating Random error
2025-06-05 13:49:42 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 358 with data: {"GOT": "Marwyn Belmore", "LOTR": "Quickbeam"}
2025-06-05 13:49:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [378] with data {"GOT":"Aubrey Ambrose","LOTR":"Legolas"}
2025-06-05 13:49:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [379] with data {"GOT":"Zekko","LOTR":"Aragorn"}
2025-06-05 13:49:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:49:47 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:49:48 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#347]
2025-06-05 13:49:48 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [357, 359, 360]
2025-06-05 13:49:48 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 357 with data: {"GOT": "Ryam Florent", "LOTR": "Treebeard"}
2025-06-05 13:49:48 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 359 with data: {"GOT": "Endrew Tarth", "LOTR": "Éomer"}
2025-06-05 13:49:48 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 357: Simulating Random error
2025-06-05 13:49:48 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 357 with id 0f6d8107-b454-46fd-9c02-b6047c22c1fc has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:49:48 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 360 with data: {"GOT": "Boremund Harlaw", "LOTR": "Galadriel"}
2025-06-05 13:49:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:49:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [380] with data {"GOT":"Raynald Westerling","LOTR":"Sauron"}
2025-06-05 13:49:49 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:52 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:49:52 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [361, 362, 364]
2025-06-05 13:49:52 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 361 with data: {"GOT": "Gyles", "LOTR": "Gollum"}
2025-06-05 13:49:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [381] with data {"GOT":"Qarl the Maid","LOTR":"Shadowfax"}
2025-06-05 13:49:53 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:53 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 362 with data: {"GOT": "Thormor Ironmaker", "LOTR": "Denethor"}
2025-06-05 13:49:53 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 362: Simulating Random error
2025-06-05 13:49:53 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 364 with data: {"GOT": "Samwell Spicer", "LOTR": "Arwen Evenstar"}
2025-06-05 13:49:53 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 364: Simulating Random error
2025-06-05 13:49:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:49:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [362, 364, 365]
2025-06-05 13:49:53 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 362 with data: {"GOT": "Thormor Ironmaker", "LOTR": "Denethor"}
2025-06-05 13:49:53 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 364 with data: {"GOT": "Samwell Spicer", "LOTR": "Arwen Evenstar"}
2025-06-05 13:49:53 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 362: Simulating Random error
2025-06-05 13:49:53 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 364: Simulating Random error
2025-06-05 13:49:53 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 365 with data: {"GOT": "Luceon Frey", "LOTR": "Barliman Butterbur"}
2025-06-05 13:49:53 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 365: Simulating Random error
2025-06-05 13:49:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:49:53 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [362, 364, 365]
2025-06-05 13:49:53 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 362 with data: {"GOT": "Thormor Ironmaker", "LOTR": "Denethor"}
2025-06-05 13:49:53 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 364 with data: {"GOT": "Samwell Spicer", "LOTR": "Arwen Evenstar"}
2025-06-05 13:49:53 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 364: Simulating Random error
2025-06-05 13:49:53 [pool-2-thread-5] WARN  j.d.q.g.GenericQueueProcessor - [Worker-3] Message 364 with id 92b91e88-8b0a-44d9-bab8-680e5252514b has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:49:53 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 365 with data: {"GOT": "Luceon Frey", "LOTR": "Barliman Butterbur"}
2025-06-05 13:49:53 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 365: Simulating Random error
2025-06-05 13:49:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:49:55 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:49:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [382] with data {"GOT":"Cedric Payne","LOTR":"Aragorn"}
2025-06-05 13:49:56 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [383] with data {"GOT":"Monford Velaryon","LOTR":"Frodo Baggins"}
2025-06-05 13:49:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:49:59 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:49:59 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:49:59 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [365, 366, 367]
2025-06-05 13:49:59 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 365 with data: {"GOT": "Luceon Frey", "LOTR": "Barliman Butterbur"}
2025-06-05 13:49:59 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 366 with data: {"GOT": "Amerei Frey", "LOTR": "Boromir"}
2025-06-05 13:49:59 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 367 with data: {"GOT": "Tumberjon", "LOTR": "Bilbo Baggins"}
2025-06-05 13:49:59 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 365: Simulating Random error
2025-06-05 13:49:59 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 367: Simulating Random error
2025-06-05 13:49:59 [pool-2-thread-5] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 365 with id 696a7238-9e06-4e6e-ae1d-9ed1d910c622 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:50:00 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#357]
2025-06-05 13:50:00 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [367, 368, 369]
2025-06-05 13:50:00 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 367 with data: {"GOT": "Tumberjon", "LOTR": "Bilbo Baggins"}
2025-06-05 13:50:00 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 368 with data: {"GOT": "Fralegg", "LOTR": "Gollum"}
2025-06-05 13:50:00 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 369 with data: {"GOT": "Bess Bracken", "LOTR": "Gollum"}
2025-06-05 13:50:00 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 368: Simulating Random error
2025-06-05 13:50:02 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [384] with data {"GOT":"Aegon Frey","LOTR":"Théoden"}
2025-06-05 13:50:02 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:50:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:50:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [385] with data {"GOT":"Harlan Grandison","LOTR":"Treebeard"}
2025-06-05 13:50:05 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:05 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#365]
2025-06-05 13:50:05 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [368, 370, 371]
2025-06-05 13:50:05 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 368 with data: {"GOT": "Fralegg", "LOTR": "Gollum"}
2025-06-05 13:50:05 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 370 with data: {"GOT": "Rodrik Ryswell", "LOTR": "Arwen Evenstar"}
2025-06-05 13:50:05 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 371 with data: {"GOT": "Steffon Seaworth", "LOTR": "Barliman Butterbur"}
2025-06-05 13:50:05 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 370: Simulating Random error
2025-06-05 13:50:05 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 371: Simulating Random error
2025-06-05 13:50:08 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [386] with data {"GOT":"Jaime Frey","LOTR":"Gandalf the Grey"}
2025-06-05 13:50:08 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:08 [pool-3-thread-2] ERROR j.d.q.g.GenericQueueWorker - [Worker-3] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#364]
2025-06-05 13:50:08 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [370, 371, 372]
2025-06-05 13:50:08 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 370 with data: {"GOT": "Rodrik Ryswell", "LOTR": "Arwen Evenstar"}
2025-06-05 13:50:08 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 370: Simulating Random error
2025-06-05 13:50:08 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 371 with data: {"GOT": "Steffon Seaworth", "LOTR": "Barliman Butterbur"}
2025-06-05 13:50:08 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 372 with data: {"GOT": "Erreg", "LOTR": "Shadowfax"}
2025-06-05 13:50:08 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 372: Simulating Random error
2025-06-05 13:50:09 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:50:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [387] with data {"GOT":"Aerys II Targaryen","LOTR":"Arwen Evenstar"}
2025-06-05 13:50:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:50:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:50:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [388] with data {"GOT":"Greenbeard","LOTR":"Samwise Gamgee"}
2025-06-05 13:50:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [389] with data {"GOT":"Jasper Arryn","LOTR":"Faramir"}
2025-06-05 13:50:17 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:17 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:50:17 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [370, 372, 373]
2025-06-05 13:50:17 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 370 with data: {"GOT": "Rodrik Ryswell", "LOTR": "Arwen Evenstar"}
2025-06-05 13:50:17 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 372 with data: {"GOT": "Erreg", "LOTR": "Shadowfax"}
2025-06-05 13:50:17 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 370: Simulating Random error
2025-06-05 13:50:17 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 373 with data: {"GOT": "Jyzene", "LOTR": "Éomer"}
2025-06-05 13:50:17 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 370 with id 0469d23f-c202-46db-8e3d-1319ba552789 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:50:17 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 372: Simulating Random error
2025-06-05 13:50:17 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 373: Simulating Random error
2025-06-05 13:50:17 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#370]
2025-06-05 13:50:17 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [372, 373, 374]
2025-06-05 13:50:17 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 372 with data: {"GOT": "Erreg", "LOTR": "Shadowfax"}
2025-06-05 13:50:17 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 373 with data: {"GOT": "Jyzene", "LOTR": "Éomer"}
2025-06-05 13:50:17 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 374 with data: {"GOT": "Rickard Ryswell", "LOTR": "Éomer"}
2025-06-05 13:50:17 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 373: Simulating Random error
2025-06-05 13:50:17 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 374: Simulating Random error
2025-06-05 13:50:18 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:50:18 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [373, 374, 375]
2025-06-05 13:50:18 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 373 with data: {"GOT": "Jyzene", "LOTR": "Éomer"}
2025-06-05 13:50:18 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 374 with data: {"GOT": "Rickard Ryswell", "LOTR": "Éomer"}
2025-06-05 13:50:18 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 375 with data: {"GOT": "Narbo", "LOTR": "Denethor"}
2025-06-05 13:50:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:50:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:50:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:50:20 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [390] with data {"GOT":"Lorren","LOTR":"Galadriel"}
2025-06-05 13:50:20 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [391] with data {"GOT":"Edric Dayne","LOTR":"Samwise Gamgee"}
2025-06-05 13:50:23 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:24 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:50:24 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [376, 377, 378]
2025-06-05 13:50:24 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 376 with data: {"GOT": "Benedar Belmore", "LOTR": "Gandalf the Grey"}
2025-06-05 13:50:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [392] with data {"GOT":"Jaggot","LOTR":"Éomer"}
2025-06-05 13:50:26 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:26 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 377 with data: {"GOT": "Todric", "LOTR": "Shadowfax"}
2025-06-05 13:50:26 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 377: Simulating Random error
2025-06-05 13:50:26 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 378 with data: {"GOT": "Aubrey Ambrose", "LOTR": "Legolas"}
2025-06-05 13:50:26 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 378: Simulating Random error
2025-06-05 13:50:27 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:50:27 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [377, 378, 379]
2025-06-05 13:50:27 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 377 with data: {"GOT": "Todric", "LOTR": "Shadowfax"}
2025-06-05 13:50:27 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 378 with data: {"GOT": "Aubrey Ambrose", "LOTR": "Legolas"}
2025-06-05 13:50:27 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 377: Simulating Random error
2025-06-05 13:50:27 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 378: Simulating Random error
2025-06-05 13:50:27 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 379 with data: {"GOT": "Zekko", "LOTR": "Aragorn"}
2025-06-05 13:50:27 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:50:27 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [377, 378, 380]
2025-06-05 13:50:27 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 377 with data: {"GOT": "Todric", "LOTR": "Shadowfax"}
2025-06-05 13:50:27 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 378 with data: {"GOT": "Aubrey Ambrose", "LOTR": "Legolas"}
2025-06-05 13:50:27 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 377: Simulating Random error
2025-06-05 13:50:27 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 378: Simulating Random error
2025-06-05 13:50:27 [pool-2-thread-1] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 377 with id 92ffae60-1d2b-4e33-8490-ff2cb867b08d has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:50:27 [pool-2-thread-4] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 378 with id c1661685-1dbb-4185-bc3f-8bb02de47200 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:50:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:50:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:50:27 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 380 with data: {"GOT": "Raynald Westerling", "LOTR": "Sauron"}
2025-06-05 13:50:27 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 380: Simulating Random error
2025-06-05 13:50:27 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#377]
2025-06-05 13:50:27 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [380, 381, 382]
2025-06-05 13:50:27 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 380 with data: {"GOT": "Raynald Westerling", "LOTR": "Sauron"}
2025-06-05 13:50:27 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 381 with data: {"GOT": "Qarl the Maid", "LOTR": "Shadowfax"}
2025-06-05 13:50:27 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 381: Simulating Random error
2025-06-05 13:50:27 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 382 with data: {"GOT": "Cedric Payne", "LOTR": "Aragorn"}
2025-06-05 13:50:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [393] with data {"GOT":"Mark Ryswell","LOTR":"Aragorn"}
2025-06-05 13:50:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:29 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:50:32 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [394] with data {"GOT":"Salladhor Saan","LOTR":"Gimli"}
2025-06-05 13:50:32 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:33 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:50:33 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [381, 383, 384]
2025-06-05 13:50:33 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 381 with data: {"GOT": "Qarl the Maid", "LOTR": "Shadowfax"}
2025-06-05 13:50:33 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 384 with data: {"GOT": "Aegon Frey", "LOTR": "Théoden"}
2025-06-05 13:50:33 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 383 with data: {"GOT": "Monford Velaryon", "LOTR": "Frodo Baggins"}
2025-06-05 13:50:33 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 384: Simulating Random error
2025-06-05 13:50:33 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 383: Simulating Random error
2025-06-05 13:50:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [395] with data {"GOT":"Bryen Caron","LOTR":"Elrond"}
2025-06-05 13:50:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:50:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:50:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [396] with data {"GOT":"Nymella Toland","LOTR":"Shadowfax"}
2025-06-05 13:50:38 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:39 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:50:40 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:50:40 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [383, 384, 385]
2025-06-05 13:50:40 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 383 with data: {"GOT": "Monford Velaryon", "LOTR": "Frodo Baggins"}
2025-06-05 13:50:40 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 384 with data: {"GOT": "Aegon Frey", "LOTR": "Théoden"}
2025-06-05 13:50:40 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 385 with data: {"GOT": "Harlan Grandison", "LOTR": "Treebeard"}
2025-06-05 13:50:40 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 385: Simulating Random error
2025-06-05 13:50:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [397] with data {"GOT":"Leana Frey","LOTR":"Saruman the White"}
2025-06-05 13:50:41 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:50:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:50:44 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [398] with data {"GOT":"Lucas Blackwood","LOTR":"Peregrin Took"}
2025-06-05 13:50:44 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 2
2025-06-05 13:50:44 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:50:44 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [385, 386, 387]
2025-06-05 13:50:44 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 385 with data: {"GOT": "Harlan Grandison", "LOTR": "Treebeard"}
2025-06-05 13:50:44 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 386 with data: {"GOT": "Jaime Frey", "LOTR": "Gandalf the Grey"}
2025-06-05 13:50:44 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 385: Simulating Random error
2025-06-05 13:50:44 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 386: Simulating Random error
2025-06-05 13:50:44 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 387 with data: {"GOT": "Aerys II Targaryen", "LOTR": "Arwen Evenstar"}
2025-06-05 13:50:45 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-05 13:50:54 [restartedMain] INFO  jon.db.queue.Application - Starting Application using Java 22.0.2 with PID 13560 (C:\Users\buble\OneDrive\Projects\- Main\DB Queue\target\classes started by buble in C:\Users\buble\OneDrive\Projects\- Main\DB Queue)
2025-06-05 13:50:54 [restartedMain] DEBUG jon.db.queue.Application - Running with Spring Boot v3.5.0, Spring v6.2.7
2025-06-05 13:50:54 [restartedMain] INFO  jon.db.queue.Application - No active profile set, falling back to 1 default profile: "default"
2025-06-05 13:50:54 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - Using Docker Compose file C:\Users\buble\OneDrive\Projects\- Main\DB Queue\compose.yaml
2025-06-05 13:50:55 [restartedMain] INFO  o.s.b.d.c.l.DockerComposeLifecycleManager - There are already Docker Compose services running, skipping startup
2025-06-05 13:50:55 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-06-05 13:50:55 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-06-05 13:50:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-05 13:50:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 95 ms. Found 2 JPA repository interfaces.
2025-06-05 13:50:58 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-06-05 13:50:58 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-06-05 13:50:58 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-05 13:50:58 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.41]
2025-06-05 13:50:58 [restartedMain] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-05 13:50:58 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2597 ms
2025-06-05 13:50:58 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-05 13:50:58 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.15.Final
2025-06-05 13:50:58 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-05 13:50:59 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-05 13:50:59 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-05 13:50:59 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3829dc3
2025-06-05 13:50:59 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-05 13:51:00 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-05 13:51:01 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-05 13:51:01 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-05 13:51:02 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-05 13:51:03 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-06-05 13:51:03 [restartedMain] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-06-05 13:51:03 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-06-05 13:51:03 [restartedMain] INFO  jon.db.queue.Application - Started Application in 10.588 seconds (process running for 11.643)
2025-06-05 13:51:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:51:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:51:03 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 2afd60f6-2819-425b-aa8e-349783938172
2025-06-05 13:51:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [399] with data {"LOTR":"Frodo Baggins","GOT":"Theobald"}
2025-06-05 13:51:04 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:51:04 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(2afd60f6-2819-425b-aa8e-349783938172) already exists.
2025-06-05 13:51:04 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(2afd60f6-2819-425b-aa8e-349783938172) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(2afd60f6-2819-425b-aa8e-349783938172) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(2afd60f6-2819-425b-aa8e-349783938172) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:51:04 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:51:04 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [389, 390, 391]
2025-06-05 13:51:04 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [385, 386, 388]
2025-06-05 13:51:04 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [392, 393, 394]
2025-06-05 13:51:04 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 389 with data: {"GOT": "Jasper Arryn", "LOTR": "Faramir"}
2025-06-05 13:51:04 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 385 with data: {"GOT": "Harlan Grandison", "LOTR": "Treebeard"}
2025-06-05 13:51:04 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 392 with data: {"GOT": "Jaggot", "LOTR": "Éomer"}
2025-06-05 13:51:04 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 390 with data: {"GOT": "Lorren", "LOTR": "Galadriel"}
2025-06-05 13:51:04 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 386 with data: {"GOT": "Jaime Frey", "LOTR": "Gandalf the Grey"}
2025-06-05 13:51:04 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 385: Simulating Random error
2025-06-05 13:51:04 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 389: Simulating Random error
2025-06-05 13:51:04 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 392: Simulating Random error
2025-06-05 13:51:04 [pool-2-thread-3] WARN  j.d.q.g.GenericQueueProcessor - [Worker-1] Message 385 with id 44bf0d43-29a9-4ced-9e7e-02cc105837b4 has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:51:04 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 393 with data: {"GOT": "Mark Ryswell", "LOTR": "Aragorn"}
2025-06-05 13:51:04 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 394 with data: {"GOT": "Salladhor Saan", "LOTR": "Gimli"}
2025-06-05 13:51:04 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 394: Simulating Random error
2025-06-05 13:51:04 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 391 with data: {"GOT": "Edric Dayne", "LOTR": "Samwise Gamgee"}
2025-06-05 13:51:04 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 391: Simulating Random error
2025-06-05 13:51:04 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 388 with data: {"GOT": "Greenbeard", "LOTR": "Samwise Gamgee"}
2025-06-05 13:51:04 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 388: Simulating Random error
2025-06-05 13:51:04 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-06-05 13:51:04 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-06-05 13:51:04 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-06-05 13:51:04 [http-nio-8080-exec-3] INFO  j.d.q.g.GenericQueueSseEmitter - New SSE connection established with client: 1
2025-06-05 13:51:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [401] with data {"LOTR":"Legolas","GOT":"Mellei"}
2025-06-05 13:51:07 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [402] with data {"LOTR":"Galadriel","GOT":"Morra"}
2025-06-05 13:51:10 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:51:11 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:51:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id bac43835-578e-46b4-ab29-063693b0bea6
2025-06-05 13:51:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [403] with data {"LOTR":"Legolas","GOT":"Rigney"}
2025-06-05 13:51:13 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:13 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:51:13 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(bac43835-578e-46b4-ab29-063693b0bea6) already exists.
2025-06-05 13:51:13 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(bac43835-578e-46b4-ab29-063693b0bea6) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(bac43835-578e-46b4-ab29-063693b0bea6) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(bac43835-578e-46b4-ab29-063693b0bea6) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:51:14 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:51:14 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:51:14 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [388, 389, 391]
2025-06-05 13:51:14 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 388 with data: {"GOT": "Greenbeard", "LOTR": "Samwise Gamgee"}
2025-06-05 13:51:14 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 389 with data: {"GOT": "Jasper Arryn", "LOTR": "Faramir"}
2025-06-05 13:51:14 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 391 with data: {"GOT": "Edric Dayne", "LOTR": "Samwise Gamgee"}
2025-06-05 13:51:14 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 389: Simulating Random error
2025-06-05 13:51:14 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 391: Simulating Random error
2025-06-05 13:51:14 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:51:14 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [388, 391, 392]
2025-06-05 13:51:14 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 388 with data: {"GOT": "Greenbeard", "LOTR": "Samwise Gamgee"}
2025-06-05 13:51:14 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 391 with data: {"GOT": "Edric Dayne", "LOTR": "Samwise Gamgee"}
2025-06-05 13:51:14 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 392 with data: {"GOT": "Jaggot", "LOTR": "Éomer"}
2025-06-05 13:51:14 [pool-2-thread-4] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 392: Simulating Random error
2025-06-05 13:51:15 [pool-3-thread-1] ERROR j.d.q.g.GenericQueueWorker - [Worker-1] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#385]
2025-06-05 13:51:15 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [389, 392, 394]
2025-06-05 13:51:15 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 389 with data: {"GOT": "Jasper Arryn", "LOTR": "Faramir"}
2025-06-05 13:51:15 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 392 with data: {"GOT": "Jaggot", "LOTR": "Éomer"}
2025-06-05 13:51:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [405] with data {"LOTR":"Sauron","GOT":"Rhae Targaryen"}
2025-06-05 13:51:16 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:16 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 394 with data: {"GOT": "Salladhor Saan", "LOTR": "Gimli"}
2025-06-05 13:51:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 952a715a-9ef8-49fb-8e13-8dea9f7c0f78
2025-06-05 13:51:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [406] with data {"LOTR":"Gollum","GOT":"Aelinor Penrose"}
2025-06-05 13:51:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:19 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:51:19 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(952a715a-9ef8-49fb-8e13-8dea9f7c0f78) already exists.
2025-06-05 13:51:19 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(952a715a-9ef8-49fb-8e13-8dea9f7c0f78) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(952a715a-9ef8-49fb-8e13-8dea9f7c0f78) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(952a715a-9ef8-49fb-8e13-8dea9f7c0f78) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:51:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:51:19 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:51:22 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:51:22 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:51:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [408] with data {"LOTR":"Galadriel","GOT":"Fornio"}
2025-06-05 13:51:22 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:24 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:51:24 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [395, 396, 397]
2025-06-05 13:51:24 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 396 with data: {"GOT": "Nymella Toland", "LOTR": "Shadowfax"}
2025-06-05 13:51:24 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 395 with data: {"GOT": "Bryen Caron", "LOTR": "Elrond"}
2025-06-05 13:51:24 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 397 with data: {"GOT": "Leana Frey", "LOTR": "Saruman the White"}
2025-06-05 13:51:24 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 396: Simulating Random error
2025-06-05 13:51:24 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 395: Simulating Random error
2025-06-05 13:51:24 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 397: Simulating Random error
2025-06-05 13:51:24 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [398, 399, 401]
2025-06-05 13:51:24 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 398 with data: {"GOT": "Lucas Blackwood", "LOTR": "Peregrin Took"}
2025-06-05 13:51:24 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 399 with data: {"GOT": "Theobald", "LOTR": "Frodo Baggins"}
2025-06-05 13:51:24 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 399: Simulating Random error
2025-06-05 13:51:24 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 401 with data: {"GOT": "Mellei", "LOTR": "Legolas"}
2025-06-05 13:51:24 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:51:24 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [395, 396, 397]
2025-06-05 13:51:24 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 396 with data: {"GOT": "Nymella Toland", "LOTR": "Shadowfax"}
2025-06-05 13:51:24 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 395 with data: {"GOT": "Bryen Caron", "LOTR": "Elrond"}
2025-06-05 13:51:24 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 396: Simulating Random error
2025-06-05 13:51:24 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 397 with data: {"GOT": "Leana Frey", "LOTR": "Saruman the White"}
2025-06-05 13:51:25 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:51:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id b4386bd0-9605-4b54-8d46-7cea1022ad90
2025-06-05 13:51:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [409] with data {"LOTR":"Éowyn","GOT":"Jon Bulwer"}
2025-06-05 13:51:25 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:25 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:51:25 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(b4386bd0-9605-4b54-8d46-7cea1022ad90) already exists.
2025-06-05 13:51:25 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(b4386bd0-9605-4b54-8d46-7cea1022ad90) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(b4386bd0-9605-4b54-8d46-7cea1022ad90) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(b4386bd0-9605-4b54-8d46-7cea1022ad90) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:51:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:51:27 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:51:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [411] with data {"LOTR":"Shelob","GOT":"Gared"}
2025-06-05 13:51:28 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [412] with data {"LOTR":"Samwise Gamgee","GOT":"Nail"}
2025-06-05 13:51:31 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:33 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:51:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:51:34 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [403, 405, 406]
2025-06-05 13:51:34 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 403 with data: {"GOT": "Rigney", "LOTR": "Legolas"}
2025-06-05 13:51:34 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 405 with data: {"GOT": "Rhae Targaryen", "LOTR": "Sauron"}
2025-06-05 13:51:34 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 406 with data: {"GOT": "Aelinor Penrose", "LOTR": "Gollum"}
2025-06-05 13:51:34 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-1] Error processing message 406: Simulating Random error
2025-06-05 13:51:34 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [396, 399, 402]
2025-06-05 13:51:34 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 396 with data: {"GOT": "Nymella Toland", "LOTR": "Shadowfax"}
2025-06-05 13:51:34 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 396: Simulating Random error
2025-06-05 13:51:34 [pool-2-thread-2] WARN  j.d.q.g.GenericQueueProcessor - [Worker-2] Message 396 with id 2035a6a2-6b8e-4b01-b653-ce371a730f0b has reached the maximum number of retries (3), moving to Dead Letter Queue
2025-06-05 13:51:34 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 399 with data: {"GOT": "Theobald", "LOTR": "Frodo Baggins"}
2025-06-05 13:51:34 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 402 with data: {"GOT": "Morra", "LOTR": "Galadriel"}
2025-06-05 13:51:34 [pool-2-thread-2] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 402: Simulating Random error
2025-06-05 13:51:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [413] with data {"LOTR":"Elrond","GOT":"Tim Stone"}
2025-06-05 13:51:34 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:51:35 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:51:37 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] All messages processed successfully
2025-06-05 13:51:37 [pool-3-thread-2] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [402, 406, 408]
2025-06-05 13:51:37 [pool-2-thread-4] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 406 with data: {"GOT": "Aelinor Penrose", "LOTR": "Gollum"}
2025-06-05 13:51:37 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 402 with data: {"GOT": "Morra", "LOTR": "Galadriel"}
2025-06-05 13:51:37 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 408 with data: {"GOT": "Fornio", "LOTR": "Galadriel"}
2025-06-05 13:51:37 [pool-2-thread-3] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 408: Simulating Random error
2025-06-05 13:51:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Simulating duplication of messages with id 7708048c-c17f-48b3-bbfa-8af6413de5cd
2025-06-05 13:51:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [414] with data {"LOTR":"Gimli","GOT":"Trebor Jordayne"}
2025-06-05 13:51:37 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:37 [scheduling-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2025-06-05 13:51:37 [scheduling-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(7708048c-c17f-48b3-bbfa-8af6413de5cd) already exists.
2025-06-05 13:51:37 [scheduling-1] ERROR o.s.s.s.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(7708048c-c17f-48b3-bbfa-8af6413de5cd) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; SQL [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]; constraint [ukpfutsvs1qoooef5fe75trara8]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy129.save(Unknown Source)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo.create(GenericQueueRepo.java:96)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at jon.db.queue.store.GenericQueuePosgreSQLRepo$$SpringCGLIB$$0.create(<generated>)
	at jon.db.queue.generic_queue.GenericQueueCreator.createProvidingData(GenericQueueCreator.java:27)
	at jon.db.queue.generic_queue.GenericQueueCreator.createWithRandomData(GenericQueueCreator.java:41)
	at jon.db.queue.generic_queue.GenericQueueScheduler.simulateInfluxOfMessages(GenericQueuePoller.java:62)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.lambda$run$2(ScheduledMethodRunnable.java:124)
	at io.micrometer.observation.Observation.observe(Observation.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:124)
	at org.springframework.scheduling.config.Task$OutcomeTrackingRunnable.run(Task.java:85)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset$$$capture(FutureTask.java:358)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1570)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(7708048c-c17f-48b3-bbfa-8af6413de5cd) already exists.] [insert into generic_queue (arrived_at,data,message_id,non_timeout_retries,processed_at) values (?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:97)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy4/jdk.proxy4.$Proxy122.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:651)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 36 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "ukpfutsvs1qoooef5fe75trara8"
  Detail: Key (message_id)=(7708048c-c17f-48b3-bbfa-8af6413de5cd) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 82 common frames omitted
2025-06-05 13:51:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [416] with data {"LOTR":"Legolas","GOT":"Androw Frey"}
2025-06-05 13:51:40 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:43 [pool-3-thread-3] ERROR j.d.q.g.GenericQueueWorker - [Worker-2] Error occurred during parallel processing: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [jon.db.queue.models.GenericQueue#396]
2025-06-05 13:51:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [417] with data {"LOTR":"Elrond","GOT":"Dalbridge"}
2025-06-05 13:51:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - Fetching messages to move to DLQ
2025-06-05 13:51:43 [scheduling-1] DEBUG j.d.q.g.GenericQueueWorker - No messages to move to DLQ
2025-06-05 13:51:44 [scheduling-1] DEBUG j.d.q.g.GenericQueueScheduler - Polling message queue...
2025-06-05 13:51:44 [pool-3-thread-3] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] Processing 3 messages [408, 409, 411]
2025-06-05 13:51:44 [pool-2-thread-2] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 409 with data: {"GOT": "Jon Bulwer", "LOTR": "Éowyn"}
2025-06-05 13:51:44 [pool-2-thread-3] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 408 with data: {"GOT": "Fornio", "LOTR": "Galadriel"}
2025-06-05 13:51:44 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-1] Processing message 411 with data: {"GOT": "Gared", "LOTR": "Shelob"}
2025-06-05 13:51:44 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-1] All messages processed successfully
2025-06-05 13:51:44 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] Processing 3 messages [412, 413, 414]
2025-06-05 13:51:44 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 412 with data: {"GOT": "Nail", "LOTR": "Samwise Gamgee"}
2025-06-05 13:51:44 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 412: Simulating Random error
2025-06-05 13:51:44 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 413 with data: {"GOT": "Tim Stone", "LOTR": "Elrond"}
2025-06-05 13:51:44 [pool-2-thread-1] ERROR j.d.q.g.GenericQueueProcessor - [Worker-2] Error processing message 413: Simulating Random error
2025-06-05 13:51:44 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-2] Processing message 414 with data: {"GOT": "Trebor Jordayne", "LOTR": "Gimli"}
2025-06-05 13:51:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueCreator - Created message [418] with data {"LOTR":"Arwen Evenstar","GOT":"Devan Seaworth"}
2025-06-05 13:51:46 [scheduling-1] DEBUG j.d.q.g.GenericQueueSseEmitter - Message sent to client: 1
2025-06-05 13:51:47 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-2] All messages processed successfully
2025-06-05 13:51:47 [pool-3-thread-1] DEBUG j.d.q.g.GenericQueueWorker - [Worker-3] Processing 3 messages [412, 413, 416]
2025-06-05 13:51:47 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 412 with data: {"GOT": "Nail", "LOTR": "Samwise Gamgee"}
2025-06-05 13:51:47 [pool-2-thread-1] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 413 with data: {"GOT": "Tim Stone", "LOTR": "Elrond"}
2025-06-05 13:51:47 [pool-2-thread-5] ERROR j.d.q.g.GenericQueueProcessor - [Worker-3] Error processing message 412: Simulating Random error
2025-06-05 13:51:47 [pool-2-thread-5] DEBUG j.d.q.g.GenericQueueProcessor - [Worker-3] Processing message 416 with data: {"GOT": "Androw Frey", "LOTR": "Legolas"}
